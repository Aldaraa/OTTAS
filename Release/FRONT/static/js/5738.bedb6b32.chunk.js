"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[5738],{15738:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var n=a(1413),l=a(45987),r=a(29439),s=a(47313),o=a(2880),c=a(56573),d=a(65040),i=a(74294),m=a(93031),u=a(31283),p=a(58467),h=a(42614),x=a(10658),f=a.n(x),b=a(14261),j=a(58821),v=a(18711),N=a(2135),y=a(46417),g=[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,y.jsx)("div",{className:"flex items-center justify-center",children:(0,y.jsx)(N.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,y.jsx)("button",{type:"button",className:"text-blue-600 underline",children:e.value})})})}},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,y.jsx)(v.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname"},{label:"Lastname",name:"Lastname"},{label:"SAP #",name:"SAPID",alignment:"left"},{label:"Department",name:"DepartmentName"},{label:"Employer",name:"EmployerName",cellRender:function(e){return(0,y.jsx)("span",{className:"text-primary2",children:e.value})}},{label:"Roster",name:"RosterName"},{label:"Resource Type",name:"PeopleTypeName"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,y.jsx)("span",{children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,y.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,y.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",cellRender:function(e){return(0,y.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,y.jsx)(j.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",cellRender:function(e,t){return(0,y.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,y.jsx)("i",{className:"dx-icon-home"})}}],Z=["key","name"];var C=function(){var e=(0,p.TH)(),t=(0,s.useState)(!1),a=(0,r.Z)(t,2),x=a[0],b=a[1],j=(0,s.useState)([]),v=(0,r.Z)(j,2),N=v[0],C=v[1],D=(0,s.useState)([]),w=(0,r.Z)(D,2),I=w[0],E=w[1],F=(0,s.useState)(!1),S=(0,r.Z)(F,2),R=S[0],k=S[1],V=(0,s.useContext)(h.V).state,M=d.Z.useForm(),P=(0,r.Z)(M,1)[0],L=d.Z.useForm(),Y=(0,r.Z)(L,1)[0],T=d.Z.useWatch("rosters",Y),U=(0,s.useRef)(null);(0,s.useEffect)((function(){e.state&&P.setFieldValue(e.state.name,e.state.value)}),[e,P]),(0,s.useEffect)((function(){Y.setFieldsValue({rosters:N})}),[N,Y]);var A=(0,s.useCallback)((function(e){E(e)}),[]),z=(0,s.useCallback)((function(){var e=I.map((function(e){return{Fullname:"".concat(e.Firstname," ").concat(e.Lastname),Id:e.Id,EmployerName:e.EmployerName,EmployerId:e.EmployerId}}));C(e),k(!0)}),[I]),B=(0,s.useCallback)((function(e,t){var a,n;null===(a=Y.getFieldsValue())||void 0===a||null===(n=a.rosters)||void 0===n||n.map((function(a,n){Y.setFieldValue(["rosters",n,t],e)}))}),[Y]),G=(0,s.useCallback)((function(e){b(!0);var t=e.rosters.map((function(e){return{DataId:e.EmployerId,StartDate:e.StartDate?f()(e.StartDate).format("YYYY-MM-DD"):"",EndDate:e.profileUpdate?null:f()(e.EndDate).format("YYYY-MM-DD"),EmployeeId:e.Id,profileUpdate:e.profileUpdate?1:0}}));(0,c.Z)({method:"put",url:"tas/employee/changedata/employer",data:t}).then((function(e){var t;k(!1),C([]),null===(t=U.current)||void 0===t||t.instance.clearSelection(),P.submit()})).catch((function(e){})).then((function(){return b(!1)}))}),[Y,P]),H=function(){k(!1),E(Y.getFieldValue("rosters")),C(Y.getFieldValue("rosters"))},W=(0,s.useCallback)((function(e){var t;null===(t=U.current)||void 0===t||t.instance.deselectRows([e])}),[]);return(0,y.jsxs)("div",{children:[(0,y.jsx)(o.PeolpeSelectionTable,{ref:U,onSelect:A,onReturn:z,selectedRowsData:I,columns:g,searchDefaultValues:{Active:1},hideFields:["Active"]}),(0,y.jsxs)(o.Modal,{open:R,onCancel:H,title:(0,y.jsxs)("div",{children:["Change Employer ",(0,y.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",null===T||void 0===T?void 0:T.length," people selected)"]})]}),width:1e3,forceRender:!0,children:[(0,y.jsx)(d.Z,{form:Y,size:"small",onFinish:G,initialValues:{rosters:[]},children:(0,y.jsx)(d.Z.List,{name:"rosters",children:function(e,t){var a,r=t.remove;return(0,y.jsx)("div",{className:"border rounded-ot",children:(0,y.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,y.jsx)("thead",{className:"text-[#959595]",children:(0,y.jsxs)("tr",{className:"text-left",children:[(0,y.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:"Current Employer"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,y.jsx)(i.Z,{className:"w-full",options:null===(a=V.referData)||void 0===a?void 0:a.employers,placeholder:"Employer",onChange:function(e){return B(e,"EmployerId")},allowClear:!0,showSearch:!0,filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},popupMatchSelectWidth:!1}):"Replacement Employer"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,y.jsx)(m.Z,{onChange:function(e){return B(e,"StartDate")},placeholder:"Start Date"}):"Start Date"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,y.jsx)(m.Z,{onChange:function(e){return B(e,"EndDate")},placeholder:"End Date"}):"End Date"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,y.jsx)(u.Z,{onChange:function(e){return B(e.target.checked,"profileUpdate")},children:"Permanent"}):"Permanent"}),(0,y.jsx)("th",{className:"border-b px-1 font-normal"})]})}),(0,y.jsx)("tbody",{children:e.map((function(e){var t,a=e.key,s=e.name,o=(0,l.Z)(e,Z);return(0,y.jsxs)("tr",{className:"".concat((s+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,(0,n.Z)((0,n.Z)({},o),{},{name:[s,"Id"],className:"mb-0",children:(0,y.jsx)("div",{className:"text-[13px] w-[30px]",children:s+1})}))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,(0,n.Z)((0,n.Z)({},o),{},{name:[s,"Id"],className:"mb-0",children:(0,y.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",s,"Id"])})}))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,(0,n.Z)((0,n.Z)({},o),{},{className:"mb-0",children:(0,y.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",s,"Fullname"])})}))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,(0,n.Z)((0,n.Z)({},o),{},{className:"mb-0",children:(0,y.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",s,"EmployerName"])})}))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,(0,n.Z)((0,n.Z)({},o),{},{name:[s,"EmployerId"],className:"mb-0",rules:[{required:!0,message:"Missing first name"}],children:(0,y.jsx)(i.Z,{options:null===(t=V.referData)||void 0===t?void 0:t.employers,placeholder:"Employer",allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())}})}))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,{name:[s,"StartDate"],className:"mb-0",children:(0,y.jsx)(m.Z,{placeholder:"Start Date"})},"startDate-".concat(a))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)(d.Z.Item,{name:[s,"EndDate"],className:"mb-0",children:(0,y.jsx)(m.Z,{placeholder:"End Date"})},"endDate-".concat(a))}),(0,y.jsx)("td",{className:"py-1 border-t px-1 text-center",children:(0,y.jsx)(d.Z.Item,{name:[s,"profileUpdate"],className:"mb-0",valuePropName:"checked",children:(0,y.jsx)(u.Z,{})},"profileUpdate-".concat(a))}),(0,y.jsx)("td",{className:"py-1 border-t px-1",children:(0,y.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){W(Y.getFieldValue(["rosters",s,"Id"])),r(s)},children:"Remove"})})]})}))})]})})}})}),N.length>0&&(0,y.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,y.jsx)(o.Button,{type:"primary",onClick:function(){return Y.submit()},loading:x,children:"Process"}),(0,y.jsx)(o.Button,{onClick:H,disabled:x,children:"Cancel"})]})]})]})}}}]);
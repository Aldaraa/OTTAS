"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[7857],{27857:function(e,t,n){n.r(t);var a=n(1413),i=n(29439),s=n(2880),l=n(14261),c=n(47313),o=n(74294),r=n(65040),u=n(56573),d=n(40765),p=n(82138),m=n(92350),f=n(81514),h=n(42614),x=n(46417),b=o.Z.Option,v="Shift Status";t.default=function(){var e=(0,c.useState)([]),t=(0,i.Z)(e,2),n=t[0],g=t[1],j=(0,c.useState)([]),C=(0,i.Z)(j,2),N=C[0],y=C[1],S=(0,c.useState)(null),Z=(0,i.Z)(S,2),k=Z[0],w=Z[1],D=(0,c.useState)(!1),A=(0,i.Z)(D,2),I=A[0],O=A[1],q=(0,c.useState)(!1),F=(0,i.Z)(q,2),R=F[0],L=F[1],B=(0,c.useState)(!1),V=(0,i.Z)(B,2),z=V[0],E=V[1],T=(0,c.useState)(!1),J=(0,i.Z)(T,2),M=J[0],P=J[1],_=(0,c.useState)([]),G=(0,i.Z)(_,2),K=G[0],Y=G[1],H=(0,c.useState)(!1),Q=(0,i.Z)(H,2),U=Q[0],W=Q[1],X=(0,c.useState)(null),$=(0,i.Z)(X,2),ee=$[0],te=$[1],ne=r.Z.useForm(),ae=(0,i.Z)(ne,1)[0],ie=r.Z.useForm(),se=(0,i.Z)(ie,1)[0],le=(0,c.useContext)(h.V).action;(0,c.useEffect)((function(){le.changeMenuKey("/tas/shiftstatus"),ce(),re()}),[]);var ce=function(){O(!0),(0,u.Z)({method:"get",url:"tas/shift"}).then((function(e){if(g(e.data),1===se.getFieldValue("Active")){var t=e.data.filter((function(e){return 1===e.Active}));y(t)}else if(0===se.getFieldValue("Active")){var n=e.data.filter((function(e){return 0===e.Active}));y(n)}else y(e.data)})).catch((function(e){})).then((function(){return O(!1)}))},oe=function(){le.changeLoadingStatusReferItem({roomStatuses:!0}),(0,u.Z)({method:"get",url:"tas/shift?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push((0,a.Z)({value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)},e))})),le.setReferDataItem({roomStatuses:t})})).catch((function(e){})).then((function(){return le.changeLoadingStatusReferItem({roomStatuses:!1})}))},re=function(){(0,u.Z)({method:"get",url:"tas/color"}).then((function(e){var t=[];e.data.map((function(e){t.push({value:e.Id,label:(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"mr-2 h-[15px] w-[40px]",style:{background:e.Code}}),e.Description]})})})),Y(e.data)}))},ue=(0,c.useCallback)((function(e){w(e),P(!0)}),[]),de=(0,c.useCallback)((function(e){w(e),L(!0)}),[]),pe=(0,c.useCallback)((function(e){te(e),W(!0)}),[]),me=[{label:"",name:"ColorCode",width:"50px",cellRender:function(e){return(0,x.jsx)("div",{className:"w-[30px] h-[13px]",style:{background:e.data.ColorCode}})}},{label:"Code",name:"Code",width:"80px"},{label:"Description",name:"Description"},{label:"OnSite",name:"OnSite",width:"60px",alignment:"center",cellRender:function(e){return(0,x.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.OnSite||0})}},{label:"Default",name:"isDefault",width:"60px",alignment:"center",cellRender:function(e){return(0,x.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.isDefault||0})}},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,x.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"action",width:"265px",cellRender:function(e){return(0,x.jsxs)("div",{className:"flex gap-3",children:[(0,x.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return pe(e.data)},children:"View Audit"}),(0,x.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return ue(e.data)},children:"Edit"}),1===e.data.Active?(0,x.jsx)("button",{type:"button",className:"dlt-button",onClick:function(){return de(e.data)},children:"Deactivate"}):(0,x.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return de(e.data)},children:"Reactivate"})]})}}],fe=[{label:"Code",name:"Code",rules:[{required:!0,message:"Code is required"}],className:"col-span-12 mb-2",inputprops:{maxLength:20}},{label:"Description",name:"Description",rules:[{required:!0,message:"Description is required"}],className:"col-span-12 mb-2"},{type:"component",component:(0,x.jsx)(s.Form.Item,{name:"ColorId",className:"col-span-12 mb-2",label:"Color",rules:[{required:!0,message:"Color is required"}],children:(0,x.jsx)(o.Z,{children:K.map((function(e){return(0,x.jsx)(b,{value:e.Id,children:(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("div",{className:"w-[40px] h-[13px]",style:{background:e.Code}}),e.Description]})})}))})})},{label:"On Site",name:"OnSite",className:"col-span-12 mb-2",type:"check",inputprops:{}},{label:"Default",name:"isDefault",className:"col-span-12 mb-2",type:"check",inputprops:{}}],he=[{label:"Code",name:"Code",rules:[{required:!0,message:"Code is required"}],className:"col-span-12 mb-2",inputprops:{maxLength:20}},{label:"Description",name:"Description",rules:[{required:!0,message:"Description is required"}],className:"col-span-12 mb-2"},{type:"component",component:(0,x.jsx)(s.Form.Item,{name:"ColorId",className:"col-span-12 mb-2",label:"Color",rules:[{required:!0,message:"Color is required"}],children:(0,x.jsx)(o.Z,{children:K.map((function(e){return(0,x.jsx)(b,{value:e.Id,children:(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("div",{className:"w-[40px] h-[13px]",style:{background:e.Code}}),e.Description]})})}))})})},{label:"On Site",name:"OnSite",className:"col-span-12 mb-2",type:"check",inputprops:{}},{label:"Default",name:"isDefault",className:"col-span-12 mb-2",type:"check",inputprops:{}},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{}}],xe=function(){P(!1)};return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,x.jsx)("div",{className:"text-lg font-bold mb-2",children:v}),(0,x.jsx)(s.Form,{form:se,fields:[{label:"Code",name:"Code",className:"col-span-6 lg:col-span-2 2xl:col-span-2 mb-2",inputprops:{}},{label:"Description",name:"Description",className:"col-span-6 lg:col-span-3 2xl:col-span-3 mb-2"},{label:"isDefault",name:"isDefault",className:"col-span-6 lg:col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}},{label:"Active",name:"Active",className:"col-span-6 lg:col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}},{label:"On Site",name:"OnSite",className:"col-span-6 lg:col-span-2 2xl:col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],className:"grid grid-cols-12 gap-x-8",onFinish:function(e){O(!0),(0,f.Z)(e,n).then((function(e){y(e),O(!1)}))},noLayoutConfig:!0,initValues:{isDefault:null,OnSite:null,Active:1},children:(0,x.jsx)("div",{className:"flex gap-4 items-baseline col-span-6 lg:col-span-1",children:(0,x.jsx)(s.Button,{htmlType:"submit",className:"flex items-center",loading:I,icon:(0,x.jsx)(d.Z,{}),children:"Search"})})})]}),(0,x.jsx)(s.Table,{data:N,columns:me,allowColumnReordering:!1,loading:I,keyExpr:"Id",pager:{showPageSizeSelector:!1,showNavigationButtons:!1},tableClass:"border-t max-h-[calc(100vh-250px)]",title:(0,x.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,x.jsx)("div",{className:"flex items-center gap-1",children:(0,x.jsx)("span",{className:" text-gray-400",children:"results"})}),(0,x.jsxs)("div",{className:"flex items-center gap-3",children:[(0,x.jsx)(s.Button,{onClick:function(){te(null),W(!0)},children:"Audit"}),(0,x.jsxs)(s.Button,{icon:(0,x.jsx)(p.Z,{}),onClick:function(){w(null),ae.resetFields(),P(!0)},children:["Add ",v]})]})]})}),(0,x.jsx)(s.Modal,{open:M,onCancel:function(){return P(!1)},title:k?"Edit ".concat(v):"Add ".concat(v),children:(0,x.jsx)(s.Form,{form:ae,fields:k?fe:he,editData:k,onFinish:function(e){E(!0),k?(0,u.Z)({method:"put",url:"tas/shift",data:(0,a.Z)((0,a.Z)({},e),{},{Id:k.Id})}).then((function(e){ce(),oe(),xe()})).catch((function(e){})).then((function(){return E(!1)})):(0,u.Z)({method:"post",url:"tas/shift",data:(0,a.Z)((0,a.Z)({},e),{},{Active:e.Active?1:0})}).then((function(e){ce(),oe(),xe()})).catch((function(e){})).then((function(){return E(!1)}))},children:(0,x.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,x.jsx)(s.Button,{type:"primary",onClick:function(){return ae.submit()},loading:z,icon:(0,x.jsx)(m.Z,{}),children:"Save"}),(0,x.jsx)(s.Button,{onClick:xe,disabled:z,children:"Cancel"})]})})}),(0,x.jsxs)(l.GI,{visible:R,showTitle:!1,height:110,width:350,children:[(0,x.jsxs)("div",{children:["Are you sure you want to ",1===(null===k||void 0===k?void 0:k.Active)?"deactivate":"reactivate"," this record?"]}),(0,x.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,x.jsx)(s.Button,{type:1===(null===k||void 0===k?void 0:k.Active)?"danger":"success",onClick:function(){E(!0),(0,u.Z)({method:"delete",url:"tas/shift",data:{id:k.Id}}).then((function(){ce(),oe(),L(!1)})).catch((function(e){})).then((function(){return E(!1)}))},loading:z,children:"Yes"}),(0,x.jsx)(s.Button,{onClick:function(){return L(!1)},disabled:z,children:"No"})]})]}),(0,x.jsx)(s.AuditTable,{title:"Shift Status Audit",tablename:"Shift",open:U,onClose:function(){return W(!1)},record:ee,recordName:ee?(0,x.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",ee.Code," ",ee.Description,"/"]}):""})]})}},81514:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(93433),i=n(4942),s=n(1413);var l=function e(t,n,a){var l=[],c=Object.keys(n);return t.map((function(t){if(t[a].length>0)l.push((0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},a,e(t[a],n,a))));else{var o=!1;c.map((function(e){var a,i;""!==n[e]&&"undefined"!==typeof n[e]&&null!==n[e]?o="string"===typeof n[e]?o||(null===(a=t[e])||void 0===a?void 0:a.toLowerCase().includes(null===(i=n[e])||void 0===i?void 0:i.toLowerCase())):o||t[e]===n[e]:o=!0})),o&&l.push(t)}})),l};function c(e,t,n,i){return"tree"===n?l(t,e,i):new Promise((function(n,i){var s=Object.keys(e),l=(0,a.Z)(t);s.map((function(t){""!==e[t]&&"undefined"!==typeof e[t]&&null!==e[t]&&(l="string"===typeof e[t]?l.filter((function(n){var a,i;return null===(a=n[t])||void 0===a?void 0:a.toLowerCase().includes(null===(i=e[t])||void 0===i?void 0:i.toLowerCase())})):l.filter((function(n){return n[t]===e[t]})))})),n(l)}))}}}]);
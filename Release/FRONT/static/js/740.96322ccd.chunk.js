"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[740],{1710:function(e,t,l){var a=l(29439),n=l(56573),s=l(47313),r=l(2135),i=l(26672),o=l(22539),d=l(63733),c=l(10658),u=l.n(c),m=l(42614),f=l(2880),p=l(1522),x=l(41612),h=l(21521),v=l(18637),g=l(29074),j=l(15413),D=l(58821),b=l(82508),N=l(59748),I=l(14261),S=l(43295),F=l.n(S),T=l(46417),y=function(e){if("Non Site Travel"===e.data.DocumentType)return"/request/task/nonsitetravel/".concat(e.data.Id);if("Profile Changes"===e.data.DocumentType)return"/request/task/profilechanges/".concat(e.data.Id);if("De Mobilisation"===e.data.DocumentType)return"/request/task/de-mobilisation/".concat(e.data.Id);if("Site Travel"===e.data.DocumentType){if("ADD"===e.data.DocumentTag)return"/request/task/sitetravel/addtravel/".concat(e.data.Id);if("RESCHEDULE"===e.data.DocumentTag)return"/request/task/sitetravel/reschedule/".concat(e.data.Id);if("REMOVE"===e.data.DocumentTag)return"/request/task/sitetravel/remove/".concat(e.data.Id)}},C=[{label:"Travel Date",name:"TravelDate",cellRender:function(e){return(0,T.jsx)("div",{children:u()(e.value).format("YYYY-MM-DD ddd ")})}},{label:"Favor Time",name:"FavorTime"},{label:"Depart Location",name:"DepartLocationName",alignment:"left"},{label:"Arrive Location",name:"ArriveLocationName",alignment:"left"},{label:"Comment",name:"Comment"},{label:"ETD",name:"ETD",alignment:"left",cellRender:function(e){return(0,T.jsx)(I.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})}}],Z=[{label:"",name:"Direction"},{label:"Date",name:"EventDate",cellRender:function(e){return(0,T.jsx)("div",{children:u()(e.value).format("YYYY-MM-DD ddd HH:mm")})}},{label:"Description",name:"Description"},{label:"Status",name:"Status",cellRender:function(e){return(0,T.jsx)(g.Z,{color:V[e.value],children:e.value})}}],w=[{label:"Type",name:"DocumentType"},{label:"Date",name:"RequestedDate",cellRender:function(e){return(0,T.jsx)("div",{children:u()(e.value).format("YYYY-MM-DD ddd HH:mm")})}},{label:"Description",name:"Description"},{label:"#",name:"Id",alignment:"left",cellRender:function(e){return(0,T.jsx)("div",{className:"flex items-center text-blue-500 hover:underline",children:(0,T.jsx)(r.Link,{to:y(e),target:"_blank",children:e.value})})}},{label:"Status",name:"CurrentStatus",cellRender:function(e){return(0,T.jsx)(g.Z,{color:V[e.value],children:e.value})}}],V={Confirmed:"green",Waiting:"green",Submitted:"orange"};t.Z=function(e){var t,l,c=e.employeeId,u=e.profileData,g=e.pendingInfo,I=(0,s.useState)(null),S=(0,a.Z)(I,2),y=S[0],V=S[1],R=(0,s.useState)(!0),E=(0,a.Z)(R,2),Y=E[0],q=E[1],M=(0,s.useState)(!1),L=(0,a.Z)(M,2),P=L[0],k=L[1],O=(0,s.useState)(null),U=(0,a.Z)(O,2),A=U[0],z=U[1],G=(0,s.useState)(!1),B=(0,a.Z)(G,2),H=B[0],W=B[1],_=(0,s.useContext)(m.V),J=_.state,$=_.action,X=(0,s.useRef)(null);(0,s.useEffect)((function(){c?K():u&&($.saveUserProfileData(u),V(u),q(!1))}),[c,u,$]),(0,s.useEffect)((function(){0!==J.ChangedFlight&&K()}),[J.ChangedFlight]);var K=function(){(0,n.Z)({method:"get",url:"tas/employee/".concat(c)}).then((function(e){$.saveUserProfileData(e.data),V(e.data)})).catch((function(e){})).then((function(){return q(!1)}))},Q=(0,s.useMemo)((function(){if(y){if(y.Gender&&y.Active)return p;if(y.Gender&&!y.Active)return x;if(!y.Gender&&y.Active)return h;if(!y.Gender&&!y.Active)return v}}),[y]);return(0,T.jsxs)("div",{children:[Y?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"animate-skeleton h-[130px] flex rounded-ot mb-5 border"}),(0,T.jsx)("div",{className:"animate-skeleton h-[300px] flex rounded-ot border"})]}):y?(0,T.jsxs)("div",{className:"grid grid-cols-12 gap-5 relative",children:[(0,T.jsxs)("div",{className:"rounded-ot p-4 flex justify-between col-span-12 border border-gray-300 sticky top-0 z-10 shadow-md bg-white",children:[(0,T.jsxs)("div",{className:"flex gap-5",children:[(0,T.jsx)(r.Link,{className:"bg-gray-100 h-[80px] w-[80px] flex items-center justify-center rounded-ot border overflow-hidden cursor-pointer",to:"/tas/people/search/".concat(null===y||void 0===y?void 0:y.Id),children:(0,T.jsx)("img",{alt:"profile-img",src:Q})}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("span",{className:"text-start lg:text-lg font-bold flex gap-1 items-center",children:[null===y||void 0===y?void 0:y.Firstname," ",null===y||void 0===y?void 0:y.Lastname," (",null===y||void 0===y?void 0:y.Id,")",null!==y&&void 0!==y&&y.OnSiteStatus?(0,T.jsx)(f.Tooltip,{title:"Today on Site",children:(0,T.jsx)("span",{children:(0,T.jsx)("div",{className:"ml-2 h-3 w-3 bg-green-400 rounded-full relative z-0",children:(0,T.jsx)("div",{className:"absolute animate-ping inset-0 bg-green-400 rounded-full z-10"})})})}):null]}),(0,T.jsxs)("div",{className:"flex gap-5 divide-x mt-2",children:[(0,T.jsxs)("div",{className:"text-[#718096] text-xs flex flex-col gap-1",children:[(0,T.jsx)(f.Tooltip,{Tooltip:!0,title:"Nationality",children:(0,T.jsxs)("div",{className:"flex gap-3 items-center cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaPassport,{size:15})}),(0,T.jsx)("div",{children:null!==y&&void 0!==y&&y.NationalityName?null===y||void 0===y?void 0:y.NationalityName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})})]})}),(0,T.jsx)(f.Tooltip,{Tooltip:!0,title:"".concat(null!==y&&void 0!==y&&y.EmployerCurrentStatus?"Temporary":"Permanent"," Employer name"),children:(0,T.jsxs)("div",{className:"flex gap-3 items-center cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaRegBuilding,{size:15})}),(0,T.jsxs)("div",{children:[(0,T.jsx)(j.Z,{className:"mr-1",status:y.EmployerCurrentStatus?"warning":"success"}),null!==y&&void 0!==y&&y.EmployerName?null===y||void 0===y?void 0:y.EmployerName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})]})]})}),(0,T.jsx)(f.DepartmentTooltip,{data:y,id:null===y||void 0===y?void 0:y.DepartmentId,children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaUsers,{size:15})}),(0,T.jsxs)("div",{children:[(0,T.jsx)(j.Z,{className:"mr-1",status:y.DepartmentCurrentStatus?"warning":"success"}),null!==y&&void 0!==y&&y.DepartmentName?null===y||void 0===y?void 0:y.DepartmentName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})]})]})}),(0,T.jsx)(f.Tooltip,{title:"".concat(y.CostCodeCurrentStatus?"Temporary":"Permanent"," Cost Code"),className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(o.c85,{size:15})}),(0,T.jsxs)("div",{children:[(0,T.jsx)(j.Z,{className:"mr-1",status:y.CostCodeCurrentStatus?"warning":"success"}),null!==y&&void 0!==y&&y.CostCodeName?null===y||void 0===y?void 0:y.CostCodeName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})]})]})}),(0,T.jsx)(f.Tooltip,{title:"Mobile",className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(o.IXo,{size:15})}),(0,T.jsx)("div",{children:null!==y&&void 0!==y&&y.PersonalMobile?null===y||void 0===y?void 0:y.PersonalMobile:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})})]})})]}),(0,T.jsxs)("div",{className:"pl-5 text-[#718096] text-xs flex flex-col gap-1",children:[(0,T.jsx)(f.Tooltip,{title:"".concat(y.PositionCurrentStatus?"Temporary":"Permanent"," Position name"),className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaBriefcase,{size:15})}),(0,T.jsxs)("div",{children:[(0,T.jsx)(j.Z,{className:"mr-1",status:y.PositionCurrentStatus?"warning":"success"}),null!==y&&void 0!==y&&y.PositionName?null===y||void 0===y?void 0:y.PositionName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})]})]})}),(0,T.jsx)(f.Tooltip,{title:"SAP ID #",className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(d.Lhg,{size:15})}),(0,T.jsx)("div",{children:null===y||void 0===y?void 0:y.SAPID})]})}),(0,T.jsx)(f.Tooltip,{title:"Room number",className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaHouseUser,{size:15})}),(0,T.jsx)("div",{children:null!==y&&void 0!==y&&y.RoomNumber?"".concat(null===y||void 0===y?void 0:y.RoomNumber):(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})})]})}),(0,T.jsxs)(f.Tooltip,{title:"Camp & Room Type",className:"flex items-start gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(D.hh$,{size:15})}),(0,T.jsx)("div",{children:null===y||void 0===y?void 0:y.CampRoomType})]}),null!==y&&void 0!==y&&y.CurrentRoomNumber?(0,T.jsx)(f.Tooltip,{title:"Current Room",className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default text-success",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaHouseUser,{size:15})}),(0,T.jsx)("div",{children:null===y||void 0===y?void 0:y.CurrentRoomNumber})]})}):null]}),(0,T.jsxs)("div",{className:"pl-5 text-[#718096] text-xs flex flex-col gap-1",children:[(0,T.jsx)(f.Tooltip,{title:"Location",className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaLocationArrow,{size:15})}),(0,T.jsx)("div",{children:null!==y&&void 0!==y&&y.LocationName?null===y||void 0===y?void 0:y.LocationName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})})]})}),(0,T.jsx)(f.Tooltip,{title:"Resource Type",className:"flex items-center gap-3 cursor-default",children:(0,T.jsxs)("div",{className:"flex items-center gap-3 cursor-default",children:[(0,T.jsx)("div",{children:(0,T.jsx)(i.FaUserAlt,{size:14})}),(0,T.jsx)("div",{children:null!==y&&void 0!==y&&y.PeopleTypeName?null===y||void 0===y?void 0:y.PeopleTypeName:(0,T.jsx)("span",{className:"text-gray-400",children:"Not registered"})})]})}),(0,T.jsx)(f.Tooltip,{title:"Gender",children:(0,T.jsx)("div",{className:"flex items-center gap-3 cursor-default",children:(0,T.jsx)("div",{children:null!==y&&void 0!==y&&y.Gender?"Male":"Female"})})})]})]})]})]}),(0,T.jsx)("div",{className:"px-5 py-2",children:(0,T.jsx)(j.Z,{count:null===g||void 0===g?void 0:g.PendingRequests,children:(0,T.jsx)("button",{type:"button",onClick:function(){k(!0),function(e){W(!0),(0,n.Z)({method:"get",url:"tas/requestdocument/existingbooking/".concat(e)}).then((function(e){z(e.data)})).catch((function(e){})).then((function(){return W(!1)}))}(c)},children:(0,T.jsx)(D.$W1,{size:26})})})})]}),(0,T.jsx)("div",{className:"w-full col-span-12",children:(0,T.jsxs)("div",{className:"flex items-start gap-5",children:[(0,T.jsx)(f.VerticalCalendar,{employeeId:null===(t=J.userInfo)||void 0===t?void 0:t.Id}),(0,T.jsx)(f.FlightList,{profileData:J.userProfileData,employeeId:null===(l=J.userInfo)||void 0===l?void 0:l.Id})]})})]}):null,(0,T.jsx)(f.Modal,{open:P,title:"Existing Bookings",width:800,onCancel:function(){return k(!1)},children:H?(0,T.jsx)("div",{className:"p-8 flex justify-center items-center",children:(0,T.jsx)(b.Z,{style:{fontSize:24}})}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{ref:X,className:"flex flex-col gap-5",children:[(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{children:[(0,T.jsx)("span",{className:"text-gray-500 ",children:"Name:"})," ",null===A||void 0===A?void 0:A.FullName," (",null===A||void 0===A?void 0:A.SAPID,")"]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("span",{className:"text-gray-500",children:"Department:"})," ",null===A||void 0===A?void 0:A.Department]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("span",{className:"text-gray-500",children:"Employer:"})," ",null===A||void 0===A?void 0:A.Employer]})]}),(0,T.jsx)(f.Table,{data:null===A||void 0===A?void 0:A.SiteTravel,columns:Z,pager:!1,containerClass:"shadow-none border border-gray-300",title:(0,T.jsx)("div",{className:"border-b py-1 font-bold",children:"Site Travel Requests"})}),(0,T.jsx)(f.Table,{data:null===A||void 0===A?void 0:A.NonSiteTravel,columns:C,pager:!1,containerClass:"shadow-none border border-gray-300",title:(0,T.jsx)("div",{className:"border-b py-1 font-bold",children:"Non Site Travel Requests"})}),(0,T.jsx)(f.Table,{data:null===A||void 0===A?void 0:A.PendingRequest,columns:w,pager:!1,containerClass:"shadow-none border border-gray-300",title:(0,T.jsx)("div",{className:"border-b py-1 font-bold",children:"Pending Requests"})}),(0,T.jsx)(f.Table,{data:null===A||void 0===A?void 0:A.OtherRequest,columns:w,pager:!1,containerClass:"shadow-none border border-gray-300",tableClass:"max-h-full",title:(0,T.jsx)("div",{className:"border-b py-1 font-bold",children:"Other Requests"})})]}),(0,T.jsx)("div",{className:"flex justify-end mt-5",children:(0,T.jsx)(F(),{bodyClass:"p-5",content:function(){return X.current},trigger:function(){return(0,T.jsx)(f.Button,{type:"primary",icon:(0,T.jsx)(N.Z,{}),children:"Print"})}})})]})})]})}},50740:function(e,t,l){l.r(t),l.d(t,{default:function(){return A}});var a=l(1413),n=l(93433),s=l(29439),r=l(47313),i=l(56573),o=l(65040),d=l(12998),c=l(79036),u=l(14576),m=l(55333),f=l(21975),p=l(74294),x=l(29816),h=l(23495),v=l(2880),g=l(93031),j=l(29074),D=l(42614),b=l(10658),N=l.n(b),I=l(58467),S=l(46417),F=g.Z.RangePicker;var T=function(e){var t,l,n,o,d,c,u,m,x,h,b=e.form,T=(0,r.useState)([]),y=(0,s.Z)(T,2),C=y[0],Z=y[1],w=(0,r.useState)([null,null]),V=(0,s.Z)(w,2),R=V[0],E=V[1],Y=(0,r.useState)(!1),q=(0,s.Z)(Y,2),M=q[0],L=q[1],P=(0,r.useState)(null),k=(0,s.Z)(P,2),O=k[0],U=k[1],A=(0,r.useState)(!1),z=(0,s.Z)(A,2),G=z[0],B=z[1],H=(0,r.useState)(null),W=(0,s.Z)(H,2),_=W[0],J=W[1],$=(0,r.useState)(null),X=(0,s.Z)($,2),K=X[0],Q=(X[1],(0,r.useState)(!1)),ee=(0,s.Z)(Q,2),te=(ee[0],ee[1],(0,r.useContext)(D.V)),le=te.state,ae=(te.action,(0,I.UO)().empId),ne=null===(t=le.referData)||void 0===t?void 0:t.roomStatuses.find((function(e){return"DS"===e.Code})),se=null===(l=le.referData)||void 0===l?void 0:l.roomStatuses.find((function(e){return"RR"===e.Code}));null===(n=le.referData)||void 0===n||null===(o=n.locations)||void 0===o||o.find((function(e){return"UB"===e.Code})).Id,null===(d=le.referData)||void 0===d||null===(c=d.locations)||void 0===c||c.find((function(e){return"OT"===e.Code})).Id,null===(u=le.referData)||void 0===u||null===(m=u.locations)||void 0===m||m.find((function(e){return"OT"===e.Code})).Id,null===(x=le.referData)||void 0===x||null===(h=x.locations)||void 0===h||h.find((function(e){return"UB"===e.Code})).Id,(0,r.useEffect)((function(){var e;R&&(L(!0),(0,i.Z)({method:"get",url:"tas/transport?employeeId=".concat(ae).concat(R[0]?"&startDate=".concat(null===(e=N()(R[0]))||void 0===e?void 0:e.format("YYYY-MM-DD")):"").concat(R[1]?"&endDate=".concat(N()(R[1]).format("YYYY-MM-DD")):"")}).then((function(e){Z(e.data)})).catch((function(e){})).then((function(){return L(!1)})))}),[R]);var re=function(){var e={StartDate:b.getFieldValue("endDate")?b.getFieldValue("endDate"):null,EndDate:b.getFieldValue("endDate")?b.getFieldValue("endDate"):null};e=(b.getFieldValue("Direction")&&b.getFieldValue("Direction"),(0,a.Z)((0,a.Z)({},e),{},{DepartLocationId:O.fromLocationId,ArriveLocationId:O.toLocationId})),J((0,a.Z)((0,a.Z)({},e),{},{transportType:"last"})),B(!0)},ie=[{type:"component",component:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(v.Form.Item,{label:"Existing Transport",className:"col-span-12 mb-2",children:(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsx)(v.Form.Item,{name:"startDate",className:"mb-0 col-span-3",children:(0,S.jsx)(g.Z,{disabled:!0,className:"w-full"})}),(0,S.jsx)(v.Form.Item,{name:"Direction",className:"mb-0 col-span-2",children:(0,S.jsx)(f.Z,{disabled:!0,className:"w-[50px] py-[2px]"})}),(0,S.jsx)(v.Form.Item,{name:"startFlight",className:"mb-0 flex-1",rules:[{required:!0,message:"Flight is required"}],children:(0,S.jsx)(f.Z,{disabled:!0,className:"py-[2px]"})}),(0,S.jsx)(v.Form.Item,{name:"existingScheduleId",noStyle:!0})]})})})},{type:"component",component:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(v.Form.Item,{label:"Reschedule Transport",className:"col-span-12 mb-2",children:(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.startDate!==t.startDate||e.endDate!==t.endDate},children:function(e){var t=e.getFieldValue,l=!1;return t("endDate")||(l=t("startDate")),(0,S.jsx)(v.Form.Item,{name:"endDate",className:"mb-0 col-span-3",children:(0,S.jsx)(g.Z,{defaultPickerValue:l,showWeek:!0,className:"w-full",onChange:function(){b.setFieldValue("ReScheduleDescription",null),b.setFieldValue("ReScheduleId",null)}})})}}),(0,S.jsx)(v.Form.Item,{name:"Direction",className:"mb-0",children:(0,S.jsx)(f.Z,{disabled:!0,className:"w-[50px] py-[2px]"})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,name:"ReScheduleId"}),(0,S.jsx)(v.Form.Item,{name:"ReScheduleDescription",className:"flex-1 mb-0",children:(0,S.jsx)(f.Z,{readOnly:!0,className:"py-[2px]"})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.endDate!==t.endDate},children:function(e){var t=(0,e.getFieldValue)("endDate");return(0,S.jsx)(v.Form.Item,{className:"col-span-1 mb-0",children:(0,S.jsx)(v.Button,{disabled:!t,className:"text-xs py-[3px]",type:"primary",onClick:re,children:"..."})})}})]})})})},{type:"component",component:(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.endDate!==t.endDate},children:function(e){var t,l,a,n,s=e.getFieldValue,r=(e.setFieldValue,null),o=s("endDate");return o&&O.EventDate&&(N()(o)-N()(O.EventDate)>0?"IN"===s("Direction")?(r=0,n=N()(o).format("YYYY-MM-DD"),(0,i.Z)({method:"get",url:"tas/employeestatus/lasterstatus/offsite/".concat(ae,"/").concat(n)}).then((function(e){b.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))):(r=1,function(e){(0,i.Z)({method:"get",url:"tas/employeestatus/lasterstatus/onsite/".concat(ae,"/").concat(e)}).then((function(e){b.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(N()(o).format("YYYY-MM-DD"))):"IN"===s("Direction")?(r=1,function(e){(0,i.Z)({method:"get",url:"tas/employeestatus/futurefirststatus/onsite/".concat(ae,"/").concat(e)}).then((function(e){b.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(N()(o).format("YYYY-MM-DD"))):(r=0,function(e){(0,i.Z)({method:"get",url:"tas/employeestatus/futurefirststatus/offsite/".concat(ae,"/").concat(e)}).then((function(e){b.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(N()(o).format("YYYY-MM-DD")))),(0,S.jsx)(v.Form.Item,{label:"Shift Status",name:"ShiftId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Shift is required"}],children:(0,S.jsx)(p.Z,{options:"number"===typeof r?null===(t=le.referData)||void 0===t||null===(l=t.roomStatuses)||void 0===l?void 0:l.filter((function(e){return e.OnSite===r})):null===(a=le.referData)||void 0===a?void 0:a.roomStatuses,filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},className:"w-full",showSearch:!0,allowClear:!0})})}})},{label:"Reason",name:"Reason",className:"col-span-12",type:"textarea",inputprops:{showCount:!0,maxLength:300}}],oe=[{label:"Date",name:"EventDate",cellRender:function(e){return(0,S.jsx)("div",{children:N()(e.data.EventDate).format("YYYY-MM-DD ddd")})}},{label:"Code",name:"Code"},{label:"Description",name:"Description"},{label:"Direction",name:"Direction"},{label:"Status",name:"Status",cellRender:function(e){return(0,S.jsx)(j.Z,{color:"Confirmed"===e.value?"success":"orange",className:"text-xs",children:e.value})}},{label:"Reschedule",name:"",alignment:"center",cellRender:function(e){return(0,S.jsx)("button",{type:"button",onClick:function(){return function(e){U(e);var t=b.getFieldsValue();t=(0,a.Z)((0,a.Z)({},t),{},{startDate:N()(e.EventDate),Direction:e.Direction,existingScheduleId:e.ScheduleId,startFlight:"".concat(e.Code," ").concat(e.Description),ShiftId:"IN"===e.Direction?ne.Id:se.Id,endDate:null,ReScheduleId:null}),b.setFieldsValue(t)}(e.data)},className:"edit-button",children:"Select"})}}];return(0,S.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,S.jsxs)("div",{className:"flex flex-col border rounded-ot",children:[(0,S.jsxs)("div",{className:"flex px-2 py-2 justify-between items-center leading-none",children:[(0,S.jsx)("div",{className:"items-start relative font-bold text-lg",children:"Choose Travel"}),(0,S.jsx)(F,{value:R,onChange:function(e){return E(e)}})]}),(0,S.jsx)(v.Table,{data:C,columns:oe,allowColumnReordering:!1,loading:M,pager:C.length>20,containerClass:"shadow-none border-t rounded-t-none",keyExpr:"EventDate"})]}),O&&(0,S.jsxs)("div",{className:"px-5 max-w-[700px]",children:[(0,S.jsx)("div",{className:"text-lg font-bold mb-3",children:"Reschedule Existing Travel"}),(0,S.jsx)(v.Form,{size:"small",labelCol:{flex:"150px"},form:b,fields:ie,editData:O,className:"grid grid-cols-12 gap-y-2",initValues:K})]}),(0,S.jsx)(v.Modal,{title:"Select Transport",open:G,width:900,onCancel:function(){return B(!1)},destroyOnClose:!1,children:(0,S.jsx)(v.TransportSearch,{initialSearchValues:_,handleSelect:function(e){_.transportType,b.setFieldValue("ReScheduleDescription","".concat(e.Code," ").concat(e.Description)),b.setFieldValue("ReScheduleId",e.Id),B(!1)},directionDisabled:!1})})]})},y=l(31283),C=g.Z.RangePicker;var Z=function(e){var t,l,n,o=e.form,d=(0,r.useState)([]),c=(0,s.Z)(d,2),u=c[0],m=c[1],x=(0,r.useState)([null,null]),h=(0,s.Z)(x,2),b=h[0],F=h[1],T=(0,r.useState)(!1),Z=(0,s.Z)(T,2),w=Z[0],V=Z[1],R=(0,r.useState)(null),E=(0,s.Z)(R,2),Y=E[0],q=E[1],M=(0,r.useContext)(D.V).state,L=(0,I.UO)().empId;null===(t=M.referData)||void 0===t||t.roomStatuses.find((function(e){return"RR"===e.Code})),null===(l=M.referData)||void 0===l||l.roomStatuses.find((function(e){return"DS"===e.Code})),(0,r.useEffect)((function(){var e;V(!0),(0,i.Z)({method:"get",url:"tas/transport?employeeId=".concat(L).concat(b[0]?"&startDate=".concat(null===(e=N()(b[0]))||void 0===e?void 0:e.format("YYYY-MM-DD")):"").concat(b[1]?"&endDate=".concat(N()(b[1]).format("YYYY-MM-DD")):"")}).then((function(e){m(e.data.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{label:N()(e.EventDate).format("YYYY-MM-DD")})})))})).catch((function(e){})).then((function(){return V(!1)}))}),[b]);var P=[{label:"Date",name:"EventDate",cellRender:function(e){return(0,S.jsx)("div",{children:N()(e.data.EventDate).format("YYYY-MM-DD ddd")})}},{label:"Code",name:"Code"},{label:"Description",name:"Description"},{label:"Direction",name:"Direction"},{label:"Status",name:"Status",cellRender:function(e){return(0,S.jsx)(j.Z,{color:"Confirmed"===e.value?"success":"orange",className:"text-xs",children:e.value})}},{label:"Reschedule",name:"",alignment:"center",cellRender:function(e){return u.length-1!==e.rowIndex&&(0,S.jsx)("button",{type:"button",onClick:function(){return function(e,t){var l=u[t.rowIndex+1];q(e),o.setFieldsValue(M.userProfileData),o.setFieldValue(["firstTransport","Date"],N()(e.EventDate)),o.setFieldValue(["firstTransport","Direction"],e.Direction),o.setFieldValue(["firstTransport","Description"],e.Description),o.setFieldValue(["firstTransport","firstScheduleId"],e.ScheduleId),o.setFieldValue(["lastTransport","Date"],N()(l.EventDate).format("YYYY-MM-DD")),o.setFieldValue(["lastTransport","Direction"],l.Direction),o.setFieldValue(["lastTransport","Description"],l.Description),o.setFieldValue(["lastTransport","lastScheduleId"],l.ScheduleId),o.setFieldValue("ShiftId",null)}(e.data,e)},className:"edit-button",children:"Select"})}}];return(0,S.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,S.jsxs)("div",{className:"flex flex-col border rounded-ot",children:[(0,S.jsxs)("div",{className:"flex px-2 py-2 justify-between items-center leading-none",children:[(0,S.jsx)("div",{className:"items-start relative font-bold text-lg",children:"Choose Travel"}),(0,S.jsx)(C,{value:b,onChange:function(e){return F(e)}})]}),(0,S.jsx)(v.Table,{data:u,columns:P,allowColumnReordering:!1,loading:w,pager:u.length>20,containerClass:"shadow-none border-t rounded-t-none",keyExpr:"EventDate"})]}),Y&&(0,S.jsxs)("div",{className:"px-5 max-w-[700px]",children:[(0,S.jsx)("div",{className:"text-lg font-bold mb-3",children:"Remove Existing Travel"}),(0,S.jsxs)("div",{className:"grid grid-cols-12 gap-y-2",children:[(0,S.jsx)(v.Form.Item,{label:"First Transport",labelCol:{flex:"150px"},className:"col-span-12 mb-2",children:(0,S.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,S.jsx)(v.Form.Item,{name:["firstTransport","Date"],className:"mb-0 col-span-3",children:(0,S.jsx)(g.Z,{disabled:!0,className:"w-full"})}),(0,S.jsx)(v.Form.Item,{name:["firstTransport","Direction"],className:"mb-0 col-span-2",children:(0,S.jsx)(p.Z,{disabled:!0,options:[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}],className:"w-full"})}),(0,S.jsx)(v.Form.Item,{className:"mb-0 col-span-7",name:["firstTransport","Description"],rules:[{required:!0,message:"Flight is required"}],children:(0,S.jsx)(f.Z,{disabled:!0,className:"w-full"})}),(0,S.jsx)(v.Form.Item,{name:["firstTransport","firstScheduleId"],noStyle:!0,className:"mb-0 col-span-7",rules:[{required:!0,message:"Flight is required"}]})]})}),(0,S.jsx)(v.Form.Item,{label:"Last Transport",labelCol:{flex:"150px"},className:"col-span-12 mb-2",children:(0,S.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,S.jsx)(v.Form.Item,{name:["lastTransport","Date"],className:"mb-0 col-span-3",children:(0,S.jsx)(p.Z,{options:u.filter((function(e){return e.Direction!==(null===Y||void 0===Y?void 0:Y.Direction)&&N()(e.EventDate).diff(N()(Y.EventDate))>0})),fieldNames:{value:"EventDate",label:"label"},onChange:function(e,t){return l=t,o.setFieldValue(["lastTransport","Description"],l.Description),void o.setFieldValue(["lastTransport","lastScheduleId"],l.ScheduleId);var l}})}),(0,S.jsx)(v.Form.Item,{name:["lastTransport","Direction"],className:"mb-0 col-span-2",children:(0,S.jsx)(p.Z,{disabled:!0,options:[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}],className:"w-full"})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,name:["lastTransport","lastScheduleId"]}),(0,S.jsx)(v.Form.Item,{name:["lastTransport","Description"],className:"mb-0 col-span-7",children:(0,S.jsx)(f.Z,{disabled:!0})})]})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.firstTransport.Description!==t.firstTransport.Description||e.lastTransport.Date!==t.lastTransport.Date},children:function(e){var t,l,a=e.getFieldValue,n=null,s=a(["firstTransport","Date"]);return"IN"===a(["firstTransport","Direction"])?(n=0,s&&(l=N()(s).format("YYYY-MM-DD"),(0,i.Z)({method:"get",url:"tas/employeestatus/lasterstatus/offsite/".concat(L,"/").concat(l)}).then((function(e){o.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){})))):(n=1,s&&function(e){(0,i.Z)({method:"get",url:"tas/employeestatus/lasterstatus/onsite/".concat(L,"/").concat(e)}).then((function(e){o.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(N()(s).format("YYYY-MM-DD"))),(0,S.jsx)(v.Form.Item,{className:"col-span-12 mb-2",name:"ShiftId",label:"Shift Status",labelCol:{flex:"150px"},rules:[{required:!0,message:"Shift Status is required"}],children:(0,S.jsx)(p.Z,{options:"number"===typeof n?null===(t=M.referData)||void 0===t?void 0:t.roomStatuses.filter((function(e){return e.OnSite===n})):[],showSearch:!0,allowClear:!0})})}}),(0,S.jsx)(v.Form.Item,{className:"col-span-12 mb-2",name:"CostCodeId",label:"Cost Code",labelCol:{flex:"150px"},rules:[{required:!0,message:"Cost Code is required"}],children:(0,S.jsx)(p.Z,{options:null===(n=M.referData)||void 0===n?void 0:n.costCodes,filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0,allowClear:!0})}),(0,S.jsx)(v.Form.Item,{className:"col-span-12 mb-2",name:"noShow",label:"No Show",labelCol:{flex:"150px"},children:(0,S.jsx)(y.Z,{onChange:function(e){o.setFieldValue("noShow",e.target.checked?1:0)},children:"No Show"})}),(0,S.jsx)(v.Form.Item,{className:"col-span-12 mb-2",name:"Reason",label:"Reason",labelCol:{flex:"150px"},rules:[{required:!0,message:"Reason is required"}],children:(0,S.jsx)(f.Z.TextArea,{maxLength:300,showCount:!0})})]})]})]})},w=l(2135),V=l(36459),R=l(14261),E=l(3489),Y=l(66736),q=l(82138),M=E.Z.Dragger;var L=function(e){var t=e.mainForm,l=(e.getMaster,(0,r.useState)(!1)),a=(0,s.Z)(l,2),d=a[0],c=a[1],u=(0,r.useState)([]),m=(0,s.Z)(u,2),f=m[0],p=m[1],x=o.Z.useForm(),h=(0,s.Z)(x,1)[0],g=[{type:"component",component:(0,S.jsx)(v.Form.Item,{name:"files",valuePropName:"file",label:"File",className:"col-span-12 mb-2",children:(0,S.jsxs)(M,{beforeUpload:!0,multiple:!0,maxCount:5,onChange:function(e){return function(e){var t=[];e.fileList.map((function(e){t.push(e.originFileObj)})),p(t)}(e)},accept:".doc, .docx, .pdf, .txt, .rtf, .ppt, .pptx, .xls, .xlsx, .jpg, .jpeg, .png, .gif, .bmp, .tiff, .svg, .eml, .msg",children:[(0,S.jsx)(Y.Z,{color:"blue",style:{fontSize:32,marginBottom:8}}),(0,S.jsx)("p",{className:"text-sm pb-1",children:"Click or drag file to this area to upload"}),(0,S.jsx)("p",{className:"opacity-50 text-sm",children:"Support for a single or bulk upload."})]})},"form-item-c file-1")},{label:"Comment",name:"comment",className:"col-span-12 mb-2",type:"textarea"},{label:"Include E-Mail",name:"includeEmail",className:"col-span-12 mb-2",type:"check"}],j=[{label:"File",name:"file",alignment:"left",cellRender:function(e){return(0,S.jsx)("div",{children:"File"})}},{label:"Uploader name",name:"FullName",alignment:"left"},{label:"Created Date",name:"CreatedDate",alignment:"left"},{label:"Include E-Mail",name:"includeEmail",alignment:"left",cellRender:function(e){return(0,S.jsx)(R.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})}},{label:"Comment",name:"comment",alignment:"left"},{label:"",name:"action",width:"100px",alignment:"center",cellRender:function(e){return(0,S.jsx)("button",{type:"button",className:"dlt-button",onClick:function(l){return function(e,l){var a;l.stopPropagation();var n=null===(a=t.getFieldValue("files"))||void 0===a?void 0:a.filter((function(t){return e.data.fileAddressId!==t.fileAddressId}));t.setFieldValue("files",n)}(e,l)},children:"Delete"})}}],D=function(){h.resetFields(),c(!1)};return(0,S.jsxs)("div",{className:"col-span-12",children:[(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.files!==t.files},className:"col-span-12",children:function(e){return(0,V.Z)(e),(0,S.jsx)(v.Table,{data:t.getFieldValue("files"),columns:j,allowColumnReordering:!1,containerClass:"shadow-none border border-gray-300",keyExpr:"Id",pager:t.getFieldValue("files").length>20,title:(0,S.jsxs)("div",{className:"flex justify-between items-center py-2 gap-3 border-b",children:[(0,S.jsx)("div",{className:"text-md font-bold pl-2",children:"Attachments"}),(0,S.jsx)("div",{className:"flex gap-4 items-center",children:(0,S.jsx)(v.Button,{icon:(0,S.jsx)(q.Z,{}),onClick:function(){return c(!0)},className:"text-xs",htmlType:"button",children:"Add Attachment"})})]})})}}),(0,S.jsx)(v.Modal,{title:"Add Attachment",open:d,onCancel:function(){return c(!1)},children:(0,S.jsx)(v.Form,{form:h,fields:g,size:"small",className:"grid grid-cols-12 gap-x-8",onFinish:function(e){var l=new FormData;f.map((function(e){l.append("files",e)})),(0,i.Z)({method:"post",url:"/tas/SysFile/multi",data:l}).then((function(l){var a=[];a=t.getFieldValue("files")?[].concat((0,n.Z)(t.getFieldValue("files")),(0,n.Z)(l.data.map((function(t){return{fileAddressId:t.Id,comment:e.comment,includeEmail:e.includeEmail}})))):l.data.map((function(t){return{fileAddressId:t.Id,comment:e.comment,includeEmail:e.includeEmail}})),t.setFieldValue("files",a),h.resetFields(),D(!1)})).catch((function(e){})),c(!1)},noLayoutConfig:!0,layout:"vertical",children:(0,S.jsxs)("div",{className:"col-span-12 flex justify-end gap-3",children:[(0,S.jsx)(v.Button,{htmlType:"submit",type:"primary",icon:(0,S.jsx)(q.Z,{}),children:"Add"}),(0,S.jsx)(v.Button,{htmlType:"button",onClick:D,children:"Cancel"})]})})})]})},P=l(52957),k=l(76446);N().extend(k);var O=function(e){var t,l,n,o,d,c,u,m,x,h,j,b,F=e.form,T=(e.onSubmit,(0,r.useContext)(D.V).state),y=(0,r.useState)(null),C=(0,s.Z)(y,2),Z=C[0],w=C[1],V=(0,r.useState)(null),R=(0,s.Z)(V,2),E=R[0],Y=(R[1],(0,r.useState)(!1)),q=(0,s.Z)(Y,2),M=(q[0],q[1],(0,r.useState)([])),L=(0,s.Z)(M,2),k=L[0],O=L[1],U=(0,r.useState)(!1),A=(0,s.Z)(U,2),z=A[0],G=A[1],B=(0,r.useState)(null),H=(0,s.Z)(B,2),W=H[0],_=H[1],J=((0,I.TH)(),(0,I.UO)().empId),$=null===(t=T.referData)||void 0===t?void 0:t.roomStatuses.find((function(e){return"DS"===e.Code})),X={DepartLocationId:null===(l=T.referData)||void 0===l||null===(n=l.locations)||void 0===n?void 0:n.find((function(e){return"UB"===e.Code})).Id,ArriveLocationId:null===(o=T.referData)||void 0===o||null===(d=o.locations)||void 0===d?void 0:d.find((function(e){return"OT"===e.Code})).Id},K={DepartLocationId:null===(c=T.referData)||void 0===c||null===(u=c.locations)||void 0===u?void 0:u.find((function(e){return"OT"===e.Code})).Id,ArriveLocationId:null===(m=T.referData)||void 0===m||null===(x=m.locations)||void 0===x?void 0:x.find((function(e){return"UB"===e.Code})).Id};(0,r.useEffect)((function(){F.setFieldsValue(T.userProfileData),F.setFieldValue("ShiftId",$.value)}),[T.userProfileData]),(0,r.useEffect)((function(){if(Z&&E){var e=null===Z||void 0===Z?void 0:Z.format("YYYY-MM-DD"),t=E.diff(Z,"month");(0,i.Z)({method:"get",url:"tas/employeestatus/annualyear/".concat(J,"/").concat(e,"/").concat(t+1)}).then((function(e){O(e.data)})).catch((function(e){}))}}),[Z,E]);var Q=[{label:"Shift",name:"ShiftCode",width:"50px"},{label:"Description",name:"Description"},{label:"Date",name:"EvenDate",cellRender:function(e){return(0,S.jsx)("div",{children:N()(e.value).format("YYYY-MM-DD")})}}],ee=function(){var e={StartDate:F.getFieldValue(["firstTransport","Date"])?F.getFieldValue(["firstTransport","Date"]):null,EndDate:null};e=F.getFieldValue(["firstTransport","Direction"])&&"IN"===F.getFieldValue(["firstTransport","Direction"])?(0,a.Z)((0,a.Z)({},e),X):(0,a.Z)((0,a.Z)({},e),K),_((0,a.Z)((0,a.Z)({},e),{},{transportType:"first"})),G(!0)},te=function(){var e={StartDate:F.getFieldValue(["lastTransport","Date"])?F.getFieldValue(["lastTransport","Date"]):null,EndDate:null};e=F.getFieldValue(["lastTransport","Direction"])&&"IN"===F.getFieldValue(["lastTransport","Direction"])?(0,a.Z)((0,a.Z)({},e),X):(0,a.Z)((0,a.Z)({},e),K),_((0,a.Z)((0,a.Z)({},e),{},{transportType:"last"})),G(!0)};return(0,S.jsxs)("div",{className:"max-w-[700px] grid grid-cols-12 px-5 gap-5 items-start",children:[(0,S.jsxs)("div",{className:"col-span-12",children:[(0,S.jsx)("div",{className:"text-lg font-bold mb-3",children:"New Travel Request"}),(0,S.jsxs)("div",{className:"grid grid-cols-12",children:[(0,S.jsx)(v.Form.Item,{label:"First Transport",labelCol:{flex:"150px"},className:"col-span-12 mb-3",children:(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsx)(v.Form.Item,{name:["firstTransport","Date"],className:"mb-0 col-span-3",children:(0,S.jsx)(g.Z,{showWeek:!0,onChange:function(e){w(e),F.setFieldValue("RoomId",""),F.setFieldValue(["firstTransport","flightId"],null),F.setFieldValue(["firstTransport","Description"],null)},className:"w-full"})}),(0,S.jsx)(v.Form.Item,{name:["firstTransport","Direction"],className:"mb-0 w-[70px]",children:(0,S.jsx)(p.Z,{options:[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}],onChange:function(e){"IN"===e?(F.setFieldValue(["lastTransport","Direction"],"OUT"),F.setFieldValue(["firstTransport","Description"],null),F.setFieldValue(["firstTransport","flightId"],null),F.setFieldValue(["lastTransport","Description"],null),F.setFieldValue(["lastTransport","flightId"],null)):(F.setFieldValue(["lastTransport","Direction"],"IN"),F.setFieldValue(["firstTransport","flightId"],null),F.setFieldValue(["firstTransport","Description"],null),F.setFieldValue(["lastTransport","flightId"],null),F.setFieldValue(["lastTransport","Description"],null))}})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,name:["firstTransport","flightId"]}),(0,S.jsx)(v.Form.Item,{name:["firstTransport","Description"],className:"flex-1 mb-0",children:(0,S.jsx)(f.Z,{readOnly:!0,className:"py-[1px]"})}),(0,S.jsx)(v.Form.Item,{className:"col-span-1 mb-0",shouldUpdate:function(e,t){var l,a,n,s;return(null===(l=e.firstTransport)||void 0===l?void 0:l.Date)!==(null===(a=t.firstTransport)||void 0===a?void 0:a.Date)||(null===(n=e.firstTransport)||void 0===n?void 0:n.Direction)!==(null===(s=t.firstTransport)||void 0===s?void 0:s.Direction)},children:function(e){var t=e.getFieldValue;return(0,S.jsx)(v.Button,{className:"text-xs py-[2px]",type:"primary",onClick:ee,disabled:!t(["firstTransport","Date"])||!t(["firstTransport","Direction"]),children:"..."})}})]})}),(0,S.jsx)(v.Form.Item,{label:"Last Transport",labelCol:{flex:"150px"},className:"col-span-12 mb-3",children:(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var l,a,n,s;return(null===(l=e.firstTransport)||void 0===l?void 0:l.Date)!==(null===(a=t.firstTransport)||void 0===a?void 0:a.Date)||(null===(n=e.lastTransport)||void 0===n?void 0:n.Date)!==(null===(s=t.lastTransport)||void 0===s?void 0:s.Date)},children:function(e){var t=e.getFieldValue,l=!1;return t(["lastTransport","Date"])||(l=t(["firstTransport","Date"])),(0,S.jsx)(v.Form.Item,{name:["lastTransport","Date"],className:"mb-0 col-span-3",children:(0,S.jsx)(g.Z,{defaultPickerValue:l,showWeek:!0,className:"w-full",onChange:function(){F.setFieldValue(["lastTransport","Description"],null),F.setFieldValue(["lastTransport","flightId"],null)}})})}}),(0,S.jsx)(v.Form.Item,{name:["lastTransport","Direction"],className:"mb-0 w-[70px]",children:(0,S.jsx)(f.Z,{className:"py-[1px]",disabled:!0})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,name:["lastTransport","flightId"]}),(0,S.jsx)(v.Form.Item,{name:["lastTransport","Description"],className:"flex-1 mb-0",children:(0,S.jsx)(f.Z,{readOnly:!0,className:"py-[1px]"})}),(0,S.jsx)(v.Form.Item,{className:"col-span-1 mb-0",shouldUpdate:function(e,t){var l,a,n,s;return(null===(l=e.lastTransport)||void 0===l?void 0:l.Date)!==(null===(a=t.lastTransport)||void 0===a?void 0:a.Date)||(null===(n=e.lastTransport)||void 0===n?void 0:n.Direction)!==(null===(s=t.lastTransport)||void 0===s?void 0:s.Direction)},children:function(e){var t=e.getFieldValue;return(0,S.jsx)(v.Button,{className:"text-xs py-[2px]",type:"primary",onClick:te,disabled:!t(["lastTransport","Date"])||!t(["lastTransport","Direction"]),children:"..."})}})]})}),(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var l,a;return(null===(l=e.firstTransport)||void 0===l?void 0:l.Direction)!==(null===(a=t.firstTransport)||void 0===a?void 0:a.Direction)},children:function(e){var t,l,a,n,s=e.getFieldValue;e.setFieldValue;return"OUT"===s(["firstTransport","Direction"])?(0,S.jsx)(v.Form.Item,{label:"Shift",labelCol:{flex:"150px"},name:"ShiftId",className:"col-span-12 mb-3",rules:[{required:!0,message:"Shift is required"}],children:(0,S.jsx)(p.Z,{options:null===(t=T.referData)||void 0===t||null===(l=t.roomStatuses)||void 0===l?void 0:l.filter((function(e){return 0===e.OnSite})),className:"w-full",filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0,allowClear:!0})}):(0,S.jsx)(v.Form.Item,{label:"Shift",labelCol:{flex:"150px"},name:"ShiftId",className:"col-span-12 mb-3",rules:[{required:!0,message:"Shift is required"}],children:(0,S.jsx)(p.Z,{options:null===(a=T.referData)||void 0===a||null===(n=a.roomStatuses)||void 0===n?void 0:n.filter((function(e){return 1===e.OnSite})),className:"w-full",filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0,allowClear:!0})})}}),(0,S.jsx)(v.Form.Item,{label:"Department",name:"DepartmentId",className:"col-span-12 mb-3",labelCol:{flex:"150px"},rules:[{required:!0,message:"Department is required"}],children:(0,S.jsx)(P.Z,{treeData:T.referData.departments,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},filterTreeNode:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.Name)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},allowClear:!0,showSearch:!0})},"form-item-DepartmentId"),(0,S.jsx)(v.Form.Item,{label:"Position",name:"PositionId",labelCol:{flex:"150px"},className:"col-span-12 mb-3",rules:[{required:!0,message:"Position is required"}],children:(0,S.jsx)(p.Z,{allowClear:!0,showSearch:!0,filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},options:null===(h=T.referData)||void 0===h?void 0:h.positions})},"form-item-PositionId"),(0,S.jsx)(v.Form.Item,{label:"Cost Code",name:"CostCodeId",labelCol:{flex:"150px"},className:"col-span-12 mb-3",rules:[{required:!0,message:"Cost Code is required"}],children:(0,S.jsx)(p.Z,{allowClear:!0,showSearch:!0,filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},options:null===(j=T.referData)||void 0===j?void 0:j.costCodes})},"form-item-CostCodeId"),(0,S.jsx)(v.Form.Item,{label:"Employer",name:"EmployerId",labelCol:{flex:"150px"},className:"col-span-12 mb-3",rules:[{required:!0,message:"Employer is required"}],children:(0,S.jsx)(p.Z,{allowClear:!0,showSearch:!0,filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},options:null===(b=T.referData)||void 0===b?void 0:b.employers})},"form-item-EmployerId"),(0,S.jsx)(v.Form.Item,{label:"Reason",name:"Reason",labelCol:{flex:"150px"},className:"col-span-12 mb-2",children:(0,S.jsx)(f.Z.TextArea,{showCount:!0,maxLength:300})},"form-item-Reason")]})]}),k.length>0&&(0,S.jsx)("div",{className:"col-span-4",children:(0,S.jsx)(v.Table,{data:k,columns:Q,containerClass:"shadow-none border",tableClass:"border-t",pager:k.length>20,title:(0,S.jsx)("div",{className:"py-1 font-bold",children:"Future Annual Leave"})})}),(0,S.jsx)(v.Modal,{title:"Select Transport",open:z,width:900,onCancel:function(){return G(!1)},destroyOnClose:!1,children:(0,S.jsx)(v.TransportSearch,{initialSearchValues:W,handleSelect:function(e){"first"===W.transportType?(F.setFieldValue(["firstTransport","Date"],N()(e.EventDate)),F.setFieldValue(["firstTransport","Description"],"".concat(e.Code," ").concat(e.Description)),F.setFieldValue(["firstTransport","flightId"],e.Id),G(!1)):(F.setFieldValue(["lastTransport","Date"],N()(e.EventDate)),F.setFieldValue(["lastTransport","Description"],"".concat(e.Code," ").concat(e.Description)),F.setFieldValue(["lastTransport","flightId"],e.Id),G(!1))}})})]})},U=l(1710);var A=function(){var e=(0,r.useState)(null),t=(0,s.Z)(e,2),l=t[0],a=t[1],g=(0,r.useState)(null),j=(0,s.Z)(g,2),b=(j[0],j[1]),N=(0,r.useState)(null),F=(0,s.Z)(N,2),y=F[0],C=F[1],V=(0,r.useState)(0),R=(0,s.Z)(V,2),E=R[0],Y=R[1],q=(0,r.useState)(!1),M=(0,s.Z)(q,2),P=M[0],k=M[1],A=(0,r.useState)([]),z=(0,s.Z)(A,2),G=z[0],B=z[1],H=(0,r.useState)(null),W=(0,s.Z)(H,2),_=W[0],J=W[1],$=(0,r.useState)(!1),X=(0,s.Z)($,2),K=X[0],Q=X[1],ee=(0,r.useState)(null),te=(0,s.Z)(ee,2),le=te[0],ae=te[1],ne=(0,r.useState)({documentData:{},flightData:{},files:[]}),se=(0,s.Z)(ne,2),re=(se[0],se[1],o.Z.useForm()),ie=(0,s.Z)(re,1)[0],oe=o.Z.useForm(),de=(0,s.Z)(oe,1)[0],ce=o.Z.useForm(),ue=(0,s.Z)(ce,1)[0],me=o.Z.useForm(),fe=((0,s.Z)(me,1)[0],d.ZP.useNotification()),pe=(0,s.Z)(fe,2),xe=(pe[0],pe[1]),he=(0,r.useContext)(D.V),ve=(he.action,he.state,(0,I.s0)()),ge=(0,I.UO)().empId;(0,r.useEffect)((function(){je()}),[]);var je=function(e){(0,i.Z)({method:"get",url:"/tas/requestgroupconfig/groupandmembers/bytype/Site Travel?empId=".concat(ge)}).then((function(e){ae(e.data);var t=e.data.groups[0],l=(0,n.Z)(e.data.groups);l.unshift({GroupName:"Requester",id:0}),l.push({GroupName:"Completed",id:99999}),a(l),ie.setFieldValue("files",[]),b(t);var s=[];t.groupMembers.map((function(e){s.push({value:e.employeeId,label:e.fullName})})),ie.setFieldValue("assignEmployeeOptions",s),ie.setFieldValue("nextGroupName",null===t||void 0===t?void 0:t.GroupName),ie.setFieldValue("nextGroupId",null===t||void 0===t?void 0:t.id),J(t)}))},De=[{label:"Group",name:"GroupName"},{label:"Current Position",name:"CurrentPosition",alignment:"left",cellRender:function(e){return(0,S.jsx)("div",{children:0===e.rowIndex?(0,S.jsx)(x.Z,{style:{color:"#e57200"}}):""})}}],be=[{title:"Choose Request Type",content:(0,S.jsx)("div",{className:"flex flex-col items-start gap-4 p-4",children:(0,S.jsx)(c.ZP.Group,{onChange:function(e){C(e.target.value),Y(E+1)},children:(0,S.jsxs)(u.Z,{direction:"vertical",children:[(0,S.jsx)(c.ZP,{value:1,children:"New Travel Request"}),(0,S.jsx)(u.Z,{className:"ml-6",children:"\u2022 Add a new site travel request"}),(0,S.jsx)(c.ZP,{value:2,children:"Reschedule Existing Travel"}),(0,S.jsx)(u.Z,{className:"ml-6",children:"\u2022 Change the details of an existing travel request"}),(0,S.jsx)(c.ZP,{value:3,children:"Remove Existing Travel"}),(0,S.jsx)(u.Z,{className:"ml-6",children:"\u2022 Remove existing travel request"})]})})})},{title:"Form",content:(0,S.jsx)("div",{children:1===y?(0,S.jsx)(O,{form:ie}):2===y?(0,S.jsx)(T,{data:null,form:ue}):3===y?(0,S.jsx)(Z,{form:ie}):null})}],Ne=be.map((function(e){return{key:e.title,title:e.title}})),Ie=function(e){Q(!0),(0,i.Z)({method:"post",url:"tas/requestsitetravel/addtravel/checkduplicate",data:{employeeId:ge,inScheduleId:"IN"===e.firstTransport.Direction?e.firstTransport.flightId:e.lastTransport.flightId,outScheduleId:"OUT"===e.firstTransport.Direction?e.firstTransport.flightId:e.lastTransport.flightId}}).then((function(t){B(t.data),0===t.data.length?(0,i.Z)({method:"post",url:"tas/requestsitetravel/addtravel",data:{documentData:{comment:e.comment,employeeId:ge,action:"Submitted",assignedEmployeeId:e.assignedEmployeeId,nextGroupId:e.nextGroupId},flightData:{inScheduleId:"IN"===e.firstTransport.Direction?e.firstTransport.flightId:e.lastTransport.flightId,outScheduleId:"OUT"===e.firstTransport.Direction?e.firstTransport.flightId:e.lastTransport.flightId,departmentId:e.DepartmentId,shiftId:e.ShiftId,employerId:e.EmployerId,positionId:e.PositionId,costcodeId:e.CostCodeId,Reason:e.Reason},files:e.files}}).then((function(e){ve("/guest/request")})).catch((function(e){})).then((function(){return Q(!1)})):(k(!0),Q(!1))})).catch((function(){Q(!1)}))},Se=function(e){Q(!0);var t={existingScheduleId:ue.getFieldValue("existingScheduleId"),reScheduleId:ue.getFieldValue("ReScheduleId"),shiftId:ue.getFieldValue("ShiftId"),Reason:ue.getFieldValue("Reason")};(0,i.Z)({method:"post",url:"tas/requestsitetravel/reschedule/checkduplicate",data:{existingScheduleId:t.existingScheduleId,reScheduleId:t.reScheduleId,employeeId:ge}}).then((function(l){B(l.data),0===l.data.length?(0,i.Z)({method:"post",url:"tas/requestsitetravel/reschedule",data:{documentData:{comment:e.comment,employeeId:ge,action:"Submitted",assignedEmployeeId:e.assignedEmployeeId,nextGroupId:e.nextGroupId},flightData:t,files:e.files}}).then((function(e){ve("/guest/request")})).catch((function(e){})).then((function(){return Q(!1)})):(Q(!1),k(!0))})).catch((function(){Q(!1)}))},Fe=function(e){var t,l;Q(!0),(0,i.Z)({method:"post",url:"tas/requestsitetravel/remove/checkduplicate",data:{employeeId:ge,firstScheduleId:null===e||void 0===e||null===(t=e.firstTransport)||void 0===t?void 0:t.firstScheduleId,lastScheduleId:null===e||void 0===e||null===(l=e.lastTransport)||void 0===l?void 0:l.lastScheduleId,Reason:null===e||void 0===e?void 0:e.Reason}}).then((function(t){var l,a;(B(t.data),0===t.data.length)?(0,i.Z)({method:"post",url:"tas/requestsitetravel/removetravel",data:{documentData:{comment:e.comment,employeeId:ge,action:"Submitted",assignedEmployeeId:e.assignedEmployeeId,nextGroupId:e.nextGroupId},flightData:{firstScheduleId:null===e||void 0===e||null===(l=e.firstTransport)||void 0===l?void 0:l.firstScheduleId,lastScheduleId:null===e||void 0===e||null===(a=e.lastTransport)||void 0===a?void 0:a.lastScheduleId,shiftId:e.ShiftId,CostCodeId:e.CostCodeId,Reason:e.Reason,noShow:e.noShow?1:0},files:e.files}}).then((function(e){ve("/guest/request")})).catch((function(e){})).then((function(){return Q(!1)})):(Q(!1),k(!0))})).catch((function(){Q(!1)}))};return(0,S.jsxs)("div",{className:"",children:[(0,S.jsx)(w.Link,{to:"/guest",children:(0,S.jsx)(v.Button,{icon:(0,S.jsx)(h.Z,{}),children:"Back"})}),(0,S.jsx)(v.Accordion,{title:"Profile",className:"border",children:(0,S.jsx)("div",{className:"p-3",children:(0,S.jsx)(U.Z,{employeeId:ge,pendingInfo:le})})}),(0,S.jsx)("div",{className:"flex flex-col gap-4 mt-4",children:(0,S.jsxs)(v.Form,{className:"grid grid-cols-12 gap-y-5",size:"small",form:ie,scrollToFirstError:!0,initValues:{EmergencyContactMobile:"",EmergencyContactName:"",FrequentFlyer:null,PassportExpiry:null,PassportName:"",PassportNumber:"",assignedEmployeeId:null,nextGroupId:null,nextGroupName:"null",flightData:[],accommodationData:[],files:[],assignEmployeeOptions:[],DocumentRoute:[]},onFinish:function(e){1===y?Ie(e,de.getFieldsValue()):2===y?Se(e,ue.getFieldsValue()):3===y&&Fe(e,ie.getFieldsValue())},children:[(0,S.jsx)(v.Accordion,{title:"Travel",className:"border col-span-12",children:(0,S.jsxs)("div",{className:"p-4",children:[(0,S.jsx)(m.Z,{items:Ne,current:E,size:"small"}),(0,S.jsx)("div",{style:{marginTop:16},children:be[E].content}),(0,S.jsx)("div",{className:"mt-6 flex justify-between items-center",children:E>0&&(0,S.jsx)(v.Button,{style:{margin:"0 8px"},onClick:function(){Y(E-1)},children:"Previous"})})]})}),(0,S.jsx)(v.Form.Item,{className:"col-span-12 mb-0",name:"files",children:(0,S.jsx)(L,{mainForm:ie})}),(0,S.jsx)(v.Accordion,{title:"Request Document",className:"border col-span-12",children:(0,S.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,S.jsxs)("div",{children:["Comments:",(0,S.jsx)(v.Form.Item,{className:"m-0",name:"comment",children:(0,S.jsx)(f.Z.TextArea,{autoSize:{minRows:3,maxRows:5}})})]}),(0,S.jsxs)("div",{className:"flex gap-10",children:[(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.nextGroupName!==t.nextGroupName},children:function(e){var t=e.getFieldValue;return(0,S.jsxs)(v.Form.Item,{name:"nextGroupId",className:"mb-0",children:["Next Approval: ",(0,S.jsx)("span",{className:"font-bold",children:t("nextGroupName")})]})}}),"linemanager"===(null===_||void 0===_?void 0:_.GroupTag)&&(0,S.jsx)(v.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.assignEmployeeOptions!==t.assignEmployeeOptions},children:function(e){var t=e.getFieldValue;return(0,S.jsx)(v.Form.Item,{name:"assignedEmployeeId",label:"Send to:",rules:[{required:!0,message:"Assign Employee is required"}],className:"w-[300px] mb-0",children:(0,S.jsx)(p.Z,{size:"small",options:t("assignEmployeeOptions"),className:"w-[200px]",filterOption:function(e,t){var l;return(null!==(l=null===t||void 0===t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0})})}})]})]})}),(0,S.jsx)(v.Accordion,{title:"Document Route",className:"border col-span-12",children:(0,S.jsx)("div",{className:"flex flex-col gap-4 p-4",children:(0,S.jsx)(v.Table,{data:l,columns:De,pager:!1,containerClass:"shadow-none border border-gray-300"})})})]})}),(0,S.jsxs)("div",{className:"flex justify-end mt-4 gap-4",children:[(0,S.jsx)(v.Button,{type:"primary",onClick:function(){return ie.submit()},loading:K,children:"Submit"}),(0,S.jsx)(v.Button,{disabled:K,children:"Cancel"})]}),(0,S.jsx)(v.DuplicatedDocument,{data:G,open:P,onCancel:function(){return k(!1)}}),xe]})}},66736:function(e,t,l){l.d(t,{Z:function(){return o}});var a=l(87462),n=l(47313),s={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},r=l(17469),i=function(e,t){return n.createElement(r.Z,(0,a.Z)({},e,{ref:t,icon:s}))};var o=n.forwardRef(i)}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[4761],{4761:function(e,t,n){n.r(t);var i=n(1413),a=n(29439),s=n(2880),l=n(14261),c=n(47313),o=n(65040),r=n(56573),u=n(40765),d=n(82138),m=n(92350),p=n(81514),f=n(42614),h=n(46417),v="Employer",b={Code:"",Description:"",Active:null},x=[{label:"Code",name:"Code",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-12 mb-2",rules:[{required:!0,message:"Description is required"}]}],g=[{label:"Code",name:"Code",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-12 mb-2",rules:[{required:!0,message:"Description is required"}]},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{}}],C=[{label:"Code",name:"Code",className:"col-span-3 mb-2",inputprops:{}},{label:"Description",name:"Description",className:"col-span-3 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}];t.default=function(){var e=(0,c.useState)([]),t=(0,a.Z)(e,2),n=t[0],j=t[1],y=(0,c.useState)([]),Z=(0,a.Z)(y,2),N=Z[0],k=Z[1],A=(0,c.useState)(null),w=(0,a.Z)(A,2),D=w[0],S=w[1],E=(0,c.useState)(!1),I=(0,a.Z)(E,2),F=I[0],L=I[1],q=(0,c.useState)(!1),R=(0,a.Z)(q,2),B=R[0],V=R[1],O=(0,c.useState)(!1),T=(0,a.Z)(O,2),_=T[0],M=T[1],z=(0,c.useState)(!1),G=(0,a.Z)(z,2),J=G[0],K=G[1],P=(0,c.useState)(!1),Y=(0,a.Z)(P,2),H=Y[0],Q=Y[1],U=(0,c.useState)(null),W=(0,a.Z)(U,2),X=W[0],$=W[1],ee=o.Z.useForm(),te=(0,a.Z)(ee,1)[0],ne=o.Z.useForm(),ie=(0,a.Z)(ne,1)[0],ae=(0,c.useContext)(f.V).action;(0,c.useEffect)((function(){ae.changeMenuKey("/tas/employer"),se()}),[]);var se=function(){L(!0),(0,r.Z)({method:"get",url:"tas/employer"}).then((function(e){if(j(e.data),1===ie.getFieldValue("Active")){var t=e.data.filter((function(e){return 1===e.Active}));k(t)}else if(0===ie.getFieldValue("Active")){var n=e.data.filter((function(e){return 0===e.Active}));k(n)}else k(e.data)})).catch((function(e){})).then((function(){return L(!1)}))},le=function(){ae.changeLoadingStatusReferItem({employers:!0}),(0,r.Z)({method:"get",url:"tas/employer?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push((0,i.Z)({value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)},e))})),ae.setReferDataItem({employers:t})})).catch((function(e){})).then((function(){return ae.changeLoadingStatusReferItem({employers:!1})}))},ce=(0,c.useCallback)((function(e){S(e),K(!0)}),[]),oe=(0,c.useCallback)((function(e){S(e),V(!0)}),[]),re=(0,c.useCallback)((function(e){$(e),Q(!0)}),[]),ue=[{label:"Description",name:"Description"},{label:"# Resource",name:"EmployeeCount",alignment:"left"},{label:"Active",name:"Active",width:"80px",alignment:"center",cellRender:function(e){return(0,h.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"action",width:"265px",cellRender:function(e){return(0,h.jsxs)("div",{className:"flex gap-3",children:[(0,h.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return re(e.data)},children:"View Audit"}),(0,h.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return ce(e.data)},children:"Edit"}),1===e.data.Active?e.data.EmployeeCount>0?(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{id:"target".concat(e.data.Id),className:"dlt-button_lbl",children:"Deactivate"}),(0,h.jsx)(l.u,{target:"#target".concat(e.data.Id),showEvent:"mouseenter",hideEvent:"mouseleave",hideOnOutsideClick:!1,position:"top",children:(0,h.jsx)("div",{children:"Don't deactivate because there is an active Employee"})})]}):(0,h.jsx)("button",{type:"button",disabled:e.data.EmployeeCount>0,className:"dlt-button",onClick:function(){return oe(e.data)},children:"Deactivate"}):(0,h.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return oe(e.data)},children:"Reactivate"})]})}}],de=(0,c.useCallback)((function(e){D?(0,r.Z)({method:"put",url:"tas/employer",data:(0,i.Z)((0,i.Z)({},e),{},{Id:D.Id})}).then((function(e){se(),le(),fe()})).catch((function(e){})):(0,r.Z)({method:"post",url:"tas/employer",data:(0,i.Z)((0,i.Z)({},e),{},{Active:e.Active?1:0})}).then((function(e){se(),le(),fe()})).catch((function(e){}))}),[D]),me=(0,c.useCallback)((function(){M(!0),(0,r.Z)({method:"delete",url:"tas/employer",data:{id:D.Id}}).then((function(){se(),le(),V(!1)})).catch((function(e){})).then((function(){return M(!1)}))}),[D]),pe=(0,c.useCallback)((function(e){L(!0),(0,p.Z)(e,n).then((function(e){k(e),L(!1)}))}),[n]),fe=(0,c.useCallback)((function(){K(!1)}),[]),he=(0,c.useCallback)((function(){$(null),Q(!0)}),[]);return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,h.jsx)("div",{className:"text-lg font-bold mb-2",children:v}),(0,h.jsx)(s.Form,{form:ie,fields:C,className:"grid grid-cols-12 gap-x-8",onFinish:pe,noLayoutConfig:!0,initValues:b,children:(0,h.jsx)("div",{className:"flex gap-4 col-span-2 items-baseline",children:(0,h.jsx)(s.Button,{htmlType:"submit",className:"flex items-center",loading:F,icon:(0,h.jsx)(u.Z,{}),children:"Search"})})})]}),(0,h.jsx)(s.Table,{data:N,columns:ue,allowColumnReordering:!1,loading:F,keyExpr:"Id",tableClass:"border-t max-h-[calc(100vh-250px)]",title:(0,h.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,h.jsxs)("div",{className:"flex items-center gap-1",children:[(0,h.jsx)("span",{className:"font-bold",children:N.length}),(0,h.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[(0,h.jsx)(s.Button,{onClick:he,children:"Audit"}),(0,h.jsxs)(s.Button,{icon:(0,h.jsx)(d.Z,{}),onClick:function(){S(null),te.resetFields(),K(!0)},children:["Add ",v]})]})]})}),(0,h.jsx)(s.Modal,{open:J,onCancel:function(){return K(!1)},title:D?"Edit ".concat(v):"Add ".concat(v),children:(0,h.jsx)(s.Form,{form:te,fields:D?x:g,editData:D,onFinish:de,children:(0,h.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,h.jsx)(s.Button,{type:"primary",onClick:function(){return te.submit()},loading:_,icon:(0,h.jsx)(m.Z,{}),children:"Save"}),(0,h.jsx)(s.Button,{onClick:fe,disabled:_,children:"Cancel"})]})})}),(0,h.jsxs)(l.GI,{visible:B,showTitle:!1,height:110,width:350,children:[(0,h.jsxs)("div",{children:["Are you sure you want to ",1===(null===D||void 0===D?void 0:D.Active)?"deactivate":"reactivate"," this record?"]}),(0,h.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,h.jsx)(s.Button,{type:1===(null===D||void 0===D?void 0:D.Active)?"danger":"success",onClick:me,loading:_,children:"Yes"}),(0,h.jsx)(s.Button,{onClick:function(){return V(!1)},disabled:_,children:"No"})]})]}),(0,h.jsx)(s.AuditTable,{title:"Employer Audit",tablename:"Employer",open:H,onClose:function(){return Q(!1)},record:X,recordName:X?(0,h.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",X.Code," ",X.Description,"/"]}):""})]})}},81514:function(e,t,n){n.d(t,{Z:function(){return c}});var i=n(93433),a=n(4942),s=n(1413);var l=function e(t,n,i){var l=[],c=Object.keys(n);return t.map((function(t){if(t[i].length>0)l.push((0,s.Z)((0,s.Z)({},t),{},(0,a.Z)({},i,e(t[i],n,i))));else{var o=!1;c.map((function(e){var i,a;""!==n[e]&&"undefined"!==typeof n[e]&&null!==n[e]?o="string"===typeof n[e]?o||(null===(i=t[e])||void 0===i?void 0:i.toLowerCase().includes(null===(a=n[e])||void 0===a?void 0:a.toLowerCase())):o||t[e]===n[e]:o=!0})),o&&l.push(t)}})),l};function c(e,t,n,a){return"tree"===n?l(t,e,a):new Promise((function(n,a){var s=Object.keys(e),l=(0,i.Z)(t);s.map((function(t){""!==e[t]&&"undefined"!==typeof e[t]&&null!==e[t]&&(l="string"===typeof e[t]?l.filter((function(n){var i,a;return null===(i=n[t])||void 0===i?void 0:i.toLowerCase().includes(null===(a=e[t])||void 0===a?void 0:a.toLowerCase())})):l.filter((function(n){return n[t]===e[t]})))})),n(l)}))}}}]);
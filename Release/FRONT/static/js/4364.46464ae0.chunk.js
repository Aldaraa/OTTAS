"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[4364],{78373:function(e,t,n){var a=n(1413),l=n(29439),i=n(36459),s=n(47515),o=n(82138),r=n(74294),c=n(23983),d=n(87785),u=n(14576),m=n(21975),p=n(56573),x=n(2880),h=n(47313),f=n(46417);t.Z=function(e){var t=Object.assign({},((0,i.Z)(e),e)),n=(0,h.useState)([]),v=(0,l.Z)(n,2),g=v[0],j=v[1],b=(0,h.useState)(""),y=(0,l.Z)(b,2),C=y[0],w=y[1],D=(0,h.useState)(null),N=(0,l.Z)(D,2),Z=N[0],k=N[1],E=(0,h.useState)(!1),S=(0,l.Z)(E,2),F=S[0],B=S[1],R=(0,h.useRef)(null);(0,h.useEffect)((function(){T()}),[]);var T=(0,h.useCallback)((function(){(0,p.Z)({method:"get",url:"tas/busstop?Active=1"}).then((function(e){j(e.data)}))}),[]),Y=(0,h.useCallback)((function(e){w(e.target.value)}),[]),A=function(e){e.preventDefault(),B(!0),(0,p.Z)({method:"post",url:"tas/busstop",data:{description:C,active:1}}).then((function(e){w(""),T()})).catch((function(){})).then((function(){B(!1)}))},I=(0,h.useCallback)((function(e,t){e.preventDefault(),e.stopPropagation(),k(t)}),[]),M=(0,h.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),B(!0),(0,p.Z)({method:"delete",url:"tas/busstop",data:{id:null===Z||void 0===Z?void 0:Z.Id}}).then((function(e){T()})).catch((function(e){})).then((function(){B(!1)}))}),[Z]),O=(0,h.useCallback)((function(e){e.stopPropagation(),e.preventDefault()}),[]);return(0,f.jsx)(r.Z,(0,a.Z)((0,a.Z)({},t),{},{className:"w-full",options:g.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{value:e.Description,label:e.Description})})),style:{width:250},popupMatchSelectWidth:!1,optionRender:function(e){return(0,f.jsxs)("div",{className:"flex justify-between items-center",children:[(0,f.jsx)("span",{children:e.data.label}),(0,f.jsx)(c.Z,{title:"Are you sure to remove ?",onConfirm:M,cancelButtonProps:{style:{backgroundColor:"white"}},okButtonProps:{loading:F},onPopupClick:O,children:(0,f.jsx)(x.Button,{type:"danger",className:"px-1",onClick:function(t){return I(t,e.data)},children:(0,f.jsx)(s.Z,{})})})]})},dropdownRender:function(e){return(0,f.jsxs)(f.Fragment,{children:[e,(0,f.jsx)(d.Z,{style:{margin:"8px 0"}}),(0,f.jsxs)(u.Z,{style:{padding:"0 8px 4px"},children:[(0,f.jsx)(m.Z,{placeholder:"Please enter item",ref:R,value:C,onChange:Y,onKeyDown:function(e){return e.stopPropagation()}}),(0,f.jsx)(x.Button,{type:"text",icon:(0,f.jsx)(o.Z,{}),loading:F,onClick:A,children:"Add"})]})]})}}))}},38209:function(e,t,n){var a=n(93433),l=n(1413),i=n(29439),s=n(45987),o=n(2880),r=n(47313),c=n(78373),d=n(21975),u=n(31118),m=n(60020),p=n(82138),x=n(82508),h=n(92350),f=n(56573),v=n(73030),g=n(46417),j=["rowData","onReset"],b=["key","name"],y={labelCol:{xs:{span:24},sm:{span:10}},wrapperCol:{xs:{span:24},sm:{span:16}}};t.Z=function(e){var t,n=e.rowData,C=e.onReset,w=(0,s.Z)(e,j),D=(0,r.useState)(!1),N=(0,i.Z)(D,2),Z=N[0],k=N[1],E=(0,r.useState)(!0),S=(0,i.Z)(E,2),F=S[0],B=S[1],R=(0,r.useState)(),T=(0,i.Z)(R,2),Y=T[0],A=T[1],I=(0,r.useState)(!1),M=(0,i.Z)(I,2),O=M[0],P=M[1],L=o.Form.useForm(),U=(0,i.Z)(L,1)[0];(0,r.useEffect)((function(){null!==n&&void 0!==n&&n.BusstopStatus?W(n):B(!1)}),[n]);var W=function(e){B(!0),(0,f.Z)({method:"get",url:"tas/transportschedule/busstop/".concat(e.Id)}).then((function(t){A((0,l.Z)((0,l.Z)({},e),{},{busStops:(0,a.Z)(t.data)})),U.setFieldValue("busstops",t.data)})).catch((function(e){})).then((function(){return B(!1)}))},V=[{type:"component",component:(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(o.Form.List,{name:"busstops",className:"col-span-12",children:function(e,t){var n=t.add,a=t.remove;return(0,g.jsxs)(g.Fragment,{children:[e.length>0?(0,g.jsx)("div",{className:"col-span-12 flex flex-col  gap-y-2 max-h-[400px] overflow-auto mb-3",children:e.map((function(e){e.key;var t=e.name,n=(0,s.Z)(e,b);return(0,g.jsxs)("div",{className:"flex gap-x-2 items-start",children:[(0,g.jsx)(o.Form.Item,(0,l.Z)((0,l.Z)({},n),{},{className:"mb-0",name:[t,"Description"],children:(0,g.jsx)(c.Z,{placeholder:"Station"})})),(0,g.jsx)(o.Form.Item,{name:[t,"ETD"],className:"mb-0 w-[130px]",rules:[{required:!0,message:"In ETD is required"},{pattern:new RegExp(/^(?:2[0-3]|[01][0-9])[0-5][0-9]$/),message:"Enter correct time"}],children:(0,g.jsx)(d.Z,{maxLength:4,placeholder:"ETD",className:"py-[6px]"})}),(0,g.jsx)("button",{type:"button",className:"bg-[#FFE2E5] text-[#F64E60] hover:bg-red-200 rounded-md px-3 py-1 disabled:bg-gray-100 transition-all",onClick:function(){return a(t)},children:(0,g.jsx)(m.Z,{})})]})}))}):null,(0,g.jsx)(o.Form.Item,{className:"col-span-12 mb-5",children:(0,g.jsx)(o.Button,{className:"w-full flex justify-center",onClick:function(){return n()},block:!0,icon:(0,g.jsx)(p.Z,{}),children:"Add new station"})})]})}})})}],q=function(e){k(!0),(0,f.Z)({method:"put",url:"tas/transportschedule/busstop",data:(0,l.Z)({id:Y.Id},e)}).then((function(e){C()})).catch((function(e){})).then((function(){return k(!1)}))};return(0,g.jsx)(o.Modal,(0,l.Z)((0,l.Z)({},w),{},{destroyOnClose:!1,children:F?(0,g.jsx)("div",{className:"h-[100px] flex justify-center items-center",children:(0,g.jsx)(x.Z,{style:{fontSize:26}})}):(0,g.jsx)(g.Fragment,{children:(null===Y||void 0===Y||null===(t=Y.busStops)||void 0===t?void 0:t.length)>0?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:(0,v.m6)(O?"hidden":"block mt-4"),children:[(0,g.jsx)(u.Z,{mode:"left",items:null===Y||void 0===Y?void 0:Y.busStops.map((function(e){return{children:(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)("div",{children:e.ETD})," ",(0,g.jsx)("div",{children:e.Description})]})}}))}),(0,g.jsx)("div",{className:"flex justify-end",children:(0,g.jsx)(o.Button,{onClick:function(){return P(!0)},children:"Edit"})})]}),(0,g.jsx)("div",{className:(0,v.m6)(O?"block":"hidden"),children:(0,g.jsx)(o.Form,{fields:V,className:"gap-x-5",form:U,editData:Y,onFinish:q,itemLayouts:y,children:(0,g.jsxs)("div",{className:"col-span-12 gap-3 flex justify-end mt-3",children:[(0,g.jsx)(o.Button,{type:"primary",onClick:function(){return U.submit()},loading:Z,icon:(0,g.jsx)(h.Z,{}),children:"Save"}),(0,g.jsx)(o.Button,{onClick:function(){P(!1),U.setFieldValue("busstops",Y.busStops)},disabled:Z,children:"Cancel"})]})})})]}):(0,g.jsx)(o.Form,{fields:V,className:"gap-x-5",form:U,editData:Y,onFinish:q,itemLayouts:y,children:(0,g.jsxs)("div",{className:"col-span-12 gap-3 flex justify-end mt-3",children:[(0,g.jsx)(o.Button,{type:"primary",onClick:function(){return U.submit()},loading:Z,icon:(0,g.jsx)(h.Z,{}),children:"Save"}),(0,g.jsx)(o.Button,{onClick:function(){return(null===w||void 0===w?void 0:w.onCancel())||!1},disabled:Z,children:"Cancel"})]})})})}))}},14364:function(e,t,n){n.r(t),n.d(t,{default:function(){return Y}});var a=n(1413),l=n(29439),i=n(47313),s=n(23495),o=n(11829),r=n(47515),c=n(82508),d=n(92350),u=n(58467),m=n(2135),p=n(2880),x=n(14261),h=n(29074),f=n(21975),v=n(93031),g=n(83313),j=n(42614),b=n(6761),y=n(81404),C=n(56573),w=n(10658),D=n.n(w),N=n(30468),Z=n(73030),k=n(38209),E=n(45987),S=n(46417),F=["rowData","onReset","onCancel"];var B=function(e){var t=e.rowData,n=e.onReset,s=e.onCancel,o=(0,E.Z)(e,F),r=(0,i.useState)(!1),c=(0,l.Z)(r,2),u=c[0],m=c[1],x=p.Form.useForm(),h=(0,l.Z)(x,1)[0],f=[{name:"RealETD",label:"Real ETD",className:"col-span-12 mb-2",rules:[{required:!0,message:"Real ETD is required"},{pattern:new RegExp(/^(?:2[0-3]|[01][0-9])[0-5][0-9]$/),message:"Enter correct time"}],inputprops:{maxLength:4,className:"w-[100px]"}},{name:"Remark",label:"Remark",className:"col-span-12 mb-2",type:"select",inputprops:{options:[{label:"Airport Operation OT",value:"Airport Operation OT"},{label:"Airport Operation UB",value:"Airport Operation UB"},{label:"Aircraft shortage",value:"Aircraft shortage"},{label:"Connection flight delay",value:"Connection flight delay"},{label:"Crew Delay",value:"Crew Delay"},{label:"Crew Shortage",value:"Crew Shortage"},{label:"DE-Icing",value:"DE-Icing"},{label:"Due to bad weather condition",value:"Due to bad weather condition"},{label:"Due to PAX delay",value:"Due to PAX delay"},{label:"Due to Traffic jam",value:"Due to Traffic jam"},{label:"Unplanned maintenance",value:"Unplanned maintenance"}]}}];return(0,S.jsx)(p.Modal,(0,a.Z)((0,a.Z)({},o),{},{destroyOnClose:!1,children:(0,S.jsx)(p.Form,{fields:f,className:"gap-x-5",form:h,editData:t,onFinish:function(e){m(!0),(0,C.Z)({method:"put",url:"tas/transportschedule/realetd",data:(0,a.Z)((0,a.Z)({},e),{},{id:t.Id})}).then((function(e){n(),s()})).catch((function(e){})).then((function(){return m(!1)}))},labelCol:{flex:"100px"},children:(0,S.jsxs)("div",{className:"col-span-12 gap-3 flex justify-end mt-3",children:[(0,S.jsx)(p.Button,{type:"primary",onClick:function(){return h.submit()},loading:u,icon:(0,S.jsx)(d.Z,{}),children:"Save"}),(0,S.jsx)(p.Button,{onClick:s,disabled:u,children:"Cancel"})]})})}))},R={labelCol:{xs:{span:24},sm:{span:10}},wrapperCol:{xs:{span:24},sm:{span:16}}},T=function(e){var t=new y.Workbook,n=t.addWorksheet("Employee List");n.columns=[{width:5},{width:30},{width:25},{width:15},{width:25},{width:40}],(0,N.d)({component:e.component,worksheet:n,keepColumnWidths:!1,topLeftCell:{row:2,column:2},customizeCell:function(e){var t=e.gridCell,n=e.excelCell;"data"===t.rowType&&("Phone"===t.column.dataField&&(n.value=parseInt(t.value,10),n.numFmt="[<=9999999]###-####;(###) ###-####"),"Website"===t.column.dataField&&(n.value={text:t.value,hyperlink:t.value},n.font={color:{argb:"FF0000FF"},underline:!0},n.alignment={horizontal:"left"})),"group"===t.rowType&&(n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"BEDFE6"}}),"totalFooter"===t.rowType&&n.value&&(n.font.italic=!0)}}).then((function(){t.xlsx.writeBuffer().then((function(e){(0,b.p)(new Blob([e],{type:"application/octet-stream"}),"Booked Employees.xlsx")}))}))};var Y=function(){var e,t,n=(0,i.useState)([]),b=(0,l.Z)(n,2),y=b[0],w=b[1],N=(0,i.useState)(null),E=(0,l.Z)(N,2),F=E[0],Y=E[1],A=(0,i.useState)(null),I=(0,l.Z)(A,2),M=I[0],O=I[1],P=(0,i.useState)(!1),L=(0,l.Z)(P,2),U=L[0],W=L[1],V=(0,i.useState)(!1),q=(0,l.Z)(V,2),z=q[0],K=q[1],H=(0,i.useState)(!1),$=(0,l.Z)(H,2),J=$[0],X=$[1],_=(0,i.useState)([]),G=(0,l.Z)(_,2),Q=(G[0],G[1]),ee=(0,i.useState)([]),te=(0,l.Z)(ee,2),ne=(te[0],te[1]),ae=(0,i.useState)([]),le=(0,l.Z)(ae,2),ie=le[0],se=le[1],oe=(0,i.useState)([]),re=(0,l.Z)(oe,2),ce=re[0],de=re[1],ue=(0,i.useState)(!1),me=(0,l.Z)(ue,2),pe=me[0],xe=me[1],he=(0,i.useState)({overBookedCount:null,confirmedCount:null,data:[]}),fe=(0,l.Z)(he,2),ve=fe[0],ge=fe[1],je=(0,i.useState)(!1),be=(0,l.Z)(je,2),ye=be[0],Ce=be[1],we=(0,i.useState)(!1),De=(0,l.Z)(we,2),Ne=De[0],Ze=De[1],ke=(0,i.useState)(!1),Ee=(0,l.Z)(ke,2),Se=Ee[0],Fe=Ee[1],Be=(0,i.useState)(!1),Re=(0,l.Z)(Be,2),Te=Re[0],Ye=Re[1],Ae=(0,i.useState)(!1),Ie=(0,l.Z)(Ae,2),Me=Ie[0],Oe=Ie[1],Pe=(0,i.useState)(D()()),Le=(0,l.Z)(Pe,2),Ue=Le[0],We=Le[1],Ve=(0,i.useRef)({checkBoxUpdating:!1,selectAllCheckBox:null}),qe=p.Form.useForm(),ze=(0,l.Z)(qe,1)[0],Ke=p.Form.useForm(),He=(0,l.Z)(Ke,1)[0],$e=(0,u.s0)(),Je=(0,u.UO)().transportId,Xe=(0,i.useContext)(j.V),_e=Xe.action,Ge=Xe.state;(0,i.useEffect)((function(){_e.changeMenuKey("/tas/activetransport"),et()}),[]),(0,i.useEffect)((function(){Qe()}),[Ue,Je]);var Qe=(0,i.useCallback)((function(){W(!0),(0,C.Z)({method:"get",url:"tas/activetransport/schedule/".concat(Je,"?year=").concat(Ue?D()(Ue).format("YYYY"):D()().format("YYYY"))}).then((function(e){var t,n,l,i,s;w(e.data.schedules),Y((0,a.Z)((0,a.Z)({},e.data),{},{StartDate:(null===(t=e.data.schedules)||void 0===t?void 0:t.length)>0?D()(null===(n=e.data.schedules)||void 0===n||null===(l=n.length[0])||void 0===l?void 0:l.EventDate).format("YYYY-MM-DD"):null,EndDate:(null===(i=e.data.schedules)||void 0===i?void 0:i.length)>0?D()(null===(s=e.data.schedules[e.data.schedules.length-1])||void 0===s?void 0:s.EventDate).format("YYYY-MM-DD"):null})),ze.setFieldsValue(e.data)})).catch((function(e){})).then((function(){return W(!1)}))}),[Je,Ue]),et=function(){C.Z.all(["tas/transportmode?Active=1","tas/location?Active=1","tas/carrier?Active=1"].map((function(e){return C.Z.get(e)}))).then(C.Z.spread((function(e,t,n){var a;Q(null===(a=e.data)||void 0===a?void 0:a.map((function(e){return{value:e.Id,label:e.Code}}))),ne(t.data.map((function(e){return{value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)}}))),se(n.data.map((function(e){return{value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)}})))}))).catch((function(){}))},tt=[{label:"Transport Date",name:"EventDate",alignment:"left",allowEditing:!1,cellRender:function(e){return(0,S.jsx)("div",{children:D()(e.data.EventDate).format("YYYY-MM-DD")})}},{label:"Code",name:"Code",allowEditing:!1},{label:"Description",name:"Description",allowEditing:!0},{label:"ETD",name:"ETD",alignment:"left",allowEditing:!1},{label:"ETA",name:"ETA",alignment:"left",allowEditing:!1},{label:"Real ETD",name:"RealETD",alignment:"left",allowEditing:!1},{label:"Remark",name:"Remark",alignment:"left",allowEditing:!1},{label:"# Seats",name:"Seats",alignment:"left",allowEditing:!1},{label:"Available Seats",name:"Bookings",alignment:"left",allowEditing:!1,cellRender:function(e){return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)("button",{type:"button",className:(0,Z.m6)("hover:underline font-bold",e.data.Seats-e.value<=0?"text-red-400":"text-green-600 "),onClick:function(){return function(e){Ce(!0),xe(!0),(0,C.Z)({method:"get",url:"tas/transport/scheduledetail?scheduleId=".concat(e.Id)}).then((function(e){var t=[],n=[];e.data.forEach((function(e){"Confirmed"===e.Status?n.push(e):"Over Booked"===e.Status&&t.push(e)})),ge({overBookedCount:t.length,confirmedCount:n.length,data:e.data})})).catch((function(e){})).then((function(){return xe(!1)}))}(e.data)},children:e.data.Seats-e.value})})}},{label:"Bus Stop",name:"BusstopStatus",alignment:"left",allowEditing:!1,cellRender:function(e){return(0,S.jsx)(x.Jg,{value:e.value,disabled:!0,iconSize:18})}},{label:"",name:"action",width:"250px",alignment:"center",allowEditing:!1,cellRender:function(e){return(0,S.jsxs)("div",{className:"flex gap-4",children:[(0,S.jsx)("button",{type:"button",className:"edit-button",onClick:function(t){return n=e.data,Ye(!0),void O(n);var n},children:"Bus Stop"}),(0,S.jsx)("button",{type:"button",className:"edit-button",onClick:function(t){return n=e.data,O(n),void Oe(!0);var n},children:"Edit ETD"}),(0,S.jsx)("button",{type:"button",className:"edit-button",onClick:function(t){return n=e.data,Ze(!0),Fe(!0),void(0,C.Z)({method:"get",url:"tas/transportschedule/".concat(n.Id)}).then((function(e){O(e.data),He.setFieldsValue(e.data)})).catch((function(e){})).then((function(){return Fe(!1)}));var n},children:"Edit"})]})}}],nt=[{label:"\u2116",name:"",cellRender:function(e,t){return(0,S.jsx)("span",{children:e.rowIndex+1})}},{label:"Fullname",name:"FullName",alignment:"left",cellRender:function(e){return(0,S.jsx)(m.Link,{to:"/tas/people/search/".concat(e.data.EmployeeId),children:(0,S.jsx)("span",{className:"text-blue-500 hover:underline",children:e.value})})}},{label:"Department",name:"Department"},{label:"Employer",name:"Employer"},{label:"Description",name:"Description",alignment:"left"},{label:"Status",name:"Status",alignment:"left",width:"110px",cellRender:function(e){return(0,S.jsx)(h.Z,{color:"Confirmed"===e.value?"success":"orange",className:"text-xs",children:e.value})}},{label:"Completion Date",name:"DateCreated",alignment:"left",cellRender:function(e){var t=e.value;return(0,S.jsx)("div",{children:D()(t).format("YYYY-MM-DD HH:mm")})}}],at=[{label:"Transport Mode",name:"TransportModeId",className:"col-span-6 mb-2",type:"select",inputprops:{options:null===(e=Ge.referData)||void 0===e?void 0:e.transportModes}},{label:"Carrier",name:"CarrierId",className:"col-span-6 mb-2",type:"select",inputprops:{options:ie}},{label:"Code",name:"TransportCode",className:"col-span-6 mb-2"},{label:"Seats",name:"Seats",className:"col-span-6 mb-2"},{type:"component",component:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(p.Form.Item,{label:"ETD (Schedule)",name:"ETD",className:"col-span-6 mb-3",rules:[{pattern:new RegExp(/^(?:2[0-3]|[01][0-9])[0-5][0-9]$/),message:"Enter correct time"}],children:(0,S.jsx)(f.Z,{maxLength:4})})})},{type:"component",component:(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(p.Form.Item,{label:"ETA (Schedule)",name:"ETA",className:"col-span-6 mb-3",rules:[{pattern:new RegExp(/^(?:2[0-3]|[01][0-9])[0-5][0-9]$/),message:"Enter correct time"}],children:(0,S.jsx)(f.Z,{maxLength:4})})})}],lt=(0,i.useCallback)((function(e){var t,n,a,l,i=e.component;"dataRow"===e.parentType&&(null!==(t=e.row)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.EventDate&&"RealETD"===e.dataField&&(e.editorOptions.readOnly=D()().diff(D()(null===(a=e.row)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.EventDate))<0));"selection"===e.type&&("dataRow"===e.parentType&&e.row&&(it(e.row.data)||(e.editorOptions.disabled=!0)),"headerRow"===e.parentType&&(e.editorOptions.onInitialized=function(e){e.component&&(Ve.current.selectAllCheckBox=e.component)},e.editorOptions.value=st(i),e.editorOptions.onValueChanged=function(e){e.event?st(i)!==e.value&&(e.value?i.selectAll():i.deselectAll(),e.event.preventDefault()):e.previousValue&&Ve.current.checkBoxUpdating&&e.component.option("value",e.previousValue)}))}),[]),it=(0,i.useCallback)((function(e){return 0===(null===e||void 0===e?void 0:e.Bookings)}),[]);function st(e){var t=[];e.getDataSource().store().load().then((function(e){t=e}));var n=t.filter(it),a=e.option("selectedRowKeys");return!(!a||!a.length)&&(a.length>=n.length||void 0)}var ot=(0,i.useCallback)((function(e){var t,n,a=[];e.selectedRowsData.map((function(t){it(t)||a.push(e.component.keyOf(t))})),a.length&&e.component.deselectRows(a),Ve.current.checkBoxUpdating=!0;var l,i,s=Ve.current.selectAllCheckBox;(null===s||void 0===s||s.option("value",st(e.component)),Ve.current.checkBoxUpdating=!1,JSON.stringify(ce)!==JSON.stringify(null===(t=Ve.current)||void 0===t||null===(n=t.instance)||void 0===n?void 0:n.getSelectedRowKeys()))&&de(null===(l=Ve.current)||void 0===l||null===(i=l.instance)||void 0===i?void 0:i.getSelectedRowKeys())}),[]),rt=(0,i.useCallback)((function(){Ve.current.instance.clearSelection(),de([])}),[Ve]),ct=(0,i.useCallback)((function(e){var t,n=e.changes[0];null!==(t=n.data)&&void 0!==t&&t.Description&&(0,C.Z)({method:"put",url:"tas/transportschedule/description",data:{id:n.key,description:n.data.Description}}).then((function(e){Qe()})).catch((function(e){}))}),[]),dt=(0,i.useCallback)((function(){Qe(),O(null),Ye(!1)}),[]),ut=((0,i.useCallback)((function(e){var t,n,a;return!(null!==(t=e.row.data)&&void 0!==t&&t.EventDate&&D()().diff(D()(null===(n=e.row)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.EventDate))<0)}),[]),(0,i.useCallback)((function(e){We(e)}),[]));return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,S.jsx)("div",{className:"text-lg font-bold mb-2",children:"Active Transport Types"}),(0,S.jsxs)("div",{className:"flex gap-10",children:[(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-28 text-[12px] text-secondary",children:"Mode:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.TransportModeName})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-28 text-[12px] text-secondary",children:"Transport Code:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.Code})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-28 text-[12px] text-secondary",children:"Direction:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.Direction})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-28 text-[12px] text-secondary",children:"Port Of Departure:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.fromLocationName})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-28 text-[12px] text-secondary",children:"Port Of Arrive:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.toLocationName})]})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-16 text-[12px] text-secondary",children:"Carrier:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.CarrierName})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-16 text-[12px] text-secondary",children:"Seats:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.Seats})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-16 text-[12px] text-secondary",children:"Direction:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.Direction})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-16 text-[12px] text-secondary",children:"ETD:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.ETD})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-16 text-[12px] text-secondary",children:"ETA:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.ETA})]})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-[100px] text-[12px] text-secondary",children:"Start Date:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.StartDate})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-[100px] text-[12px] text-secondary",children:"End Date:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.EndDate})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-[100px] text-[12px] text-secondary",children:"Week days:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.DayNum})]}),(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("div",{className:"flex-initial w-[100px] text-[12px] text-secondary",children:"Frequency Weeks:"}),(0,S.jsx)("div",{children:null===F||void 0===F?void 0:F.FrequencyWeeks})]})]})]}),(0,S.jsx)("div",{className:"flex gap-4 justify-end",children:(0,S.jsx)(p.Button,{onClick:function(){return $e(-1)},icon:(0,S.jsx)(s.Z,{}),children:"Back"})})]}),(0,S.jsx)(p.Table,{ref:Ve,data:y,columns:tt,allowColumnReordering:!1,loading:U,selection:{mode:"multiple",recursive:!1,showCheckBoxesMode:"always",allowSelectAll:!0,selectAllMode:"page",selectRows:function(e){return!it(e)}},isFilterRow:!0,style:{maxHeight:"calc(100vh - 400px)"},onSelectionChanged:ot,onEditorPreparing:lt,editing:{mode:"cell",allowUpdating:!0},onSaving:ct,keyExpr:"Id",title:null!==(t=Ge.userInfo)&&void 0!==t&&t.ReadonlyAccess?"":(0,S.jsxs)("div",{className:"flex justify-between items-center py-2 gap-3 border-b border-gray-300",children:[(0,S.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,S.jsx)("label",{className:"text-sm font-medium text-secondary2",children:"Year:"}),(0,S.jsx)(v.Z.YearPicker,{placeholder:"Year",value:Ue,allowClear:!1,onChange:ut,style:{width:100}})]}),(0,S.jsxs)("div",{className:"flex items-center gap-3",children:[(0,S.jsxs)("div",{className:"mr-2",children:[(0,S.jsx)("span",{className:"font-bold",children:ce.length})," people selected ",50===ce.length&&(0,S.jsx)("span",{className:"text-red-400",children:"(full)"})]}),(0,S.jsx)(p.Button,{icon:(0,S.jsx)(o.Z,{}),onClick:rt,disabled:0===ce.length,children:"Clear Selection"}),(0,S.jsx)(p.Button,{icon:(0,S.jsx)(r.Z,{}),onClick:function(){return K(!0)},disabled:0===ce.length,type:"danger",children:"Delete Schedules"})]})]})}),(0,S.jsxs)(x.GI,{visible:z,showTitle:!1,height:120,width:350,children:[(0,S.jsx)("div",{children:"Are you sure you want to deactivate this records?"}),(0,S.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,S.jsx)(p.Button,{type:"danger",onClick:function(){(0,C.Z)({method:"delete",url:"tas/transport/schedule",data:{scheduleIds:ce}}).then((function(e){K(!1),Qe(),Ve.current.instance.clearSelection(),de([])})).catch((function(e){}))},children:"Yes"}),(0,S.jsx)(p.Button,{onClick:function(){return K(!1)},children:"No"})]})]}),(0,S.jsx)(p.Modal,{open:Ne,onCancel:function(){return Ze(!1)},title:"Edit Schedule (".concat(D()(null===M||void 0===M?void 0:M.EventDate).format("YYYY-MM-DD"),")"),width:800,children:Se?(0,S.jsx)("div",{className:"h-[100px] flex justify-center items-center",children:(0,S.jsx)(c.Z,{style:{fontSize:26}})}):(0,S.jsx)(p.Form,{fields:at.filter((function(e){return!e.hide})),className:"pt-2 gap-x-8",form:He,editData:M,onFinish:function(e){X(!0),(0,C.Z)({method:"put",url:"tas/transportschedule",data:(0,a.Z)({id:M.Id},e)}).then((function(e){Qe(),O(null),Ze(!1)})).catch((function(e){})).then((function(){return X(!1)}))},itemLayouts:R,labelCol:{flex:"100px"},children:(0,S.jsxs)("div",{className:"col-span-12 gap-3 flex justify-end mt-3",children:[(0,S.jsx)(p.Button,{type:"primary",onClick:function(){return He.submit()},loading:J,icon:(0,S.jsx)(d.Z,{}),children:"Save"}),(0,S.jsx)(p.Button,{onClick:function(){return Ze(!1)},disabled:J,children:"Cancel"})]})})}),(0,S.jsx)(k.Z,{open:Te,onCancel:function(){return Ye(!1)},title:"Set Bus Stop (".concat(D()(null===M||void 0===M?void 0:M.EventDate).format("YYYY-MM-DD"),")"),width:800,rowData:M,onReset:dt}),(0,S.jsx)(B,{open:Me,onCancel:function(){return Oe(!1)},title:"Edit Real ETD (".concat(D()(null===M||void 0===M?void 0:M.EventDate).format("YYYY-MM-DD"),")"),width:600,rowData:M,onReset:Qe}),(0,S.jsx)(g.Z,{open:ye,onClose:function(){return Ce(!1)},footer:!1,title:"Booking detail",width:800,bodyStyle:{padding:5},children:(0,S.jsx)(p.Table,{data:null===ve||void 0===ve?void 0:ve.data,columns:nt,keyExpr:"Id",containerClass:"shadow-none",loading:pe,columnAutoWidth:!0,export:{enabled:!0},onExporting:T,style:{maxHeight:"calc(100vh - 80px)"},toolbar:[{location:"before",render:function(e){return(0,S.jsxs)("div",{className:"flex gap-5",children:[(0,S.jsxs)("span",{className:"font-medium",children:["Confirmed: ",(0,S.jsx)("span",{className:"text-green-500 font-bold",children:null===ve||void 0===ve?void 0:ve.confirmedCount})]}),(0,S.jsxs)("span",{className:"font-medium",children:["Over Booked: ",(0,S.jsx)("span",{className:"text-orange-500 font-bold",children:null===ve||void 0===ve?void 0:ve.overBookedCount})]})]})}}]})})]})}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[6373],{56373:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var a=n(45987),l=n(1413),r=n(29439),s=n(47313),o=n(2880),i=n(56573),d=n(65040),c=n(52957),u=n(74294),m=n(93031),p=n(58467),h=n(10658),x=n.n(h),v=n(14261),f=n(58821),b=n(18711),j=n(2135),C=n(46417),N=[{label:"Person #",name:"Id",dataType:"string"},{label:"SAP ID #",name:"SAPID",alignment:"left"},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,C.jsx)(b.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname",dataType:"string"},{label:"Lastname",name:"Lastname",dataType:"string"},{label:"Department",name:"DepartmentName",dataType:"string"},{label:"Employer",name:"EmployerName",dataType:"string"},{label:"Roster",name:"RosterName",dataType:"string",enableFilter:!0},{label:"Resource Type",name:"PeopleTypeName",dataType:"string"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,C.jsx)("span",{children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"60px",cellRender:function(e){return(0,C.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,C.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"35px",cellRender:function(e){return(0,C.jsx)(v.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,C.jsx)(f.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"35px",cellRender:function(e,t){return(0,C.jsx)(v.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,C.jsx)("i",{className:"dx-icon-home"})}},{label:"",name:"",width:"65px",alignment:"center",cellRender:function(e){return(0,C.jsx)("div",{className:"flex items-center",children:(0,C.jsx)(j.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,C.jsx)("button",{type:"button",className:"edit-button",children:"View"})})})}}],g=n(42614),w=["key","name"];var y=function(){var e=(0,p.TH)(),t=(0,s.useState)(!1),n=(0,r.Z)(t,2),h=n[0],v=n[1],f=(0,s.useState)([]),b=(0,r.Z)(f,2),j=b[0],y=b[1],Z=(0,s.useState)([]),D=(0,r.Z)(Z,2),I=D[0],R=D[1],S=(0,s.useState)(!1),F=(0,r.Z)(S,2),L=F[0],M=F[1],T=d.Z.useForm(),E=(0,r.Z)(T,1)[0],k=d.Z.useForm(),V=(0,r.Z)(k,1)[0],P=d.Z.useWatch("rosters",V),W=(0,s.useRef)(null),A=(0,s.useContext)(g.V).state;(0,s.useEffect)((function(){e.state&&E.setFieldValue(e.state.name,e.state.value)}),[]),(0,s.useEffect)((function(){V.setFieldsValue({rosters:j})}),[j]);var O=function(e,t){var n,a;null===(n=V.getFieldsValue())||void 0===n||null===(a=n.rosters)||void 0===a||a.map((function(n,a){V.setFieldValue(["rosters",a,t],e)}))},Y=function(){M(!1),y(V.getFieldValue("rosters"))};return(0,C.jsxs)("div",{children:[(0,C.jsx)(o.PeolpeSelectionTable,{ref:W,onSelect:function(e){R(e)},onReturn:function(){var e=I.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{Fullname:"".concat(e.Firstname," ").concat(e.Lastname)})}));y(e),M(!0)},selectedRowsData:I,columns:N,searchDefaultValues:{Active:0},hideFields:["Active"]}),(0,C.jsxs)(o.Modal,{open:L,onCancel:Y,title:(0,C.jsxs)("div",{children:["Reactivate ",(0,C.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",null===P||void 0===P?void 0:P.length," people selected)"]})]}),width:1100,children:[(0,C.jsx)(d.Z,{form:V,size:"small",onFinish:function(e){v(!0),(0,i.Z)({method:"post",url:"tas/employee/reactive",data:{employees:e.rosters.map((function(e){return{employeeId:e.Id,eventDate:e.eventDate?x()(e.eventDate).format("YYYY-MM-DD"):"",comment:e.comment,terminationTypeId:e.terminationTypeId,CostCodeId:e.CostCodeId,DepartmentId:e.DepartmentId,EmployerId:e.EmployerId}}))}}).then((function(e){var t;M(!1),y([]),null===(t=W.current)||void 0===t||t.instance.clearSelection(),E.submit()})).catch((function(e){})).then((function(){return v(!1)}))},children:(0,C.jsx)(d.Z.List,{name:"rosters",children:function(e,t){var n,r,s,o=t.remove;return(0,C.jsx)("div",{className:"border rounded-ot",children:(0,C.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,C.jsx)("thead",{className:"text-[#959595]",children:(0,C.jsxs)("tr",{className:"text-left",children:[(0,C.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,C.jsx)(c.Z,{style:{width:200},treeData:null===(n=A.referData)||void 0===n?void 0:n.departments,virtual:!0,treeLine:!0,showSearch:!0,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},filterTreeNode:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.Name)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},placeholder:"Department",onChange:function(e){return O(e,"DepartmentId")},popupMatchSelectWidth:!1}):"Replacement Department"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,C.jsx)(u.Z,{className:"w-[150px]",options:null===(r=A.referData)||void 0===r?void 0:r.employers,placeholder:"EmployerId",onChange:function(e){return O(e,"EmployerId")},allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}}):"Replacement Employer"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,C.jsx)(u.Z,{className:"w-full",options:null===(s=A.referData)||void 0===s?void 0:s.costCodes,placeholder:"Cost Code",onChange:function(e){return O(e,"CostCodeId")},allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}}):"Replacement Cost Code"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,C.jsx)(m.Z,{placeholder:"Change Event Dates",className:"w-[120px]",onChange:function(e){return O(e,"eventDate")}}):"Event Date"}),(0,C.jsx)("th",{className:"border-b px-1 font-normal text-right"})]})}),(0,C.jsx)("tbody",{children:e.map((function(e){var t,n,r,s=e.key,i=e.name,p=(0,a.Z)(e,w);return(0,C.jsxs)("tr",{className:"".concat((i+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,(0,l.Z)((0,l.Z)({},p),{},{name:[i,"Id"],className:"mb-0",children:(0,C.jsx)("div",{className:"text-[13px] w-[30px]",children:i+1})}))}),(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,(0,l.Z)((0,l.Z)({},p),{},{name:[i,"Id"],className:"mb-0",children:(0,C.jsx)("div",{className:"text-[13px]",children:V.getFieldValue(["rosters",i,"Id"])})}))}),(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,(0,l.Z)((0,l.Z)({},p),{},{className:"mb-0",children:(0,C.jsx)("div",{className:"text-[13px]",children:V.getFieldValue(["rosters",i,"Fullname"])})}))}),(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,(0,l.Z)((0,l.Z)({},p),{},{name:[i,"DepartmentId"],className:"mb-0",rules:[{required:!0,message:"Missing department"}],children:(0,C.jsx)(c.Z,{style:{width:200},treeData:null===(t=A.referData)||void 0===t?void 0:t.departments,virtual:!0,treeLine:!0,popupMatchSelectWidth:!1,showSearch:!0,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},filterTreeNode:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.Name)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},placeholder:"Department"})}))}),(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,(0,l.Z)((0,l.Z)({},p),{},{name:[i,"EmployerId"],className:"mb-0 w-[150px]",rules:[{required:!0,message:"Missing employer"}],children:(0,C.jsx)(u.Z,{options:null===(n=A.referData)||void 0===n?void 0:n.employers,placeholder:"Employer",allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})}))}),(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,(0,l.Z)((0,l.Z)({},p),{},{name:[i,"CostCodeId"],className:"mb-0 w-[200px]",rules:[{required:!0,message:"Missing cost code"}],children:(0,C.jsx)(u.Z,{options:null===(r=A.referData)||void 0===r?void 0:r.costCodes,placeholder:"Cost Code",allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})}))}),(0,C.jsx)("td",{className:"py-1 border-t px-1",children:(0,C.jsx)(d.Z.Item,{name:[i,"eventDate"],className:"mb-0",children:(0,C.jsx)(m.Z,{className:"w-[120px]"})},"eventDate-".concat(s))}),(0,C.jsx)("td",{className:"py-1 border-t px-1 text-right",children:(0,C.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){!function(e){var t;null===(t=W.current)||void 0===t||t.instance.deselectRows([e])}(V.getFieldValue(["rosters",i,"Id"])),o(i)},children:"Remove"})})]})}))})]})})}})}),j.length>0&&(0,C.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,C.jsx)(o.Button,{type:"primary",onClick:function(){return V.submit()},loading:h,children:"Process"}),(0,C.jsx)(o.Button,{onClick:Y,disabled:h,children:"Cancel"})]})]})]})}}}]);
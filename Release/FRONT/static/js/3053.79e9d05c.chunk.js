(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[3053],{98902:function(e,t,a){"use strict";var l=a(29439),r=a(47313),n=a(52341),s=a(2880),o=a(46417);t.Z=function(e){var t=e.data,a=e.onCancel,i=e.onSave,d=e.values,c=(0,r.useState)([]),u=(0,l.Z)(c,2),m=u[0],p=u[1],h=(0,r.useState)(d),f=(0,l.Z)(h,2),b=f[0],x=f[1];(0,r.useEffect)((function(){t&&p(t)}),[t]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.Z,{dataSource:m,titles:["Columns","Selected Columns"],targetKeys:b,onChange:function(e,t,a){x(e)},showSearch:!0,filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.title)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},render:function(e){return e.title},oneWay:!0,listStyle:{width:400,height:400},style:{marginBottom:16}}),(0,o.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,o.jsx)(s.Button,{type:"primary",onClick:function(){i&&i(b)},children:"OK"}),(0,o.jsx)(s.Button,{onClick:function(){a&&a()},children:"Cancel"})]})]})}},33053:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ie}});var l=a(1413),r=a(29439),n=a(2880),s=a(14261),o=a(47313),i=a(65040),d=a(12998),c=a(29074),u=a(84523),m=a(12019),p=a(87462),h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},f=a(17469),b=function(e,t){return o.createElement(f.Z,(0,p.Z)({},e,{ref:t,icon:h}))};var x=o.forwardRef(b),v=a(47515),j=a(82508),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 01-12.7-6.5V353.7a8 8 0 0112.7-6.5L656.1 506a7.9 7.9 0 010 12.9z"}}]},name:"play-circle",theme:"filled"},y=function(e,t){return o.createElement(f.Z,(0,p.Z)({},e,{ref:t,icon:D}))};var g=o.forwardRef(y),N={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},S=function(e,t){return o.createElement(f.Z,(0,p.Z)({},e,{ref:t,icon:N}))};var Y=o.forwardRef(S),M=a(37289),I=a(40765),C=a(82138),T=a(92350),Z=a(70380),k=a(42614),E=a(74294),w=a(21975),F=a(98466),H=a(14576),R=a(93031),A=a(76298),q=a(22891),P=a(98902),V=a(46417);var J=function(e){var t,a=e.templates,s=e.form,i=e.onChangeParameters,d=(e.departments,(0,o.useState)(!1)),c=(0,r.Z)(d,2),u=(c[0],c[1]),m=(0,o.useState)(!1),p=(0,r.Z)(m,2),h=p[0],f=p[1],b=(0,o.useState)(null),x=(0,r.Z)(b,2),v=x[0],j=x[1],D=n.Form.useWatch([],s);(0,o.useEffect)((function(){null!==D&&void 0!==D&&D.reportTemplateId&&y(null===D||void 0===D?void 0:D.reportTemplateId)}),[D]);var y=function(e){u(!0),(0,q.k)({method:"get",url:"tasreport/reporttemplate/".concat(e)}).then((function(e){var t=[],a={};e.data.Columns.map((function(e,a){t.push((0,l.Z)((0,l.Z)({},e),{},{key:"".concat(e.Id),title:e.Caption,label:e.Caption,value:"".concat(e.Id)}))})),e.data.Parameters.map((function(e,t){a["".concat(e.FielName)]=e})),i&&i(a),j((0,l.Z)((0,l.Z)({},e.data),{},{Columns:t}))})).catch((function(e){})).then((function(){return u(!1)}))};return(0,V.jsxs)("div",{className:"col-span-12 flex flex-col gap-6",children:[(0,V.jsxs)("div",{className:"border rounded-ot py-4 px-6 pb-2",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Report"}),(0,V.jsx)(n.Form.Item,{className:"col-span-6 mb-2",name:"reportTemplateId",label:"Report Template",rules:[{required:!0,message:"Report Template is required"}],children:(0,V.jsx)(E.Z,{options:a,placeholder:"Select template",filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0,allowClear:!0})})]}),(0,V.jsxs)("div",{className:"border rounded-ot px-6 py-4",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Job"}),(0,V.jsx)(n.Form.Item,{className:"col-span-6 mb-2",name:"Name",label:"Job name",rules:[{required:!0,message:"Job name is required"}],children:(0,V.jsx)(w.Z,{})}),(0,V.jsx)(n.Form.Item,{className:"col-span-6 mb-2",name:"Description",label:"Job description",children:(0,V.jsx)(w.Z.TextArea,{})})]}),(0,V.jsxs)("div",{className:"border rounded-ot px-4 py-4",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Actions"}),(0,V.jsxs)("table",{className:"w-full table table-fixed border-collapse border rounded-t-md border-slate-300 text-xs",children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{className:"text-left text-gray-400",children:[(0,V.jsx)("th",{className:"border border-slate-300 px-2 font-medium w-[140px]",children:"Name"}),(0,V.jsx)("th",{className:"border border-slate-300 px-2 font-medium w-auto",children:"Description"}),(0,V.jsx)("th",{className:"border border-slate-300 px-2 font-medium w-auto",children:"Value"})]})}),(0,V.jsxs)("tbody",{children:[(0,V.jsxs)("tr",{children:[(0,V.jsxs)("td",{className:"border border-slate-300 px-2",children:["to Emails",(0,V.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:"Override the default to email address for the report with the supplied email address"}),(0,V.jsx)("td",{className:"border border-slate-300 px-2 flex gap-2",children:(0,V.jsx)(n.Form.Item,{name:"subscriptionMails",className:"my-1 flex-1",rules:[{required:!0,message:"Emails is required"}],children:(0,V.jsx)(E.Z,{mode:"tags",style:{width:"100%"},placeholder:"Write email"})})})]}),(null===v||void 0===v||null===(t=v.Columns)||void 0===t?void 0:t.length)>0?(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:"Columns"}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:"Include these additional fields in the report"}),(0,V.jsxs)("td",{className:"border border-slate-300 px-2 flex gap-2",children:[(0,V.jsx)(n.Form.Item,{name:"columnIds",className:"my-1 flex-1",children:(0,V.jsx)(E.Z,{options:null===v||void 0===v?void 0:v.Columns,mode:"multiple",disabled:!0})}),(0,V.jsx)(n.Form.Item,{className:"my-1",children:(0,V.jsx)(n.Button,{onClick:function(){return f(!0)},children:"..."})})]})]}):null,(0,V.jsx)(n.Form.Item,{noStyle:!0,name:"parameters",children:null===v||void 0===v?void 0:v.Parameters.map((function(e){return(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:e.Caption}),(0,V.jsxs)("td",{className:"border border-slate-300 px-2",children:[e.Descr," ",e.Component]}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:(0,n.ReportFields)(e,"parameters",s,v)})]})}))})]})]})]}),(0,V.jsxs)("div",{className:"border rounded-ot px-6 py-4",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Schedule"}),(0,V.jsx)(n.Form.Item,{name:"scheduleType",className:"flex justify-center",children:(0,V.jsx)(F.Z,{options:["Daily","Weekly","Monthly","RunTime"]})}),(0,V.jsx)(n.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.scheduleType!==t.scheduleType},children:function(e){var t=e.getFieldValue;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Form.Item,{label:"Starting on",className:"mb-2",children:(0,V.jsxs)(H.Z,{align:"center",children:[(0,V.jsx)(n.Form.Item,{label:"Starting on",name:"StartDate",className:"mb-2 w-full",rules:[{required:!0,message:"Start date is required"}],children:(0,V.jsx)(n.AvailableDatePicker,{})}),(0,V.jsx)(n.AvailableTimeTooltip,{})]})}),"RunTime"!==t("scheduleType")&&(0,V.jsx)(n.Form.Item,{label:"Ends on",name:"EndDate",className:"mb-2",rules:[{required:!0,message:"End date is required"}],children:(0,V.jsx)(R.Z,{format:"YYYY-MM-DD"})}),"Daily"===t("scheduleType")?(0,V.jsx)(n.Form.Item,{label:"Recure every day(s)",name:"recureEvery",className:"mb-2",rules:[{required:!0,message:"Recure Day is required"}],children:(0,V.jsx)(A.Z,{min:1,controls:!1})}):"Weekly"===t("scheduleType")?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Form.Item,{label:"Recure every day(s)",name:"recureEvery",className:"mb-2",rules:[{required:!0,message:"Recure Day is required"}],children:(0,V.jsx)(A.Z,{min:1,controls:!1})}),(0,V.jsx)(n.Form.Item,{name:"week",label:"Selected day(s)",className:"mb-2",rules:[{required:!0,message:"Week day is required"}],children:(0,V.jsx)(E.Z,{options:[{label:"Monday",value:"MON"},{label:"Tuesday",value:"TUE"},{label:"Wednesday",value:"WED"},{label:"Thursday",value:"THU"},{label:"Friday",value:"FRI"},{label:"Saturday",value:"SAT"},{label:"Sunday",value:"SUN"}],mode:"multiple"})})]}):"Monthly"===t("scheduleType")?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Form.Item,{name:"months",label:"Selected month(s)",className:"mb-2",rules:[{required:!0,message:"Month is required"}],children:(0,V.jsx)(E.Z,{options:[{label:"January",value:"JAN"},{label:"February",value:"FEB"},{label:"March",value:"MAR"},{label:"April",value:"APR"},{label:"May",value:"MAY"},{label:"June",value:"JUN"},{label:"July",value:"JUL"},{label:"August",value:"AUG"},{label:"September",value:"SEP"},{label:"October",value:"OCT"},{label:"November",value:"NOV"},{label:"December",value:"DEC"}],mode:"multiple"})}),(0,V.jsx)(n.Form.Item,{name:"days",label:"On date(s)",className:"mb-2",rules:[{required:!0,message:"Date is required"}],children:(0,V.jsx)(E.Z,{options:[{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10",value:"10"},{label:"11",value:"11"},{label:"12",value:"12"},{label:"13",value:"13"},{label:"14",value:"14"},{label:"15",value:"15"},{label:"16",value:"16"},{label:"17",value:"17"},{label:"18",value:"18"},{label:"19",value:"19"},{label:"20",value:"20"},{label:"21",value:"21"},{label:"22",value:"22"},{label:"23",value:"23"},{label:"24",value:"24"},{label:"25",value:"25"},{label:"26",value:"26"},{label:"27",value:"27"},{label:"28",value:"28"},{label:"29",value:"29"},{label:"30",value:"30"}],mode:"multiple"})})]}):""]})}})]}),(0,V.jsx)(n.Modal,{width:700,title:"Column Selection",open:h,onCancel:function(){return f(!1)},children:(0,V.jsx)(P.Z,{data:null===v||void 0===v?void 0:v.Columns,onCancel:function(){return f(!1)},onSave:function(e){s.setFieldValue("columnIds",e),f(!1)},values:s.getFieldValue("columnIds")})})]})},O=a(10658),B=a.n(O),W=a(61100),z=a.n(W),L=a(59694),U=a.n(L);var _=function(e){var t,a=e.templates,s=e.form,i=e.onChangeParameters,d=e.editData,c=(e.departments,(0,o.useState)(!1)),u=(0,r.Z)(c,2),m=(u[0],u[1]),p=(0,o.useState)(!1),h=(0,r.Z)(p,2),f=h[0],b=h[1],x=(0,o.useState)(null),v=(0,r.Z)(x,2),D=v[0],y=v[1],g=(0,o.useState)(null),N=(0,r.Z)(g,2),S=N[0],Y=N[1],M=n.Form.useWatch([],s);(0,o.useEffect)((function(){d&&I()}),[d]),(0,o.useEffect)((function(){!d&&null!==M&&void 0!==M&&M.reportTemplateId&&C(null===M||void 0===M?void 0:M.reportTemplateId)}),[M]);var I=function(){(0,q.k)({method:"get",url:"reportjob/".concat(d.Id)}).then((function(e){var t,a,r,n,o,i,d;Y(e.data),C(null===(t=e.data)||void 0===t?void 0:t.reportTemplateId);var c=function(e){var t={};return null===e||void 0===e||e.map((function(e){e.Component.includes("DROPDOWN")?t[e.FieldName]=e.ParameterValue?JSON.parse(e.ParameterValue):[]:"TAS_DYNAMIC_DATE"===e.Component&&e.ParameterValue?e.ParameterValue.startsWith("{")&&e.ParameterValue.endsWith("}")?t[e.FieldName]={Days:e.Days,FieldValue:e.ParameterValue}:t[e.FieldName]={Days:null,FieldValue:null,Date:B()(e.ParameterValue)}:"TAS_STATIC_DATE"===e.Component?t[e.FieldName]=B()(JSON.parse(e.ParameterValue)):t[e.FieldName]=JSON.parse(e.ParameterValue)})),t}(null===(a=e.data)||void 0===a?void 0:a.Parameters),u=JSON.parse(e.data.Command);s.setFieldsValue((0,l.Z)((0,l.Z)({},e.data),{},{StartDate:e.data.StartDate?B()(e.data.StartDate):null,EndDate:e.data.EndDate?B()(e.data.EndDate):null,scheduleType:null===(r=e.data)||void 0===r?void 0:r.ScheduleType,months:null===(n=JSON.parse(e.data.Command))||void 0===n?void 0:n.months,days:null===(o=JSON.parse(e.data.Command))||void 0===o?void 0:o.days,week:null===(i=JSON.parse(e.data.Command))||void 0===i?void 0:i.days,recureEvery:null===u||void 0===u?void 0:u.recureEvery,columnIds:null===(d=e.data.Columns)||void 0===d?void 0:d.map((function(e){return JSON.stringify(e.ColumnId)})),parameters:c}))})).catch((function(e){}))},C=function(e){m(!0),(0,q.k)({method:"get",url:"tasreport/reporttemplate/".concat(e)}).then((function(e){var t=[],a={};e.data.Columns.map((function(e,a){t.push((0,l.Z)((0,l.Z)({},e),{},{key:"".concat(e.Id),title:e.Caption,label:e.Caption,value:"".concat(e.Id)}))})),e.data.Parameters.map((function(e,t){a["".concat(e.FielName)]=e})),i&&i(a),y((0,l.Z)((0,l.Z)({},e.data),{},{Columns:t}))})).catch((function(e){})).then((function(){return m(!1)}))};return(0,V.jsx)(V.Fragment,{children:S?(0,V.jsxs)("div",{className:"col-span-12 flex flex-col gap-6",children:[(0,V.jsxs)("div",{className:"border rounded-ot py-4 px-6 pb-2",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Report"}),(0,V.jsx)(n.Form.Item,{className:"col-span-6 mb-2",name:"reportTemplateId",label:"Report Template",rules:[{required:!0,message:"Report Template is required"}],children:(0,V.jsx)(E.Z,{options:a,placeholder:"Select template",disabled:!0,filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0})})]}),(0,V.jsxs)("div",{className:"border rounded-ot px-6 py-4",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Job"}),(0,V.jsx)(n.Form.Item,{className:"col-span-6 mb-2",name:"Name",label:"Job name",rules:[{required:!0,message:"Job name is required"}],children:(0,V.jsx)(w.Z,{})}),(0,V.jsx)(n.Form.Item,{className:"col-span-6 mb-2",name:"Description",label:"Job description",children:(0,V.jsx)(w.Z.TextArea,{})})]}),(0,V.jsxs)("div",{className:"border rounded-ot px-4 py-4",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Actions"}),(0,V.jsxs)("table",{className:"w-full table table-fixed border-collapse border rounded-t-md border-slate-300 text-xs",children:[(0,V.jsx)("thead",{children:(0,V.jsxs)("tr",{className:"text-left text-gray-400",children:[(0,V.jsx)("th",{className:"border border-slate-300 px-2 font-medium w-[140px]",children:"Name"}),(0,V.jsx)("th",{className:"border border-slate-300 px-2 font-medium w-auto",children:"Description"}),(0,V.jsx)("th",{className:"border border-slate-300 px-2 font-medium w-auto",children:"Value"})]})}),(0,V.jsxs)("tbody",{children:[(0,V.jsxs)("tr",{children:[(0,V.jsxs)("td",{className:"border border-slate-300 px-2",children:["to Emails",(0,V.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:"Override the default to email address for the report with the supplied email address"}),(0,V.jsx)("td",{className:"border border-slate-300 px-2 flex gap-2",children:(0,V.jsx)(n.Form.Item,{name:"subscriptionMails",className:"my-1 flex-1",rules:[{required:!0,message:"Emails is required"}],children:(0,V.jsx)(E.Z,{mode:"tags",style:{width:"100%"},placeholder:"Write email"})})})]}),(null===D||void 0===D||null===(t=D.Columns)||void 0===t?void 0:t.length)>0?(0,V.jsxs)("tr",{children:[(0,V.jsxs)("td",{className:"border border-slate-300 px-2",children:["Columns",(0,V.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:"Include these additional fields in the report"}),(0,V.jsxs)("td",{className:"border border-slate-300 px-2 flex gap-2",children:[(0,V.jsx)(n.Form.Item,{name:"columnIds",className:"my-1 flex-1",children:(0,V.jsx)(E.Z,{options:null===D||void 0===D?void 0:D.Columns,mode:"multiple",disabled:!0})}),(0,V.jsx)(n.Form.Item,{className:"my-1",children:(0,V.jsx)(n.Button,{onClick:function(){return b(!0)},children:"..."})})]})]}):null,(0,V.jsx)(n.Form.Item,{noStyle:!0,name:"parameters",children:null===D||void 0===D?void 0:D.Parameters.map((function(e){return"TAS_DYNAMIC_DATE"===e.Component?(0,V.jsxs)("tr",{className:"bg-[#e4f2fd]",children:[(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:e.Caption}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:e.Descr?e.Descr:e.Component}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:(0,n.ReportFields)(e,"parameters",s,D)})]}):(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:e.Caption}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:e.Descr}),(0,V.jsx)("td",{className:"border border-slate-300 px-2",children:(0,n.ReportFields)(e,"parameters",s,D)})]})}))})]})]})]}),(0,V.jsxs)("div",{className:"border rounded-ot px-6 py-4",children:[(0,V.jsx)("div",{className:"text-xl mb-3",children:"Schedule"}),(0,V.jsx)(n.Form.Item,{name:"scheduleType",className:"flex justify-center",children:(0,V.jsx)(F.Z,{options:["Daily","Weekly","Monthly","RunTime"]})}),(0,V.jsx)(n.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.scheduleType!==t.scheduleType},children:function(e){var t=(0,e.getFieldValue)("scheduleType");return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Form.Item,{label:"Starting on",className:"mb-2",children:(0,V.jsxs)(H.Z,{align:"center",children:[(0,V.jsx)(n.Form.Item,{name:"StartDate",className:"mb-0 inline-block",rules:[{required:!0,message:"Start date is required"}],children:(0,V.jsx)(n.AvailableDatePicker,{})}),(0,V.jsx)(n.AvailableTimeTooltip,{})]})}),"RunTime"!==t?(0,V.jsx)(n.Form.Item,{label:"Ends on",name:"EndDate",className:"mb-2",rules:[{required:!0,message:"End date is required"}],children:(0,V.jsx)(R.Z,{format:"YYYY-MM-DD"})}):null,"Daily"===t?(0,V.jsx)(n.Form.Item,{label:"Recure every day(s)",name:"recureEvery",className:"mb-2",rules:[{required:!0,message:"Recure Day is required"}],children:(0,V.jsx)(A.Z,{min:1,controls:!1})}):"Weekly"===t?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Form.Item,{label:"Recure every day(s)",name:"recureEvery",className:"mb-2",rules:[{required:!0,message:"Recure Day is required"}],children:(0,V.jsx)(A.Z,{min:1,controls:!1})}),(0,V.jsx)(n.Form.Item,{name:"week",label:"Selected day(s)",className:"mb-2",rules:[{required:!0,message:"Week day is required"}],children:(0,V.jsx)(E.Z,{options:[{label:"Monday",value:"MON"},{label:"Tuesday",value:"TUE"},{label:"Wednesday",value:"WED"},{label:"Thursday",value:"THU"},{label:"Friday",value:"FRI"},{label:"Saturday",value:"SAT"},{label:"Sunday",value:"SUN"}],mode:"multiple"})})]}):"Monthly"===t?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Form.Item,{name:"months",label:"Selected month(s)",className:"mb-2",rules:[{required:!0,message:"Month is required"}],children:(0,V.jsx)(E.Z,{options:[{label:"January",value:"JAN"},{label:"February",value:"FEB"},{label:"March",value:"MAR"},{label:"April",value:"APR"},{label:"May",value:"MAY"},{label:"June",value:"JUN"},{label:"July",value:"JUL"},{label:"August",value:"AUG"},{label:"September",value:"SEP"},{label:"October",value:"OCT"},{label:"November",value:"NOV"},{label:"December",value:"DEC"}],mode:"multiple"})}),(0,V.jsx)(n.Form.Item,{name:"days",label:"On date(s)",className:"mb-2",rules:[{required:!0,message:"Date is required"}],children:(0,V.jsx)(E.Z,{options:[{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10",value:"10"},{label:"11",value:"11"},{label:"12",value:"12"},{label:"13",value:"13"},{label:"14",value:"14"},{label:"15",value:"15"},{label:"16",value:"16"},{label:"17",value:"17"},{label:"18",value:"18"},{label:"19",value:"19"},{label:"20",value:"20"},{label:"21",value:"21"},{label:"22",value:"22"},{label:"23",value:"23"},{label:"24",value:"24"},{label:"25",value:"25"},{label:"26",value:"26"},{label:"27",value:"27"},{label:"28",value:"28"},{label:"29",value:"29"},{label:"30",value:"30"}],mode:"multiple"})})]}):null]})}})]}),(0,V.jsx)(n.Modal,{width:700,title:"Column Selection",open:f,onCancel:function(){return b(!1)},children:(0,V.jsx)(P.Z,{data:null===D||void 0===D?void 0:D.Columns,onCancel:function(){return b(!1)},onSave:function(e){s.setFieldValue("columnIds",e),b(!1)},values:s.getFieldValue("columnIds")})})]}):(0,V.jsx)("div",{className:"h-[100px] col-span-12 flex items-center justify-center",children:(0,V.jsx)(j.Z,{style:{fontSize:28}})})})},K={Success:"success",Error:"error"},G=[{label:"Execute Date",name:"ExecuteDate",cellRender:function(e){var t=e.value;return(0,V.jsx)("div",{children:t?B()(t).format("YYYY-MM-DD HH:mm"):null})}},{label:"Status",name:"ExecuteStatus",width:150,cellRender:function(e){var t=e.value;return(0,V.jsx)(c.Z,{color:K[t],children:t})}},{label:"Description",name:"Descr"}];var $=function(e){var t=e.show,a=e.onCancel,l=e.data,s=(0,o.useState)([]),i=(0,r.Z)(s,2),d=i[0],c=i[1],u=(0,o.useState)(!1),m=(0,r.Z)(u,2),p=(m[0],m[1]);(0,o.useEffect)((function(){l&&h()}),[l]);var h=function(){p(!0),(0,q.k)({method:"get",url:"reportjob/log/".concat(l.Id)}).then((function(e){c(e.data)})).catch((function(e){})).then((function(){p(!1)}))};return(0,V.jsxs)(n.Modal,{open:t,onCancel:a,title:(0,V.jsxs)("div",{children:[null===l||void 0===l?void 0:l.Code," ",(0,V.jsx)("span",{className:"text-md text-gray-400 font-normal",children:"( last 30 days log )"})]}),width:700,children:[(0,V.jsxs)("div",{className:"pb-3 grid grid-cols-12 gap-5",children:[(0,V.jsx)("table",{className:"text-xs col-span-6",children:(0,V.jsxs)("tbody",{children:[(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"w-[120px] text-gray-500",children:"Template: "}),(0,V.jsx)("td",{children:null===l||void 0===l?void 0:l.ReportTemplateName})]}),(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"text-gray-500",children:"Schedule Type:"}),(0,V.jsx)("td",{children:null===l||void 0===l?void 0:l.ScheduleType})]})]})}),(0,V.jsx)("table",{className:"text-xs col-span-6",children:(0,V.jsxs)("tbody",{children:[(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"w-[120px] text-gray-500",children:"Start Date: "}),(0,V.jsx)("td",{children:null!==l&&void 0!==l&&l.StartDate?B()(null===l||void 0===l?void 0:l.StartDate).format("YYYY-MM-DD HH:mm"):null})]}),(0,V.jsxs)("tr",{children:[(0,V.jsx)("td",{className:"text-gray-500",children:"End Date:"}),(0,V.jsx)("td",{children:null!==l&&void 0!==l&&l.EndDate?B()(null===l||void 0===l?void 0:l.EndDate).format("YYYY-MM-DD HH:mm"):null})]})]})})]}),(0,V.jsx)(n.Table,{columns:G,data:d,keyExpr:"Id",containerClass:"shadow-none px-0",tableClass:"max-h-[calc(100vh-280px)] border-t"})]})},Q=a(6761),X=a(18711),ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},te=function(e,t){return o.createElement(f.Z,(0,p.Z)({},e,{ref:t,icon:ee}))};var ae=o.forwardRef(te),le=a(51515),re=a(83313);var ne=function(e){var t=e.open,a=e.onClose,l=(e.editData,(0,o.useState)([])),i=(0,r.Z)(l,2),d=i[0],c=i[1],u=(0,o.useState)(null),m=(0,r.Z)(u,2),p=m[0],h=m[1],f=(0,o.useState)(!1),b=(0,r.Z)(f,2),x=b[0],v=b[1],j=(0,o.useState)(!1),D=(0,r.Z)(j,2),y=D[0],g=D[1];(0,o.useEffect)((function(){N()}),[]);var N=function(){(0,q.k)({method:"get",url:"reportjob/sessions"}).then((function(e){c(e.data)}))},S=(0,o.useCallback)((function(e){h(e),v(!0)}),[]),Y=(0,o.useMemo)((function(){return[{label:"Name",name:"SessionName",alignment:"left"},{label:"Name",name:"CreatedDate",alignment:"left",cellRender:function(e){return(0,V.jsx)("div",{children:B()(e.value).format("YYYY-MM-DD HH:mm")})}},{label:"",name:"action",alignment:"left",cellRender:function(e){return(0,V.jsxs)("button",{className:"dlt-button",onClick:function(){return S(e.data)},children:[(0,V.jsx)(ae,{})," Stop process"]})}}]}),[]);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(re.Z,{title:"Running reports",open:t,onClose:a,width:600,extra:(0,V.jsx)(n.Button,{icon:(0,V.jsx)(le.Z,{}),onClick:N,children:"Refresh"}),children:(0,V.jsx)(n.Table,{columns:Y,data:d,containerClass:"shadow-none border"})}),(0,V.jsxs)(s.GI,{visible:x,showTitle:!1,height:110,width:350,children:[(0,V.jsx)("div",{children:"Are you sure you want to stop this process?"}),(0,V.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,V.jsx)(n.Button,{type:"danger",onClick:function(){g(!0),(0,q.k)({method:"post",url:"reportjob/killsession",data:{killId:p.KillId}}).then((function(e){N(),v(!1)})).catch((function(){})).then((function(){return g(!1)}))},loading:y,children:"Yes"}),(0,V.jsx)(n.Button,{onClick:function(){return v(!1)},disabled:y,children:"No"})]})]})]})};B().extend(z()),B().extend(U());var se="Scheduler",oe=[{key:1,icon:(0,V.jsx)(m.Z,{}),label:(0,V.jsx)("div",{className:"w-full",children:"Edit"})},{key:2,icon:(0,V.jsx)(x,{}),label:(0,V.jsx)("div",{className:"w-full",children:"Clone"})},{key:3,icon:(0,V.jsx)(v.Z,{color:"red"}),danger:!0,label:(0,V.jsx)("div",{className:"w-full",children:"Delete"})}];var ie=function(){var e,t=(0,o.useState)([]),a=(0,r.Z)(t,2),m=a[0],p=a[1],h=(0,o.useState)([]),f=(0,r.Z)(h,2),b=f[0],x=f[1],v=(0,o.useState)(null),D=(0,r.Z)(v,2),y=D[0],N=D[1],S=(0,o.useState)(!1),E=(0,r.Z)(S,2),w=E[0],F=E[1],H=(0,o.useState)(!1),R=(0,r.Z)(H,2),A=R[0],P=R[1],O=(0,o.useState)(!1),W=(0,r.Z)(O,2),z=W[0],L=W[1],U=(0,o.useState)(!1),K=(0,r.Z)(U,2),G=K[0],ee=K[1],te=(0,o.useState)(null),ae=(0,r.Z)(te,2),le=ae[0],re=ae[1],ie=(0,o.useState)(null),de=(0,r.Z)(ie,2),ce=de[0],ue=de[1],me=(0,o.useState)(!1),pe=(0,r.Z)(me,2),he=pe[0],fe=pe[1],be=(0,o.useState)(!1),xe=(0,r.Z)(be,2),ve=xe[0],je=xe[1],De=(0,o.useState)(null),ye=(0,r.Z)(De,2),ge=ye[0],Ne=ye[1],Se=(0,o.useState)(!1),Ye=(0,r.Z)(Se,2),Me=Ye[0],Ie=Ye[1],Ce=(0,o.useState)(null),Te=(0,r.Z)(Ce,2),Ze=Te[0],ke=Te[1],Ee=i.Z.useForm(),we=(0,r.Z)(Ee,1)[0],Fe=i.Z.useForm(),He=(0,r.Z)(Fe,1)[0],Re=(0,o.useContext)(k.V),Ae=Re.action,qe=Re.state,Pe=d.ZP.useNotification(),Ve=(0,r.Z)(Pe,2),Je=Ve[0],Oe=Ve[1];(0,o.useEffect)((function(){Ae.changeMenuKey("/report/scheduler"),Be(),ze(),We()}),[]);var Be=function(){P(!0),(0,q.k)({method:"get",url:"ReportJob"}).then((function(e){p(e.data)})).catch((function(e){})).then((function(){return P(!1)}))},We=function(){qe.referData.dateTypes||q.k.get("tasreport/reporttemplate/datetypes").then((function(e){var t,a=null===(t=e.data.DateVariables)||void 0===t?void 0:t.map((function(e){return{value:e,label:e}}));Ae.setReferDataItem({dateTypes:a})})).catch((function(e){}))},ze=function(){(0,q.k)({method:"get",url:"tasreport/reporttemplate"}).then((function(e){var t=[];e.data.map((function(e){e.Active&&t.push((0,l.Z)({label:e.Description,value:e.Id},e))})),x(t)}))},Le=(0,o.useCallback)((function(e,t){var a,l;1==e?(l=t.data,Ne(null),N(l),ee(!0)):2==e?(a=t.data,N(null),Ne(a),ee(!0)):3==e&&function(e){Ne(null),N(e),F(!0)}(t.data)}),[]),Ue=(0,o.useMemo)((function(){return[{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,V.jsx)(X.DcD,{color:1===e.value?"lime":0===e.value?"lightgray":"red"})}},{label:"Report Template",name:"ReportTemplateName"},{label:"Code",name:"Code"},{label:"Type",name:"ScheduleType",alignment:"left",width:90,cellRender:function(e){return(0,V.jsx)(c.Z,{color:"Daily"===e.value?"blue":"Weekly"===e.value?"purple":"Monthly"===e.value?"orange":"success",children:e.value})}},{label:"Next Run",name:"nextExecuteDate",alignment:"left",cellRender:function(e){return(0,V.jsx)("div",{children:e.value?B()(e.value).format("YYYY MMMM DD, HH:mm"):""})}},{label:"Last Run",name:"lastExecuteDate",alignment:"left",cellRender:function(e){var t,a=e.value;return(0,V.jsx)("div",{children:a?(t=a,B()(t).diff(B()().subtract(30,"d"),"day")<0?(0,V.jsx)("div",{children:B()(t).format("YYYY MMM DD, HH:mm")}):(0,V.jsx)(n.Tooltip,{title:B()(t).format("YYYY MMM DD, HH:mm"),children:(0,V.jsx)("div",{children:B()(t).fromNow()})})):null})}},{label:"Last Status",name:"lastExecuteStatus",alignment:"left",cellRender:function(e){var t=e.value;return t?(0,V.jsx)(c.Z,{color:"Success"===t?"success":"error",children:t}):null}},{label:"Start Date",name:"StartDate",alignment:"left",cellRender:function(e){return(0,V.jsx)("div",{children:e.value?B()(e.value).format("YYYY MMMM DD, HH:mm"):""})}},{label:"End Date",name:"EndDate",alignment:"left",cellRender:function(e){return(0,V.jsx)("div",{children:e.value?B()(e.value).format("YYYY MMMM DD, HH:mm"):""})}},{label:"Created User",name:"CreatedUser",alignment:"left"},{label:"Created Date",name:"CreatedDate",alignment:"left",cellRender:function(e){return(0,V.jsx)("div",{children:e.value?B()(e.value).format("YYYY MMMM DD, HH:mm"):""})}},{label:"",name:"action",width:"240px",cellRender:function(e){return(0,V.jsxs)("div",{className:"flex gap-3",children:[(0,V.jsxs)("button",{type:"button",className:"edit-button flex items-center gap-2",disabled:ce,onClick:function(){return t=e.data.Id,ue(t),void(0,q.k)({method:"get",url:"reportjob/test/".concat(t),responseType:"blob"}).then((function(e){var t=e.headers["content-disposition"].split("; ")[1].replace("filename=","");(0,Q.p)(e.data,t)})).catch((function(){})).then((function(){return ue(null)}));var t},children:[ce===e.data.Id?(0,V.jsx)(j.Z,{}):(0,V.jsx)(g,{}),"Run"]}),(0,V.jsxs)("button",{className:"edit-button flex items-center gap-2",onClick:function(){return t=e.data,Ie(!0),void ke(t);var t},children:[(0,V.jsx)(Y,{})," Log"]}),(0,V.jsx)(u.Z,{trigger:"click",placement:"bottomRight",menu:{onClick:function(t){var a=t.key;return Le(a,e)},items:oe},children:(0,V.jsx)(n.Button,{onClick:function(e){return e.stopPropagation()},icon:(0,V.jsx)(M.Z,{})})})]})}}]}),[ce]),_e=[{label:"Type",name:"templateId",className:"col-span-3 mb-2",type:"select",inputprops:{options:b}},{label:"Keyword",name:"Keyword",className:"col-span-3 mb-2"}],Ke=function(){ee(!1)};return(0,V.jsxs)("div",{children:[(0,V.jsxs)("div",{className:"rounded-ot bg-white p-5 mb-5 shadow-md",children:[(0,V.jsx)("div",{className:"text-lg font-bold mb-3",children:se}),(0,V.jsx)("div",{className:"w-full",children:(0,V.jsx)(n.Form,{form:He,fields:_e,className:"grid grid-cols-12 gap-x-8",onFinish:function(e){P(!0),(0,q.k)({method:"get",url:"ReportJob?templateId=".concat(e.templateId?e.templateId:"","&keyword=").concat(e.Keyword)}).then((function(e){p(e.data)})).finally((function(){return P(!1)}))},noLayoutConfig:!0,children:(0,V.jsx)("div",{className:"flex col-span-2 items-baseline",children:(0,V.jsx)(n.Button,{htmlType:"submit",className:"flex items-center",loading:A,icon:(0,V.jsx)(I.Z,{}),children:"Search"})})})})]}),(0,V.jsx)(n.Table,{data:m,columns:Ue,allowColumnReordering:!1,loading:A,keyExpr:"Id",tableClass:"border-t max-h-[calc(100vh-285px)]",title:(0,V.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,V.jsxs)("div",{className:"flex items-center gap-1",children:[(0,V.jsx)("span",{className:"font-bold",children:m.length}),(0,V.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,V.jsxs)("div",{children:["SystemAdmin"===(null===(e=qe.userInfo)||void 0===e?void 0:e.Role)?(0,V.jsx)(n.Button,{className:"mr-4",onClick:function(){return je(!0)},children:"Running reports"}):null,(0,V.jsxs)(n.Button,{icon:(0,V.jsx)(C.Z,{}),onClick:function(){N(null),we.resetFields(),ee(!0)},children:["Add ",se]})]})]})}),(0,V.jsx)(n.Modal,{footer:(0,V.jsx)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:ge?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(n.Button,{type:"primary",disabled:he,onClick:function(){return we.submit()},loading:z,icon:(0,V.jsx)(T.Z,{}),children:"Save"}),(0,V.jsx)(n.Button,{onClick:Ke,disabled:z,children:"Cancel"})]}):(0,V.jsxs)(V.Fragment,{children:[y?(0,V.jsx)(n.Button,{type:"primary",onClick:function(){fe(!0);var e=we.getFieldsValue(),t=[];e.parameters&&Object.keys(e.parameters).map((function(a){e.parameters[a]&&("StartDate"===a||"EndDate"===a||"CurrentDate"===a?t.push({parameterId:le[a].Id,parameterValue:e.parameters[a].FieldValue,Days:e.parameters[a].Days}):t.push({parameterId:le[a].Id,parameterValue:JSON.stringify(e.parameters[a])}))})),(0,q.k)({method:"post",url:"reportjob/buildreport",responseType:"blob",data:{reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t}}).then((function(e){var t=e.headers["content-disposition"].split("; ")[1].replace("filename=","");(0,Q.p)(e.data,t),ee(!1)})).catch((function(){})).then((function(){return fe(!1)}))},loading:he,icon:(0,V.jsx)(Z.Z,{}),children:"Run"}):null,(0,V.jsx)(n.Button,{type:"primary",disabled:he,onClick:function(){return we.submit()},loading:z,icon:(0,V.jsx)(T.Z,{}),children:"Save"}),(0,V.jsx)(n.Button,{onClick:Ke,disabled:z,children:"Cancel"})]})}),open:G,width:1100,onCancel:function(){return ee(!1)},title:ge?"Clone ".concat(se):y?"Edit ".concat(se):"Add ".concat(se),children:(0,V.jsx)(n.Form,{labelAlign:"left",form:we,onFinish:function(e){var t=[];e.parameters&&Object.keys(e.parameters).map((function(a){e.parameters[a]&&("StartDate"===a||"EndDate"===a||"CurrentDate"===a?t.push({parameterId:le[a].Id,parameterValue:e.parameters[a].FieldValue,days:e.parameters[a].Days}):t.push({parameterId:le[a].Id,parameterValue:JSON.stringify(e.parameters[a])}))})),y?"Daily"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.startDate).format("YYYY-MM-DD HH:mm"),Id:y.Id}}).then((function(a){a.data?(0,q.k)({method:"put",url:"reportjob/daily",data:{id:y.Id,name:e.Name,description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,startDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),endDate:B()(e.EndDate).format("YYYY-MM-DD"),subscriptionMails:e.subscriptionMails,recureEvery:e.recureEvery}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Weekly"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),Id:y.Id}}).then((function(a){a.data?(0,q.k)({method:"put",url:"reportjob/weekly",data:{id:y.Id,Name:e.Name,Description:e.Description,columnIds:e.columnIds,parameters:t,StartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),EndDate:B()(e.EndDate).format("YYYY-MM-DD"),subscriptionMails:e.subscriptionMails,recureEvery:e.recureEvery,days:e.week,reportTemplateId:e.reportTemplateId}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Monthly"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.startDate).format("YYYY-MM-DD HH:mm"),Id:y.Id}}).then((function(a){a.data?(0,q.k)({method:"put",url:"reportjob/monthly",data:{id:y.Id,Name:e.Name,Description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,StartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),EndDate:B()(e.EndDate).format("YYYY-MM-DD"),subscriptionMails:e.subscriptionMails,months:e.months,days:e.days}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"RunTime"===e.scheduleType&&(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),Id:y.Id}}).then((function(a){a.data?(0,q.k)({method:"put",url:"reportjob/runtime",data:{id:y.Id,Name:e.Name,Description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,executeDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),subscriptionMails:e.subscriptionMails}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):ge?"Daily"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/daily",data:{name:e.Name,description:e.Nescription,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,startDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),endDate:B()(e.EndDate).format("YYYY-MM-DD"),subscriptionMails:e.subscriptionMails,recureEvery:e.recureEvery}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Weekly"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/weekly",data:{Name:e.Name,Description:e.Description,columnIds:e.columnIds,parameters:t,StartDate:e.StartDate?B()(e.StartDate).format("YYYY-MM-DD HH:mm"):null,EndDate:e.EndDate?B()(e.EndDate).format("YYYY-MM-DD"):null,subscriptionMails:e.subscriptionMails,recureEvery:e.recureEvery,days:e.week,reportTemplateId:e.reportTemplateId}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Monthly"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/monthly",data:{Name:e.Name,Description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,StartDate:e.StartDate?B()(e.StartDate).format("YYYY-MM-DD HH:mm"):null,EndDate:e.EndDate?B()(e.EndDate).format("YYYY-MM-DD"):null,subscriptionMails:e.subscriptionMails,months:e.months,days:e.days}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"RunTime"===e.scheduleType&&(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/runtime",data:{Name:e.Name,Description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,executeDate:e.StartDate?B()(e.StartDate).format("YYYY-MM-DD HH:mm"):null,subscriptionMails:e.subscriptionMails}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Daily"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/daily",data:{name:e.Name,description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,startDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm"),endDate:B()(e.EndDate).format("YYYY-MM-DD"),subscriptionMails:e.subscriptionMails,recureEvery:e.recureEvery}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Weekly"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/weekly",data:{Name:e.Name,Description:e.Description,columnIds:e.columnIds,parameters:t,StartDate:e.StartDate?B()(e.StartDate).format("YYYY-MM-DD HH:mm"):null,EndDate:e.EndDate?B()(e.EndDate).format("YYYY-MM-DD"):null,subscriptionMails:e.subscriptionMails,recureEvery:e.recureEvery,days:e.week,reportTemplateId:e.reportTemplateId}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"Monthly"===e.scheduleType?(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/monthly",data:{Name:e.Name,Description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,StartDate:e.StartDate?B()(e.StartDate).format("YYYY-MM-DD HH:mm"):null,EndDate:e.EndDate?B()(e.EndDate).format("YYYY-MM-DD"):null,subscriptionMails:e.subscriptionMails,months:e.months,days:e.days}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)}))):"RunTime"===e.scheduleType&&(L(!0),(0,q.k)({method:"post",url:"reportjob/validatetime",data:{scheduleStartDate:B()(e.StartDate).format("YYYY-MM-DD HH:mm")}}).then((function(a){a.data?(0,q.k)({method:"post",url:"reportjob/runtime",data:{Name:e.Name,Description:e.Description,reportTemplateId:e.reportTemplateId,columnIds:e.columnIds,parameters:t,executeDate:e.StartDate?B()(e.StartDate).format("YYYY-MM-DD HH:mm"):null,subscriptionMails:e.subscriptionMails}}).then((function(){ee(!1),Be()})).catch((function(){})).then((function(){return L(!1)})):Je.error({message:"Duplicated Starting on date",duration:5,description:"Please change Starting on date"})})).finally((function(){return L(!1)})))},className:"gap-x-4",labelCol:{sm:{span:6}},initValues:{scheduleType:"Daily"},children:y||ge?(0,V.jsx)(_,{onChangeParameters:function(e){return re(e)},editData:ge||y,templates:b,form:we}):(0,V.jsx)(J,{onChangeParameters:function(e){return re(e)},templates:b,form:we})})}),(0,V.jsx)(ne,{open:ve,onClose:function(){return je(!1)}}),(0,V.jsxs)(s.GI,{visible:w,showTitle:!1,height:110,width:350,children:[(0,V.jsxs)("div",{children:["Are you sure you want to ",1===(null===y||void 0===y?void 0:y.Active)?"deactivate":"reactivate"," this record?"]}),(0,V.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,V.jsx)(n.Button,{type:1===(null===y||void 0===y?void 0:y.Active)?"danger":"success",onClick:function(){L(!0),(0,q.k)({method:"delete",url:"reportjob/delete/".concat(y.Id)}).then((function(){Be(),F(!1)})).catch((function(e){})).then((function(){return L(!1)}))},loading:z,children:"Yes"}),(0,V.jsx)(n.Button,{onClick:function(){return F(!1)},disabled:z,children:"No"})]})]}),(0,V.jsx)($,{show:Me,onCancel:function(){return Ie(!1)},data:Ze}),Oe]})}},37289:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var l=a(87462),r=a(47313),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},s=a(17469),o=function(e,t){return r.createElement(s.Z,(0,l.Z)({},e,{ref:t,icon:n}))};var i=r.forwardRef(o)},59694:function(e){e.exports=function(){"use strict";return function(e,t,a){e=e||{};var l=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function n(e,t,a,r){return l.fromToBase(e,t,a,r)}a.en.relativeTime=r,l.fromToBase=function(t,l,n,s,o){for(var i,d,c,u=n.$locale().relativeTime||r,m=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=m.length,h=0;h<p;h+=1){var f=m[h];f.d&&(i=s?a(t).diff(n,f.d,!0):n.diff(t,f.d,!0));var b=(e.rounding||Math.round)(Math.abs(i));if(c=i>0,b<=f.r||!f.r){b<=1&&h>0&&(f=m[h-1]);var x=u[f.l];o&&(b=o(""+b)),d="string"==typeof x?x.replace("%d",b):x(b,l,f.l,c);break}}if(l)return d;var v=c?u.future:u.past;return"function"==typeof v?v(d):v.replace("%s",d)},l.to=function(e,t){return n(e,t,this,!0)},l.from=function(e,t){return n(e,t,this)};var s=function(e){return e.$u?a.utc():a()};l.toNow=function(e){return this.to(s(this),e)},l.fromNow=function(e){return this.from(s(this),e)}}}()}}]);
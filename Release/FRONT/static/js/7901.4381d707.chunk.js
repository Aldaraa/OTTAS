"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[7901],{87901:function(e,t,n){n.r(t);var s=n(1413),a=n(29439),l=n(56573),i=n(2880),o=n(47313),c=n(65040),d=n(74294),r=n(14576),u=n(93031),f=n(58467),h=n(10658),m=n.n(h),x=n(42614),p=n(165),v=n(76629),j=n(46417),C=o.memo((function(e){var t=e.date,n=e.isEdit,s=e.data,a=e.shiftStatus,l=e.onSiteShifts,i=e.offSiteShifts,o=null===s||void 0===s?void 0:s.find((function(e){return m()(e.EventDate).format("YYYY-MM-DD")===m()(t).format("YYYY-MM-DD")})),u=null===a||void 0===a?void 0:a.find((function(e){return e.Id===(null===o||void 0===o?void 0:o.ShiftId)}));return(0,j.jsxs)("div",{className:"w-full flex flex-col",children:[(0,j.jsx)("div",{className:"flex flex-col items-start",children:(0,j.jsxs)("div",{className:"font-medium",children:[m()(t).format("DD")," ",(0,j.jsx)("span",{className:"text-xs font-normal text-secondary2",children:m()(t).format("MMM")})]})}),o&&(0,j.jsx)("div",{className:"flex gap-3 items-center",children:(0,j.jsx)(c.Z.Item,{className:"m-0 p-0 flex-1 self-center",name:[o.index,"ShiftId"],children:(0,j.jsx)(d.Z,{disabled:!n,className:"w-full rounded-md",popupMatchSelectWidth:!1,optionlabelProp:"label",bordered:!1,style:{background:null===u||void 0===u?void 0:u.ColorCode},size:"small",allowClear:!0,showSearch:!0,options:u?1===u.OnSite?l:i:a,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},optionRender:function(e){return(0,j.jsx)(r.Z,{children:e.data.label})},children:u?1===u.OnSite?l.map((function(e,t){return(0,j.jsx)(d.Z.Option,{value:e.value,label:e.label,children:e.content?e.content:e.label},t)})):i.map((function(e,t){return(0,j.jsx)(d.Z.Option,{value:e.value,label:e.label,children:e.content?e.content:e.label},t)})):a.map((function(e,t){return(0,j.jsx)(d.Z.Option,{value:e.value,label:e.label,children:e.content?e.content:e.label},t)}))})})})]})}),(function(e,t){return JSON.stringify(e.data)&&JSON.stringify(t.data)&&e.isEdit!==t.isEdit&&e.shiftStatus!==t.shiftStatus}));t.default=function(){var e,t=(0,o.useState)([]),n=(0,a.Z)(t,2),d=n[0],r=n[1],h=(0,o.useState)(m()().startOf("M")),S=(0,a.Z)(h,2),g=S[0],b=S[1],Z=(0,o.useState)([]),N=(0,a.Z)(Z,2),y=N[0],D=N[1],Y=(0,o.useState)([]),I=(0,a.Z)(Y,2),k=I[0],M=I[1],w=(0,o.useState)([]),O=(0,a.Z)(w,2),F=O[0],B=O[1],E=(0,o.useState)([]),R=(0,a.Z)(E,2),q=R[0],A=R[1],L=(0,o.useState)(!1),P=(0,a.Z)(L,2),V=P[0],_=P[1],J=(0,o.useState)(!1),U=(0,a.Z)(J,2),z=U[0],W=U[1],G=(0,o.useState)(!1),H=(0,a.Z)(G,2),K=H[0],Q=H[1],T=c.Z.useForm(),X=(0,a.Z)(T,1)[0],$=c.Z.useForm(),ee=(0,a.Z)($,1)[0],te=(0,f.UO)().employeeId,ne=(0,o.useContext)(x.V),se=ne.state,ae=ne.action;(0,o.useEffect)((function(){v.Z.set("pp_rt","shiftvisual"),le(),ie()}),[g]);var le=function(){(0,l.Z)({method:"get",url:"tas/employeestatus/visualstatusdates/".concat(te,"/").concat(m()(g).format("YYYY-MM-DD"))}).then((function(e){var t=[];e.data.map((function(e,n){t.push((0,s.Z)({index:n},e))})),X.setFieldsValue({shift:t}),r(t)})).catch((function(e){}))},ie=function(){(0,l.Z)({method:"get",url:"tas/shift?Active=1"}).then((function(e){var t=[],n=[],a=[],l=[];e.data.map((function(e){t.push((0,s.Z)({value:e.Id,label:"".concat(e.Code),content:(0,j.jsx)("div",{className:"flex gap-1 text-xs",children:(0,j.jsx)("span",{children:e.Code})})},e)),l.push((0,s.Z)({value:e.Id,label:"".concat(e.Code,"-").concat(e.Description),content:(0,j.jsx)("div",{className:"flex gap-1 text-xs",children:(0,j.jsx)("span",{children:e.Code})})},e)),1===e.OnSite?n.push((0,s.Z)({value:e.Id,label:e.Code,content:(0,j.jsx)("div",{className:"flex gap-1 text-xs",children:(0,j.jsx)("span",{children:e.Code})})},e)):a.push((0,s.Z)({value:e.Id,label:e.Code,content:(0,j.jsx)("div",{className:"flex gap-1 text-xs",children:(0,j.jsx)("span",{children:e.Code})})},e))})),M(l),D(t),A(a),B(n)})).catch((function(e){}))},oe=[{type:"component",component:(0,j.jsx)(c.Z.Item,{name:"rangeDate",label:"Date",className:"col-span-12 mb-4",rules:[{required:!0,message:"Date is required"}],children:(0,j.jsx)(u.Z.RangePicker,{className:"w-full"})})},{label:"Shift",name:"ShiftId",className:"col-span-12 mb-4",rules:[{required:!0,message:"Shift is required"}],type:"select",inputprops:{options:k}}],ce=function(){(0,l.Z)({method:"get",url:"tas/employee/".concat(te)}).then((function(e){ae.saveUserProfileData(e.data)})).catch((function(e){}))},de=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=0,a=[];s<e.length;)a.push((0,j.jsxs)("div",{className:"flex flex-col gap-1",children:[0===s?(0,j.jsx)("div",{className:"text-gray-500 font-bold mb-2",children:t}):(0,j.jsx)("div",{className:"mb-2",children:"\xa0"}),e.slice(s,s+n).map((function(e,t){return(0,j.jsxs)("div",{className:"flex items-start gap-2",children:[(0,j.jsx)("div",{className:"w-[50px] text-center py-[2px] rounded-md",style:{backgroundColor:e.ColorCode},children:(0,j.jsx)("div",{className:"text-xs",style:{color:e.ColorCode?(0,p.Z)(e.ColorCode)>60?"black":"white":"black"},children:e.Code})}),(0,j.jsxs)("div",{className:"leading-none",children:[e.Description," "]})]},t)}))]},s)),s+=n;return a};return(0,j.jsxs)("div",{className:"bg-white rounded-ot p-4 col-span-12 shadow-md",children:[(0,j.jsx)("div",{className:"text-lg font-bold mb-3",children:"Shift Visual"}),(0,j.jsxs)("div",{className:"grid grid-cols-12 gap-5",children:[(0,j.jsx)("div",{className:"col-span-12 2xl:col-span-6",children:(0,j.jsxs)(c.Z,{form:X,component:!1,onFinish:function(e){var t=[];e.shift.map((function(e){e.ShiftId&&t.push(e)})),(0,l.Z)({method:"post",url:"tas/employeestatus/visualstatusdatechange",data:{employeeId:te,statusDates:[].concat(t)}}).then((function(e){le(),ce(),_(!1)})).catch((function(e){}))},children:[(0,j.jsx)(c.Z.List,{name:"shift",children:function(e){var t;return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(i.ShiftCalendar,{containerClass:"shadow-none",picker:"month",onChange:function(e){return b(m()(e).format("YYYY-MM-DD"))},data:d,cellRender:function(e){return(0,j.jsx)(C,{date:e,isEdit:V,data:d,shiftStatus:y,offSiteShifts:q,onSiteShifts:F})},currentDate:g,extraComponent:null!==(t=se.userInfo)&&void 0!==t&&t.ReadonlyAccess?null:(0,j.jsx)("div",{className:"flex justify-end flex-1",children:(0,j.jsx)(i.Button,{onClick:function(){return W(!0)},children:"Bulk Change"})})})})}}),(0,j.jsx)(c.Z.Item,{className:"mt-2 flex justify-end",children:null!==(e=se.userInfo)&&void 0!==e&&e.ReadonlyAccess?null:V?(0,j.jsxs)("div",{className:"flex gap-4",children:[(0,j.jsx)(i.Button,{type:"success",onClick:function(){return X.submit()},children:"Save"}),(0,j.jsx)(i.Button,{onClick:function(){return _(!1)},children:"Cancel"})]}):(0,j.jsx)(i.Button,{type:"primary",onClick:function(){return _(!0)},children:"Edit"})})]})}),(0,j.jsxs)("div",{className:"col-span-12 2xl:col-span-6 flex justify-around flex-wrap",children:[de(F.sort((function(e,t){return e.Code>t.Code?1:e.Code<t.Code?-1:0})),"On Site Shifts",16),de(q.sort((function(e,t){return e.Code>t.Code?1:e.Code<t.Code?-1:0})),"Off Site Shifts",16)]})]}),(0,j.jsxs)(i.Modal,{title:"Bulk Change",open:z,onCancel:function(){W(!1),ee.resetFields()},destroyOnClose:!0,children:[(0,j.jsx)(i.Form,{fields:oe,form:ee,onFinish:function(e){Q(!0),(0,l.Z)({method:"post",url:"tas/employeestatus/visualstatusbulkchange",data:{employeeId:te,startDate:m()(e.rangeDate[0]).format("YYYY-MM-DD"),endDate:m()(e.rangeDate[1]).format("YYYY-MM-DD"),shiftId:e.ShiftId}}).then((function(e){W(!1),le(),ce()})).catch((function(e){})).then((function(){return Q(!1)}))}}),(0,j.jsx)("div",{className:"flex justify-end",children:(0,j.jsx)(i.Button,{type:"success",onClick:function(){return ee.submit()},loading:K,children:"Save"})})]})]})}}}]);
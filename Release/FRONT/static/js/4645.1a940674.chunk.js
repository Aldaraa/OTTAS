"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[4645],{44645:function(e,t,n){n.r(t);var a=n(93433),c=n(1413),i=n(29439),s=n(2880),o=n(14261),l=n(47313),r=n(65040),u=n(56573),d=n(23495),m=n(53979),h=n(92350),f=n(74134),p=n(82138),v=n(58467),b=n(42614),x=n(46417),g="Roster Master";t.default=function(){var e,t,n,Z=(0,l.useState)(null),N=(0,i.Z)(Z,2),j=N[0],S=N[1],y=(0,l.useState)([]),I=(0,i.Z)(y,2),C=I[0],k=I[1],w=(0,l.useState)([]),A=(0,i.Z)(w,2),R=A[0],D=A[1],B=(0,l.useState)(null),z=(0,i.Z)(B,2),V=z[0],q=z[1],F=(0,l.useState)(!1),H=(0,i.Z)(F,2),M=H[0],O=H[1],E=(0,l.useState)(!1),G=(0,i.Z)(E,2),J=G[0],T=G[1],_=(0,l.useState)(!1),K=(0,i.Z)(_,2),L=K[0],U=K[1],Y=(0,l.useState)(!1),P=(0,i.Z)(Y,2),Q=P[0],W=P[1],X=(0,l.useState)([]),$=(0,i.Z)(X,2),ee=$[0],te=$[1],ne=(0,l.useState)([]),ae=(0,i.Z)(ne,2),ce=ae[0],ie=ae[1],se=(0,l.useState)(!1),oe=(0,i.Z)(se,2),le=oe[0],re=oe[1],ue=(0,v.UO)().rosterId,de=r.Z.useForm(),me=(0,i.Z)(de,1)[0],he=r.Z.useForm(),fe=(0,i.Z)(he,1)[0],pe=(0,v.s0)(),ve=(0,l.useContext)(b.V),be=ve.action,xe=ve.state;(0,l.useEffect)((function(){be.changeMenuKey("/tas/roster"),ge(),Ze(),Ne(),je()}),[]);var ge=function(){O(!0),(0,u.Z)({method:"get",url:"tas/rosterdetail/".concat(ue)}).then((function(e){if(k(e.data),1===fe.getFieldValue("Active")){var t=e.data.filter((function(e){return 1===e.Active}));D(t)}else if(0===fe.getFieldValue("Active")){var n=e.data.filter((function(e){return 0===e.Active}));D(n)}else D(e.data)})).catch((function(e){})).then((function(){return O(!1)}))},Ze=function(){O(!0),(0,u.Z)({method:"get",url:"tas/roster/".concat(ue)}).then((function(e){S(e.data)})).catch((function(e){})).then((function(){return O(!1)}))},Ne=function(){(0,u.Z)({method:"get",url:"tas/shift?Active=1"}).then((function(e){var t=[];e.data.map((function(e,n){t.push({value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)})})),te(t)})).catch((function(e){}))},je=function(){(0,u.Z)({method:"get",url:"tas/rostergroup?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push({label:e.Description,value:e.Id})})),ie(t)})).catch((function(e){}))},Se=function(e){q(e),T(!0)},ye=[{label:"Seq Number",name:"SeqNumber",alignment:"left",width:90},{label:"Nights",name:"DaysOn",alignment:"left",width:60},{label:"Shift Status",name:"ShiftName"},{label:"On Site",name:"OnSite",width:"100px",alignment:"center",cellRender:function(e){return(0,x.jsx)(o.Jg,{disabled:!0,iconSize:18,value:1===e.data.OnSite||0})}},{label:"Active",name:"Active",width:"70px",alignment:"center",cellRender:function(e){return(0,x.jsx)(o.Jg,{disabled:!0,iconSize:18,value:1===e.data.OnSite||0})}},{label:"",name:"action",width:"170px",cellRender:function(e){return(0,x.jsxs)("div",{className:"flex gap-4",children:[(0,x.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,q(t),void W(!0);var t},children:"Edit"}),1===e.data.Active?(0,x.jsx)("button",{type:"button",className:"dlt-button",onClick:function(){return Se(e.data)},children:"Deactivate"}):(0,x.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return Se(e.data)},children:"Reactivate"})]})}}],Ie=[{label:"Name",name:"Name",className:"col-span-2 mb-2"},{label:"Description",name:"Description",className:"col-span-3 mb-2"},{label:"Roster Group",name:"RosterGroupId",className:"col-span-3 mb-2",type:"select",inputprops:{options:ce}},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],Ce=[{label:"Shift",name:"ShiftId",className:"col-span-12 mb-2",type:"select",inputprops:{options:ee}},{label:"Seq Number",name:"SeqNumber",className:"col-span-12 mb-2",type:"number"},{label:"Nights",name:"DaysOn",className:"col-span-12 mb-2",type:"number"}],ke=[{label:"Shift",name:"ShiftId",className:"col-span-12 mb-2",type:"select",inputprops:{options:ee}},{label:"Seq Number",name:"SeqNumber",className:"col-span-12 mb-2",type:"number"},{label:"Nights",name:"DaysOn",className:"col-span-12 mb-2",type:"number"},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check"}];return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"rounded-ot bg-white p-5 mb-5 shadow-md",children:[(0,x.jsx)(s.Button,{className:"mb-5",onClick:function(){return pe(-1)},icon:(0,x.jsx)(d.Z,{}),children:"Back"}),(0,x.jsx)("div",{className:"text-lg font-bold mb-3",children:"Roster Detail"}),(0,x.jsx)(s.Form,{form:fe,fields:Ie,editData:j,className:"grid grid-cols-12 gap-x-8",onFinish:function(e){U(!0),(0,u.Z)({method:"put",url:"tas/roster",data:(0,c.Z)((0,c.Z)({},e),{},{id:ue})}).then((function(){Ze()})).catch((function(e){})).then((function(){return U(!1)}))},disabled:null===(e=xe.userInfo)||void 0===e?void 0:e.ReadonlyAccess,children:(0,x.jsx)("div",{className:"flex gap-3 items-baseline col-span-1",children:!(null!==(t=xe.userInfo)&&void 0!==t&&t.ReadonlyAccess)&&(0,x.jsx)(s.Button,{type:"primary",onClick:function(){return me.submit()},loading:L,icon:(0,x.jsx)(m.Z,{}),children:"Save"})})})]}),(0,x.jsx)(s.Table,{title:(0,x.jsxs)("div",{className:"flex justify-between items-center py-2 px-1",children:[(0,x.jsx)("div",{className:"text-lg font-bold",children:g}),!(null!==(n=xe.userInfo)&&void 0!==n&&n.ReadonlyAccess)&&(le?(0,x.jsxs)("div",{className:"flex items-center gap-4",children:[(0,x.jsx)(s.Button,{className:"mb-2",type:"primary",icon:(0,x.jsx)(h.Z,{}),onClick:function(){var e=[];R.map((function(t){e.push(t.Id)})),(0,u.Z)({method:"post",url:"tas/rosterdetail/setseq",data:{rosterDetailIds:e,rosterId:ue}}).then((function(e){ge(),re(!1)})).catch((function(e){}))},children:"Save Reorder"}),(0,x.jsx)(s.Button,{className:"mb-2",onClick:function(){D(C),re(!1)},children:"Cancel"})]}):(0,x.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,x.jsx)(s.Button,{icon:(0,x.jsx)(f.Z,{}),onClick:function(){return re(!0)},children:"Change Seq"}),(0,x.jsxs)(s.Button,{icon:(0,x.jsx)(p.Z,{}),onClick:function(){q(null),me.resetFields(),W(!0)},children:["Add ",g]})]}))]}),data:R,columns:ye,allowColumnReordering:!1,loading:M,keyExpr:"Id",tableClass:"border-t max-h-[calc(100vh-282px)]",rowDragging:!!le&&{onReorder:function(e){return function(e){var t=e.component.getVisibleRows(),n=(0,a.Z)(R),c=null===n||void 0===n?void 0:n.findIndex((function(n){return n.Id===t[e.toIndex].data.Id})),i=null===n||void 0===n?void 0:n.findIndex((function(t){return t.Id===e.itemData.Id}));n.splice(i,1),n.splice(c,0,e.itemData),D(n)}(e)}}}),(0,x.jsx)(s.Modal,{open:Q,onCancel:function(){return W(!1)},title:V?"Edit ".concat(g):"Add ".concat(g),children:(0,x.jsx)(s.Form,{form:me,fields:V?Ce:ke,editData:V||{SeqNumber:C.length+1},onFinish:function(e){U(!0),V?(0,u.Z)({method:"put",url:"tas/rosterdetail",data:(0,c.Z)((0,c.Z)({},e),{},{Id:V.Id,rosterId:parseInt(ue)})}).then((function(e){ge(),W(!1)})).catch((function(e){})).then((function(){return U(!1)})):(0,u.Z)({method:"post",url:"tas/rosterdetail",data:(0,c.Z)((0,c.Z)({},e),{},{rosterId:parseInt(ue)})}).then((function(e){ge(),W(!1)})).catch((function(e){})).then((function(){return U(!1)}))},children:(0,x.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,x.jsx)(s.Button,{type:"primary",onClick:function(){return me.submit()},loading:L,icon:(0,x.jsx)(h.Z,{}),children:"Save"}),(0,x.jsx)(s.Button,{onClick:function(){return W(!1)},disabled:L,children:"Cancel"})]})})}),(0,x.jsxs)(o.GI,{visible:J,showTitle:!1,height:110,width:350,children:[(0,x.jsxs)("div",{children:["Are you sure you want to ",1===(null===V||void 0===V?void 0:V.Active)?"deactivate":"reactivate"," this record?"]}),(0,x.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,x.jsx)(s.Button,{type:1===(null===V||void 0===V?void 0:V.Active)?"danger":"success",onClick:function(){U(!0),(0,u.Z)({method:"delete",url:"tas/rostergroup",data:{id:V.Id}}).then((function(){ge(),T(!1)})).catch((function(e){})).then((function(){return U(!1)}))},loading:L,children:"Yes"}),(0,x.jsx)(s.Button,{onClick:function(){return T(!1)},disabled:L,children:"No"})]})]})]})}},74134:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(87462),c=n(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M920 760H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-568H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM216 712H100c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h72.4v20.5h-35.7c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h35.7V838H100c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h116c2.2 0 4-1.8 4-4V716c0-2.2-1.8-4-4-4zM100 188h38v120c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4V152c0-4.4-3.6-8-8-8h-78c-2.2 0-4 1.8-4 4v36c0 2.2 1.8 4 4 4zm116 240H100c-2.2 0-4 1.8-4 4v36c0 2.2 1.8 4 4 4h68.4l-70.3 77.7a8.3 8.3 0 00-2.1 5.4V592c0 2.2 1.8 4 4 4h116c2.2 0 4-1.8 4-4v-36c0-2.2-1.8-4-4-4h-68.4l70.3-77.7a8.3 8.3 0 002.1-5.4V432c0-2.2-1.8-4-4-4z"}}]},name:"ordered-list",theme:"outlined"},s=n(17469),o=function(e,t){return c.createElement(s.Z,(0,a.Z)({},e,{ref:t,icon:i}))};var l=c.forwardRef(o)},53979:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(87462),c=n(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-12-12-28.3-18.7-45.3-18.7H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 176h256v112H384V176zm128 554c-79.5 0-144-64.5-144-144s64.5-144 144-144 144 64.5 144 144-64.5 144-144 144zm0-224c-44.2 0-80 35.8-80 80s35.8 80 80 80 80-35.8 80-80-35.8-80-80-80z"}}]},name:"save",theme:"filled"},s=n(17469),o=function(e,t){return c.createElement(s.Z,(0,a.Z)({},e,{ref:t,icon:i}))};var l=c.forwardRef(o)}}]);
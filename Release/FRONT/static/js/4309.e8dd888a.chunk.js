(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[4309],{15760:function(e,t,n){"use strict";n.r(t);var a=n(45987),l=n(74165),s=n(15861),o=n(1413),c=n(29439),r=n(2880),i=n(14261),d=n(47313),u=n(65040),m=n(93031),h=n(74294),p=n(76298),x=n(21975),f=n(56573),j=n(60020),b=n(82138),v=n(40765),g=n(92350),N=(n(42272),n(42614)),F=n(10658),D=n.n(F),C=n(58467),S=n(2135),I=n(46417),Z=["key","name"],Y="Events";t.default=function(){var e,t=(0,d.useState)([]),n=(0,c.Z)(t,2),F=n[0],w=n[1],y=(0,d.useState)([]),M=(0,c.Z)(y,2),V=(M[0],M[1],(0,d.useState)(null)),k=(0,c.Z)(V,2),E=k[0],P=k[1],q=(0,d.useState)(!1),H=(0,c.Z)(q,2),O=H[0],L=H[1],B=(0,d.useState)(!1),A=(0,c.Z)(B,2),R=A[0],T=A[1],U=(0,d.useState)(!1),W=(0,c.Z)(U,2),G=W[0],_=W[1],K=(0,d.useState)(!1),z=(0,c.Z)(K,2),J=z[0],Q=z[1],X=(0,d.useState)([]),$=(0,c.Z)(X,2),ee=$[0],te=$[1],ne=(0,d.useState)([]),ae=(0,c.Z)(ne,2),le=ae[0],se=ae[1],oe=(0,d.useState)(!1),ce=(0,c.Z)(oe,2),re=(ce[0],ce[1],(0,d.useState)(0)),ie=(0,c.Z)(re,2),de=(ie[0],ie[1],u.Z.useForm()),ue=(0,c.Z)(de,1)[0],me=u.Z.useWatch([],ue),he=u.Z.useForm(),pe=(0,c.Z)(he,1)[0],xe=(0,d.useContext)(N.V).action,fe=(0,C.s0)();(0,d.useEffect)((function(){xe.changeMenuKey("/tas/seatblock"),je()}),[]);var je=function(){L(!0),(0,f.Z)({method:"get",url:"tas/visitevent"}).then((function(e){w(e.data)})).catch((function(e){})).then((function(){return L(!1)}))},be=[{label:"Name",name:"Name"},{label:"Requester",name:"Requester"},{label:"Start",name:"StartDate",width:"200px",cellRender:function(e){return(0,I.jsx)("div",{children:D()(e.value).format("YYYY-MM-DD")})}},{label:"Ends",name:"EndDate",width:"200px",cellRender:function(e){return(0,I.jsx)("div",{children:D()(e.value).format("YYYY-MM-DD")})}},{label:"Duration (nights)",name:"Description",cellRender:function(e){return(0,I.jsx)("div",{children:D()(e.data.EndDate).get("D")-D()(e.data.StartDate).get("D")})}},{label:"Head Count",name:"HeadCount",alignment:"left"},{label:"",name:"",width:"200px",alignment:"start",cellRender:function(e){return(0,I.jsxs)("div",{className:"flex items-center gap-2",children:[(0,I.jsx)(S.Link,{to:"/tas/seatblock/".concat(e.data.Id),children:(0,I.jsx)("button",{type:"button",className:"edit-button",children:"View"})}),(0,I.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,P(t),ge(D()(t.StartDate).format("YYYY-MM-DD"),"IN"),Ne(D()(t.EndDate).format("YYYY-MM-DD"),"OUT"),ue.setFieldValue("Name",t.Name),ue.setFieldValue("StartDate",D()(t.StartDate)),ue.setFieldValue("EndDate",D()(t.EndDate)),ue.setFieldValue("InScheduleId",t.InScheduleId),ue.setFieldValue("OutScheduleId",t.OutScheduleId),ue.setFieldValue("HeadCount",t.HeadCount),void Q(!0);var t},children:"Edit"}),(0,I.jsx)("button",{type:"button",className:"dlt-button",onClick:function(){return t=e.data,P(t),void T(!0);var t},children:"Delete"})]})}}],ve=function(){var e=(0,s.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L(!0),(0,f.Z)({method:"get",url:"tas/visitevent?startDate=".concat(t.StartDate?D()(t.StartDate).format("YYYY-MM-DD"):"","&endDate=").concat(t.EndDate?D()(t.EndDate).format("YYYY-MM-DD"):"","&name=").concat(t.name?t.name:"")}).then((function(e){w(e.data)})).catch((function(e){})).then((function(){return L(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(e,t){(0,f.Z)({method:"get",url:"tas/ActiveTransport/getdatetransport?eventDate=".concat(e,"&Direction=").concat(t)}).then((function(e){var t=[];e.data.map((function(e){t.push({value:e.ScheduleId,label:"".concat(e.Description," ").concat(e.Seat,"/").concat(e.BookedCount)})})),te(t)}))},Ne=function(e,t){(0,f.Z)({method:"get",url:"tas/ActiveTransport/getdatetransport?eventDate=".concat(e,"&Direction=").concat(t)}).then((function(e){var t=[];e.data.map((function(e){t.push({value:e.ScheduleId,label:"".concat(e.Description," ").concat(e.Seat,"/").concat(e.BookedCount)})})),se(t)}))},Fe=function(){ue.getFieldValue("PersonCount")<3e3&&(ue.setFieldValue("PersonCount",ue.getFieldValue("PersonCount")+1),ue.setFieldValue("PrevCount",ue.getFieldValue("PersonCount")))},De=function(){ue.setFieldValue("PersonCount",ue.getFieldValue("PersonCount")-1),ue.setFieldValue("PrevCount",ue.getFieldValue("PersonCount"))},Ce=[{label:"Name",name:"Name",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{}},{type:"component",component:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(r.Form.Item,{label:(0,I.jsxs)("span",{children:[(0,I.jsx)("span",{className:"text-red-500",children:"*"})," Start Schedule"]}),className:"col-span-12 mb-2",children:(0,I.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,I.jsx)(r.Form.Item,{name:"StartDate",className:"mb-0 col-span-5",children:(0,I.jsx)(m.Z,{className:"w-full",onChange:function(e,t){ge(t,"IN"),ue.setFieldValue("InScheduleId",null)}})}),(0,I.jsx)(r.Form.Item,{name:"InScheduleId",className:"mb-0 col-span-7",rules:[{required:!0,message:"Flight is required"}],children:(0,I.jsx)(h.Z,{options:ee,className:"w-full",popupMatchSelectWidth:!1,allowClear:!0,showSearch:!0})})]})})})},{type:"component",component:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(r.Form.Item,{label:(0,I.jsxs)("span",{children:[(0,I.jsx)("span",{className:"text-red-500",children:"*"})," End Schedule"]}),className:"col-span-12 mb-2",children:(0,I.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,I.jsx)(r.Form.Item,{name:"EndDate",className:"mb-0 col-span-5",children:(0,I.jsx)(m.Z,{className:"w-full",onChange:function(e,t){Ne(t,"OUT"),ue.setFieldValue("OutScheduleId",null)}})}),(0,I.jsx)(r.Form.Item,{name:"OutScheduleId",className:"mb-0 col-span-7",rules:[{required:!0,message:"Flight is required"}],children:(0,I.jsx)(h.Z,{options:le,className:"w-full",popupMatchSelectWidth:!1,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})})]})})})},{type:"component",component:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(r.Form.Item,{label:"Head Count",className:"col-span-12 mb-2",children:(0,I.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,I.jsx)(r.Form.Item,{name:"PrevCount",className:"mb-0 col-span-5",children:(0,I.jsx)(p.Z,{className:"w-full",max:3e3})}),(0,I.jsx)(r.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.PrevCount!==t.PrevCount},children:function(e){var t=e.getFieldValue;return(0,I.jsx)(r.Form.Item,{className:"mb-0 col-span-5",children:(0,I.jsx)(r.Button,{onClick:function(){return ue.setFieldValue("PersonCount",ue.getFieldValue("PrevCount"))},disabled:0===t("PrevCount")||!t("PrevCount"),children:"Generate"})})}}),(0,I.jsx)(r.Form.Item,{name:"PersonCount"})]})})})},{type:"component",component:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(r.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.PersonCount!==t.PersonCount},children:function(e){var t=e.getFieldValue,n=e.setFieldValue;if(t("PersonCount")){for(var l=[],s=0;s<t("PersonCount");s++)l.push({last:"L-".concat(D()().format("YYMMDDHHmm"),"-").concat(s+1),first:"F-".concat(D()().format("YYMMDDHHmm"),"-").concat(s+1)});n("people",l)}return(0,I.jsx)(r.Form.List,{name:"people",className:"col-span-12",children:function(e,n){n.add,n.remove;return(0,I.jsxs)(I.Fragment,{children:[e.length>0?(0,I.jsx)("div",{className:"col-span-12 grid grid-cols-12 gap-x-2 gap-y-2 items-center max-h-[350px] overflow-auto mb-3 p-2 border rounded-ot",children:e.map((function(e){e.key;var t=e.name,n=(0,a.Z)(e,Z);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(r.Form.Item,(0,o.Z)((0,o.Z)({},n),{},{className:"col-span-4 mb-0",name:[t,"first"],children:(0,I.jsx)(x.Z,{placeholder:"Firstname"})})),(0,I.jsx)(r.Form.Item,(0,o.Z)((0,o.Z)({},n),{},{className:"col-span-4 mb-0",name:[t,"last"],children:(0,I.jsx)(x.Z,{placeholder:"Lastname"})})),(0,I.jsx)(r.Form.Item,{noStyle:!0,className:"col-span-4 mb-0",name:[t,"Id"]}),(0,I.jsx)("button",{type:"button",className:"bg-[#FFE2E5] text-[#F64E60] hover:bg-red-200 rounded-md py-1 px-3 disabled:bg-gray-100  transition-all",onClick:De,children:(0,I.jsx)(j.Z,{})})]})}))}):null,(0,I.jsx)(r.Form.Item,{className:"col-span-12 mb-5",children:(0,I.jsx)(r.Button,{className:"w-full flex justify-center",onClick:Fe,block:!0,disabled:t("PersonCount")>=3e3,icon:(0,I.jsx)(b.Z,{}),children:"Add new person"})})]})}})}})})}],Se=[{label:"Name",name:"Name",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{}},{type:"component",component:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(r.Form.Item,{label:"Start Date",className:"col-span-12 mb-2",children:(0,I.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,I.jsx)(r.Form.Item,{name:"StartDate",className:"mb-0 col-span-5",children:(0,I.jsx)(m.Z,{className:"w-full",onChange:function(e,t){ge(t,"IN"),ue.setFieldValue("InScheduleId",null)}})}),(0,I.jsx)(r.Form.Item,{name:"InScheduleId",className:"mb-0 col-span-7",rules:[{required:!0,message:"Flight is required"}],children:(0,I.jsx)(h.Z,{options:ee,className:"w-full",popupMatchSelectWidth:!1,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})})]})})})},{type:"component",component:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(r.Form.Item,{label:"End Date",className:"col-span-12 mb-2",children:(0,I.jsxs)("div",{className:"grid grid-cols-12 gap-2",children:[(0,I.jsx)(r.Form.Item,{name:"EndDate",className:"mb-0 col-span-5",children:(0,I.jsx)(m.Z,{className:"w-full",onChange:function(e,t){Ne(t,"OUT"),ue.setFieldValue("OutScheduleId",null)}})}),(0,I.jsx)(r.Form.Item,{name:"OutScheduleId",className:"mb-0 col-span-7",rules:[{required:!0,message:"Flight is required"}],children:(0,I.jsx)(h.Z,{options:le,className:"w-full",popupMatchSelectWidth:!1,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})})]})})})},{label:"Head Count",name:"HeadCount",className:"col-span-12 mb-2",rules:[{required:!0,message:"Head Count is required"}],type:"number",inputprops:{min:1,max:100}}],Ie=function(){Q(!1)};return(0,I.jsxs)("div",{children:[(0,I.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,I.jsx)("div",{className:"text-lg font-bold mb-2",children:Y}),(0,I.jsx)(r.Form,{form:pe,fields:[{label:"Name",name:"Name",className:"col-span-3 mb-2"},{label:"Start Date",name:"StartDate",type:"date",className:"col-span-3 2xl:col-span-2 mb-2"},{label:"End Date",name:"EndDate",type:"date",className:"col-span-3 2xl:col-span-2 mb-2"}],className:"flex gap-x-8",onFinish:ve,noLayoutConfig:!0,children:(0,I.jsx)("div",{className:"flex gap-4 items-baseline col-span-1",children:(0,I.jsx)(r.Button,{htmlType:"submit",className:"flex items-center",loading:O,icon:(0,I.jsx)(v.Z,{}),children:"Search"})})})]}),(0,I.jsx)(r.Table,{data:F,columns:be,allowColumnReordering:!1,loading:O,keyExpr:"Id",onRowDblClick:function(e){return fe("/tas/seatblock/".concat(e.data.Id))},pager:F>20,tableClass:"border-t max-h-[calc(100vh-282px)]",title:(0,I.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,I.jsxs)("div",{className:"flex items-center gap-1",children:[(0,I.jsx)("span",{className:"font-bold",children:F.length}),(0,I.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,I.jsxs)(r.Button,{icon:(0,I.jsx)(b.Z,{}),onClick:function(){P(null),ue.resetFields(),Q(!0)},children:["Add ",Y]})]})}),(0,I.jsx)(r.Modal,{open:J,onCancel:function(){return Q(!1)},title:E?"Edit ".concat(Y):"Add ".concat(Y),width:700,children:(0,I.jsx)(r.Form,{form:ue,fields:E?Se:Ce,initValues:{people:[]},onFinish:function(e){_(!0),E?(0,f.Z)({method:"put",url:"tas/visitevent",data:(0,o.Z)((0,o.Z)({},e),{},{StartDate:D()(e.StartDate).format("YYYY-MM-DD"),EndDate:D()(e.EndDate).format("YYYY-MM-DD"),Id:E.Id})}).then((function(e){je(),Ie()})).catch((function(e){})).then((function(){return _(!1)})):(0,f.Z)({method:"post",url:"tas/visitevent",data:(0,o.Z)((0,o.Z)({},e),{},{HeadCount:e.people.length,StartDate:D()(e.StartDate).format("YYYY-MM-DD"),EndDate:D()(e.EndDate).format("YYYY-MM-DD")})}).then((function(e){je(),Ie()})).catch((function(e){})).then((function(){return _(!1)}))},labelCol:{xs:{span:24},sm:{span:4}},children:(0,I.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,I.jsx)(r.Button,{type:"primary",onClick:function(){return ue.submit()},loading:G,icon:(0,I.jsx)(g.Z,{}),disabled:0===(null===me||void 0===me||null===(e=me.people)||void 0===e?void 0:e.length),children:"Save"}),(0,I.jsx)(r.Button,{onClick:Ie,disabled:G,children:"Cancel"})]})})}),(0,I.jsxs)(i.GI,{visible:R,showTitle:!1,height:110,width:350,children:[(0,I.jsxs)("div",{children:["Are you sure you want to ",1===(null===E||void 0===E?void 0:E.Active)?"deactivate":"reactivate"," this record?"]}),(0,I.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,I.jsx)(r.Button,{type:1===(null===E||void 0===E?void 0:E.Active)?"danger":"success",onClick:function(){_(!0),(0,f.Z)({method:"delete",url:"tas/visitevent",data:{id:E.Id}}).then((function(){je(),T(!1)})).catch((function(e){})).then((function(){return _(!1)}))},loading:G,children:"Yes"}),(0,I.jsx)(r.Button,{onClick:function(){return T(!1)},disabled:G,children:"No"})]})]})]})}},24654:function(){}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[3795],{33795:function(e,n,t){t.r(n);var l=t(74165),o=t(15861),s=t(29439),a=t(56573),i=t(2880),c=t(42614),d=t(14261),r=t(47313),u=t(81514),p=t(65040),m=t(12998),h=t(29074),f=t(40765),x=t(6986),v=t(22231),b=t(10658),j=t.n(b),w=t(76738),Z=t(46417);n.default=function(){var e,n,t,b,g,C=(0,r.useState)([]),y=(0,s.Z)(C,2),N=y[0],R=y[1],k=(0,r.useState)([]),S=(0,s.Z)(k,2),F=S[0],A=S[1],B=(0,r.useState)(!1),D=(0,s.Z)(B,2),E=D[0],U=D[1],T=(0,r.useState)(!1),L=(0,s.Z)(T,2),Y=L[0],I=L[1],_=(0,r.useState)([]),M=(0,s.Z)(_,2),P=M[0],O=M[1],q=(0,r.useState)(!1),K=(0,s.Z)(q,2),V=K[0],z=K[1],G=(0,r.useState)(!1),J=(0,s.Z)(G,2),H=J[0],Q=J[1],W=(0,r.useState)(!1),X=(0,s.Z)(W,2),$=X[0],ee=X[1],ne=(0,r.useState)(null),te=(0,s.Z)(ne,2),le=te[0],oe=te[1],se=(0,r.useState)(null),ae=(0,s.Z)(se,2),ie=ae[0],ce=ae[1],de=(0,r.useState)(!1),re=(0,s.Z)(de,2),ue=re[0],pe=re[1],me=(0,r.useState)(!1),he=(0,s.Z)(me,2),fe=he[0],xe=he[1],ve=(0,r.useState)(null),be=(0,s.Z)(ve,2),je=be[0],we=be[1],Ze=(0,r.useState)(!1),ge=(0,s.Z)(Ze,2),Ce=ge[0],ye=ge[1],Ne=(0,r.useState)(!1),Re=(0,s.Z)(Ne,2),ke=Re[0],Se=Re[1],Fe=(0,r.useState)(null),Ae=(0,s.Z)(Fe,2),Be=Ae[0],De=Ae[1],Ee=(0,r.useState)(null),Ue=(0,s.Z)(Ee,2),Te=Ue[0],Le=Ue[1],Ye=(0,r.useContext)(c.V).state,Ie=p.Z.useForm(),_e=(0,s.Z)(Ie,1)[0],Me=m.ZP.useNotification(),Pe=(0,s.Z)(Me,2),Oe=Pe[0],qe=Pe[1];(0,r.useEffect)((function(){Ke()}),[_e]);var Ke=function(){U(!0),(0,a.Z)({method:"get",url:"tas/costcode"}).then((function(e){if(R(e.data),_e.getFieldValue("Active")){var n=e.data.filter((function(e){return 1===e.Active}));A(n)}else A(e.data)})).catch((function(e){})).then((function(){return U(!1)}))},Ve=[{label:"Code",name:"Code",width:"80px"},{label:"Number",name:"Number",width:"200px"},{label:"Description",name:"Description"},{label:"# Resource",name:"EmployeeCount",alignment:"left",cellRender:function(e){return e.value>0?(0,Z.jsx)("button",{onClick:function(){return n=e.data,we(n),void xe(!0);var n},className:"text-blue-400 hover:underline",children:e.value}):(0,Z.jsx)("span",{children:e.value})}},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,Z.jsx)(d.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}}],ze=[{label:"Excel Row Index",name:"ExcelRowIndex",alignment:"left",width:"120px"},{label:"Error",name:"Error",alignment:"left"}];return(0,Z.jsxs)("div",{children:[(0,Z.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,Z.jsx)("div",{className:"text-lg font-bold mb-2",children:"Bulk Cost Code"}),(0,Z.jsx)(i.Form,{form:_e,fields:[{label:"Code",name:"Code",className:"col-span-3 mb-2",inputprops:{maxLength:20}},{label:"Number",name:"Number",className:"col-span-3 mb-2"},{label:"Description",name:"Description",className:"col-span-3 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],className:"grid grid-cols-12 gap-x-8",onFinish:function(e){I(!0),(0,u.Z)(e,N).then((function(e){A(e),I(!1)}))},noLayoutConfig:!0,children:(0,Z.jsx)("div",{className:"col-span-1 flex items-baseline",children:(0,Z.jsx)(i.Button,{htmlType:"submit",loading:Y,icon:(0,Z.jsx)(f.Z,{}),children:"Search"})})})]}),(0,Z.jsx)(i.Table,{dataSource:F,columns:Ve,showRowLines:!0,keyExpr:"Id",selection:{mode:"multiple",recursive:!1,showCheckBoxesMode:"always",selectAllMode:"page"},selectedRowKeys:P,onSelectionChanged:function(e){O(e.selectedRowKeys)},onEditorPreparing:function(e){var n;null!==(n=Ye.userInfo)&&void 0!==n&&n.ReadonlyAccess},autoExpandAll:!0,loading:E,tableClass:"max-h-[calc(100vh-250px)]",title:null!==(e=Ye.userInfo)&&void 0!==e&&e.ReadonlyAccess?"":(0,Z.jsxs)("div",{className:"flex justify-between py-2 gap-3 border-b",children:[(0,Z.jsxs)("div",{className:"ml-2",children:[(0,Z.jsx)("span",{className:"font-bold",children:P.length})," people selected"]}),(0,Z.jsxs)("div",{className:"flex gap-3",children:[(0,Z.jsxs)(i.Button,{disabled:0===P.length,icon:(0,Z.jsx)(x.Z,{}),onClick:function(){z(!0),(0,a.Z)({method:"post",url:"tas/costcode/bulkrequest",responseType:"blob",data:{costCodeIds:P}}).then(function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){var t,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.URL.createObjectURL(new Blob([n.data]));case 2:return t=e.sent,o="TAS_CostCode_Bulk_Download_".concat(j()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),e.next=6,document.createElement("a");case 6:return(s=e.sent).href=t,e.next=10,s.setAttribute("download",o);case 10:return e.next=12,document.body.appendChild(s);case 12:return e.next=14,s.click();case 14:return e.next=16,z(!1);case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){z(!1)}))},loading:V,children:["Download",P.length>0?" (".concat(P.length,")"):""]}),(0,Z.jsx)(i.FileUploader,{icon:(0,Z.jsx)(v.Z,{}),onChange:function(e){if((0,w.Z)(e)){ce(e),Q(!0);var n=new FormData;n.append("BulkCostCodeFile",e),e&&(0,a.Z)({method:"post",url:"tas/costcode/bulkuploadpreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){oe(e.data),ee(!0)})).catch((function(e){})).then((function(){return Q(!1)}))}else Oe.error({message:"Error",placement:"top",duration:5,description:(0,Z.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx",loading:H,children:"Upload"}),(0,Z.jsx)(i.FileUploader,{icon:(0,Z.jsx)(v.Z,{}),onChange:function(e){if((0,w.Z)(e)){Le(e),Se(!0);var n=new FormData;n.append("BulkCostCodeFile",e),e&&(0,a.Z)({method:"post",url:"tas/costcode/bulkuploademployeespreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){De(e.data),pe(!0)})).catch((function(e){})).then((function(){return Se(!1)}))}else Oe.error({message:"Error",placement:"top",duration:0,description:(0,Z.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx",loading:ke,children:"Upload Employees"})]})]})}),(0,Z.jsxs)(i.Modal,{title:"Uploaded",open:$,onCancel:function(){return ee(!1)},children:[(0,Z.jsxs)("div",{className:"mt-5 text-xs",children:[(0,Z.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,Z.jsxs)("div",{className:"col-span-4 text-green-500",children:["Added Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",color:"green",children:null===le||void 0===le?void 0:le.AddRow})]}),(0,Z.jsxs)("div",{className:"col-span-4 text-blue-400",children:["Updated Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",color:"blue",children:null===le||void 0===le?void 0:le.UpdateRow})]}),(0,Z.jsxs)("div",{className:"col-span-4 text-red-500",children:["Deactivated Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",color:"red",children:null===le||void 0===le?void 0:le.DeleteRow})]}),(0,Z.jsxs)("div",{className:"col-span-4",children:["Failed Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",children:null===le||void 0===le||null===(n=le.FailedRows)||void 0===n?void 0:n.length})]}),(0,Z.jsxs)("div",{className:"col-span-4",children:["None Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",children:null===le||void 0===le?void 0:le.NoneRow})]})]}),(null===le||void 0===le||null===(t=le.FailedRows)||void 0===t?void 0:t.length)>0&&(0,Z.jsx)(i.Table,{columns:ze,data:null===le||void 0===le?void 0:le.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,Z.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,Z.jsx)(i.Button,{type:"primary",loading:H,onClick:function(){return function(){Q(!0);var e=new FormData;e.append("BulkCostCodeFile",ie),ie&&(0,a.Z)({method:"post",url:"tas/costcode/bulkupload",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){ee(!1),ce(null),Ke()})).catch((function(e){})).then((function(){return Q(!1)}))}()},children:"Process"}),(0,Z.jsx)(i.Button,{onClick:function(){ee(!1),ce(null)},disabled:H,children:"Cancel"})]})]}),(0,Z.jsxs)(i.Modal,{title:"Uploaded Employee",open:ue,onCancel:function(){return pe(!1)},children:[(0,Z.jsxs)("div",{className:"mt-5 text-xs",children:[(0,Z.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,Z.jsxs)("div",{className:"col-span-4 text-blue-400",children:["Updated Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",color:"blue",children:null===Be||void 0===Be?void 0:Be.UpdateRow})]}),(0,Z.jsxs)("div",{className:"col-span-4",children:["Failed Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",children:null===Be||void 0===Be||null===(b=Be.FailedRows)||void 0===b?void 0:b.length})]}),(0,Z.jsxs)("div",{className:"col-span-4",children:["None Row: ",(0,Z.jsx)(h.Z,{className:"ml-1",children:null===Be||void 0===Be?void 0:Be.NoneRow})]})]}),(null===Be||void 0===Be||null===(g=Be.FailedRows)||void 0===g?void 0:g.length)>0&&(0,Z.jsx)(i.Table,{columns:ze,data:null===Be||void 0===Be?void 0:Be.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,Z.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,Z.jsx)(i.Button,{type:"primary",loading:H,onClick:function(){return function(){Q(!0);var e=new FormData;e.append("BulkCostCodeFile",Te),Te&&(0,a.Z)({method:"post",url:"tas/costcode/bulkuploademployees",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){pe(!1),Le(null),Ke()})).catch((function(e){})).then((function(){return Q(!1)}))}()},children:"Process"}),(0,Z.jsx)(i.Button,{onClick:function(){pe(!1),Le(null)},disabled:H,children:"Cancel"})]})]}),(0,Z.jsx)(d.GI,{visible:fe,showTitle:!1,height:"auto",width:350,children:(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{children:"Are you sure you want to download this record data?"}),(0,Z.jsxs)("div",{className:"flex gap-5 mt-3 justify-center",children:[(0,Z.jsx)(i.Button,{type:"success",onClick:function(){ye(!0),(0,a.Z)({method:"post",url:"tas/costcode/bulkrequestemployees",responseType:"blob",data:{costCodeId:je.Id}}).then(function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){var t,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.URL.createObjectURL(new Blob([n.data]));case 2:return t=e.sent,o="TAS_".concat(je.Description,"_Employees_").concat(j()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),e.next=6,document.createElement("a");case 6:return(s=e.sent).href=t,e.next=10,s.setAttribute("download",o);case 10:return e.next=12,document.body.appendChild(s);case 12:return e.next=14,s.click();case 14:xe(!1);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){})).then((function(){ye(!1)}))},loading:Ce,children:"Yes"}),(0,Z.jsx)(i.Button,{onClick:function(){return xe(!1)},disabled:Ce,children:"No"})]})]})}),qe]})}},81514:function(e,n,t){t.d(n,{Z:function(){return i}});var l=t(93433),o=t(4942),s=t(1413);var a=function e(n,t,l){var a=[],i=Object.keys(t);return n.map((function(n){if(n[l].length>0)a.push((0,s.Z)((0,s.Z)({},n),{},(0,o.Z)({},l,e(n[l],t,l))));else{var c=!1;i.map((function(e){var l,o;""!==t[e]&&"undefined"!==typeof t[e]&&null!==t[e]?c="string"===typeof t[e]?c||(null===(l=n[e])||void 0===l?void 0:l.toLowerCase().includes(null===(o=t[e])||void 0===o?void 0:o.toLowerCase())):c||n[e]===t[e]:c=!0})),c&&a.push(n)}})),a};function i(e,n,t,o){return"tree"===t?a(n,e,o):new Promise((function(t,o){var s=Object.keys(e),a=(0,l.Z)(n);s.map((function(n){""!==e[n]&&"undefined"!==typeof e[n]&&null!==e[n]&&(a="string"===typeof e[n]?a.filter((function(t){var l,o;return null===(l=t[n])||void 0===l?void 0:l.toLowerCase().includes(null===(o=e[n])||void 0===o?void 0:o.toLowerCase())})):a.filter((function(t){return t[n]===e[n]})))})),t(a)}))}},76738:function(e,n){var t=["text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];n.Z=function(e){return!!t.includes(e.type)}}}]);
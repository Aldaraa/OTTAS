"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[2245],{52245:function(e,t,n){n.r(t);var a=n(74165),l=n(15861),o=n(1413),r=n(29439),s=n(2880),i=n(14261),c=n(47313),u=n(65040),d=n(74294),m=n(56573),p=n(40765),f=n(92350),h=n(69888),x=n(42614),v=n(10658),b=n.n(v),g=n(2135),D=n(46417),y="Delegation",j={Code:"",Number:"",Description:"",Active:1};t.default=function(){var e=(0,c.useState)([]),t=(0,r.Z)(e,2),n=t[0],v=t[1],E=(0,c.useState)(null),I=(0,r.Z)(E,2),N=I[0],Y=I[1],Z=(0,c.useState)(!1),F=(0,r.Z)(Z,2),S=F[0],w=F[1],C=(0,c.useState)(!1),M=(0,r.Z)(C,2),k=M[0],q=M[1],R=(0,c.useState)(!1),A=(0,r.Z)(R,2),T=A[0],B=A[1],L=(0,c.useState)([]),V=(0,r.Z)(L,2),_=V[0],O=V[1],z=(0,c.useState)(!1),U=(0,r.Z)(z,2),G=U[0],K=U[1],H=(0,c.useState)(!1),J=(0,r.Z)(H,2),P=J[0],Q=J[1],W=u.Z.useForm(),X=(0,r.Z)(W,1)[0],$=(0,c.useContext)(x.V),ee=$.action,te=$.state,ne=(0,c.useRef)(null);(0,c.useEffect)((function(){ee.changeMenuKey("/tas/costcode"),ae(),le()}),[ee]);var ae=function(){w(!0),(0,m.Z)({method:"get",url:"tas/requestdelegate"}).then((function(e){v(e.data)})).catch((function(e){})).then((function(){return w(!1)}))},le=function(){(0,m.Z)({method:"get",url:"tas/requestgroupemployee/linemanageradminemployees"}).then((function(e){var t=[];e.data.map((function(e){t.push({value:e.EmployeeId,label:"#".concat(e.EmployeeId," ").concat(e.FullName)})})),O(t)})).catch((function(e){}))},oe=[{label:"From Date",name:"StartDate",cellRender:function(e){var t=e.value;return(0,D.jsx)("div",{children:t?b()(t).format("YYYY-MM-DD"):null})}},{label:"To Date",name:"EndDate",cellRender:function(e){var t=e.value;return(0,D.jsx)("div",{children:t?b()(t).format("YYYY-MM-DD"):null})}},{label:"#",name:"fromEmployeeId",dataType:"string",width:80,cellRender:function(e){return(0,D.jsx)("div",{className:"flex items-center text-blue-500 hover:underline",children:(0,D.jsx)(g.Link,{to:"/tas/people/search/".concat(e.value),target:"_blank",children:e.value})})}},{label:"Delegate From",name:"fromEmployeeFullname"},{label:"#",name:"toEmployeeId",dataType:"string",width:80,cellRender:function(e){return(0,D.jsx)("div",{className:"flex items-center text-blue-500 hover:underline",children:(0,D.jsx)(g.Link,{to:"/tas/people/search/".concat(e.value),target:"_blank",children:e.value})})}},{label:"Delegate To",name:"toEmployeeFullname",alignment:"left"},{label:"",name:"action",width:"170px",cellRender:function(e){return(0,D.jsx)("div",{className:"flex justify-end gap-4",children:"DepartmentAdmin"!==te.userInfo.Role&&"DepartmentManager"!==te.userInfo.Role?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,Y(t),void K(!0);var t},children:"Edit"}),(0,D.jsx)("button",{type:"button",className:"dlt-button",onClick:function(){return t=e.data,Y(t),void q(!0);var t},children:"Remove"})]}):null})}}],re=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(t){var n,l,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(t),l=[],n.map((function(e){t[e]&&(e.includes("Date")?l.push("".concat(e,"=").concat(b()(t[e]).format("YYYY-MM-DD"))):l.push("".concat(e,"=").concat(t[e])))})),o="",l.map((function(e,t){o+=0===t?"?".concat(e):"&".concat(e)})),B(!0),(0,m.Z)({method:"get",url:"tas/requestdelegate".concat(o)}).then((function(e){v(e.data)})).then((function(){B(!1)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=[{type:"component",component:(0,D.jsx)(s.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.toEmployeeId!==t.toEmployeeId},children:function(e){var t=e.getFieldValue;return(0,D.jsx)(s.Form.Item,{name:"fromEmployeeId",label:"Delegate From",rules:[{required:!0,message:"Delegate From is required"}],className:"col-span-12 mb-2",children:(0,D.jsx)(d.Z,{showSearch:!0,allowClear:!0,disabled:("DepartmentAdmin"===te.userInfo.Role||"DepartmentManager"===te.userInfo.Role)&&!N,options:_.filter((function(e){return e.value!==t("toEmployeeId")})),filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})})}})},{type:"component",component:(0,D.jsx)(s.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.fromEmployeeId!==t.fromEmployeeId},children:function(e){var t=e.getFieldValue;return(0,D.jsx)(s.Form.Item,{name:"toEmployeeId",label:"Delegate To",rules:[{required:!0,message:"Delegate To is required"}],className:"col-span-12 mb-2",children:(0,D.jsx)(d.Z,{showSearch:!0,allowClear:!0,options:_.filter((function(e){return e.value!==t("fromEmployeeId")})),filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})})}})},{label:"Start Date",name:"StartDate",className:"col-span-12 mb-2",type:"date",rules:[{required:!0,message:"Start Date is required"}]},{label:"End Date",name:"EndDate",className:"col-span-12 mb-2",type:"date",rules:[{required:!0,message:"End Date is required"}]}],ie=[{label:"Delegate From",name:"fromEmployeeId",className:"col-span-6 mb-2",type:"select",inputprops:{options:_}},{label:"Delegate To",name:"toEmployeeId",className:"col-span-6 mb-2",type:"select",inputprops:{options:_}},{label:"Start Date",name:"StartDate",className:"col-span-6 mb-2",type:"date"},{label:"End Date",name:"EndDate",className:"col-span-6 mb-2",type:"date"}];return(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{className:"rounded-ot bg-white py-2 px-3 mb-5 shadow-md",children:[(0,D.jsx)("div",{className:"text-lg font-bold mb-3",children:y}),(0,D.jsx)("div",{className:"w-[750px]",children:(0,D.jsx)(s.Form,{fields:ie,size:"small",className:"grid grid-cols-12 gap-x-5",onFinish:re,labelCol:{flex:"95px"},children:(0,D.jsx)("div",{className:"flex gap-4 justify-end col-span-12",children:(0,D.jsx)(s.Button,{htmlType:"submit",className:"flex items-center",loading:T,icon:(0,D.jsx)(p.Z,{}),children:"Search"})})})})]}),(0,D.jsx)(s.Table,{ref:ne,data:n,columns:oe,allowColumnReordering:!1,loading:S,keyExpr:"Id",title:(0,D.jsxs)("div",{className:"flex justify-between py-2 px-1 border-b",children:[(0,D.jsxs)("div",{className:"flex items-center gap-1",children:[(0,D.jsx)("span",{className:"font-bold",children:n.length}),(0,D.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,D.jsx)(s.Button,{onClick:function(){Y(null),"DepartmentAdmin"!==te.userInfo.Role&&"DepartmentManager"!==te.userInfo.Role||X.setFieldValue("fromEmployeeId",te.userInfo.Id),K(!0)},children:"Add"})]})}),(0,D.jsx)(s.Modal,{open:G,onCancel:function(){return K(!1)},title:N?"Edit ".concat(y):"Add ".concat(y),children:(0,D.jsx)(s.Form,{form:X,fields:se,editData:N,onFinish:function(e){Q(!0),N?(0,m.Z)({method:"put",url:"tas/requestdelegate",data:(0,o.Z)((0,o.Z)({},e),{},{StartDate:b()(e.StartDate).format("YYYY-MM-DD"),EndDate:b()(e.EndDate).format("YYYY-MM-DD"),Active:e.Active?1:0,Id:N.Id})}).then((function(e){ae(),X.resetFields(),Y(null),X.setFieldsValue(j),K(!1)})).catch((function(e){})).then((function(){return Q(!1)})):(0,m.Z)({method:"post",url:"tas/requestdelegate",data:(0,o.Z)((0,o.Z)({},e),{},{Active:e.Active?1:0,StartDate:b()(e.StartDate).format("YYYY-MM-DD"),EndDate:b()(e.EndDate).format("YYYY-MM-DD")})}).then((function(e){ae(),X.resetFields(),X.setFieldsValue(j),K(!1)})).catch((function(e){})).then((function(){return Q(!1)}))},children:(0,D.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,D.jsx)(s.Button,{type:"primary",onClick:function(){return X.submit()},loading:P,icon:(0,D.jsx)(f.Z,{}),children:"Save"}),(0,D.jsx)(s.Button,{onClick:function(){return K(!1)},disabled:P,children:"Cancel"})]})})}),(0,D.jsxs)(i.GI,{visible:k,showTitle:!1,height:"auto",width:"auto",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)(h.Z,{style:{fontSize:"24px",color:"#F64E60"}}),(0,D.jsx)("div",{children:"Are you sure you want to remove this record?"})]}),(0,D.jsxs)("div",{className:"flex gap-5 mt-3 justify-center",children:[(0,D.jsx)(s.Button,{type:"danger",onClick:function(){Q(!0),(0,m.Z)({method:"delete",url:"tas/requestdelegate/".concat(N.Id)}).then((function(){ae(),q(!1)})).catch((function(e){})).then((function(){return Q(!1)}))},children:"Yes"}),(0,D.jsx)(s.Button,{onClick:function(){return q(!1)},children:"No"})]})]})]})}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[8669],{48669:function(t,e,a){a.r(e);var n=a(1413),l=a(29439),i=a(2880),o=a(47313),s=a(65040),c=a(56573),u=a(23495),r=a(58467),d=a(42614),h=a(46417),f=[{label:"Code",name:"Code",className:"col-span-12 mb-2",inputprops:{maxLength:10}},{label:"Description",name:"Description",className:"col-span-12 mb-2"},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{indeterminatewith:!0}}];e.default=function(){var t,e=(0,o.useState)(null),a=(0,l.Z)(e,2),p=a[0],m=a[1],g=(0,o.useState)(null),b=(0,l.Z)(g,2),x=b[0],v=b[1],C=(0,o.useState)(!1),S=(0,l.Z)(C,2),k=S[0],Z=S[1],w=(0,o.useState)([]),j=(0,l.Z)(w,2),y=j[0],D=j[1],N=(0,o.useState)(!1),E=(0,l.Z)(N,2),I=E[0],B=E[1],F=(0,o.useState)(!1),A=(0,l.Z)(F,2),z=A[0],G=A[1],M=(0,o.useState)(!1),P=(0,l.Z)(M,2),R=P[0],T=P[1],L=s.Z.useForm(),O=(0,l.Z)(L,1)[0],U=s.Z.useForm(),_=(0,l.Z)(U,1)[0],q=(0,r.UO)().groupId,K=(0,r.s0)(),V=(0,o.useContext)(d.V),H=V.action,J=V.state,Q=(0,o.useRef)(null);(0,o.useEffect)((function(){H.changeMenuKey("/tas/transportgroup"),W(),X()}),[]);var W=function(){Z(!0),(0,c.Z)({method:"get",url:"tas/FlightGroupmaster/".concat(q)}).then((function(t){m(t.data),v(t.data.Detail)})).catch((function(t){})).then((function(){return Z(!1)}))},X=function(){(0,c.Z)({method:"get",url:"tas/cluster?Active=1"}).then((function(t){var e=[];t.data.map((function(t){e.push((0,n.Z)({value:t.Id,label:"".concat(t.Code," - ").concat(t.Description)},t))})),D(e)})).catch((function(t){}))},Y=(0,o.useCallback)((function(t){var e,a;return{store:y,filter:t.data?[["DayNum","=",null===(e=t.data)||void 0===e?void 0:e.DayNum],["Direction","=",null===(a=t.data)||void 0===a?void 0:a.Direction]]:null}}),[y]),$=(0,o.useCallback)((function(t){G(t),B(!0)}),[]),tt=[{label:"Shift",name:"ShiftId",type:"select",className:"col-span-12 mb-2",inputprops:{options:null===(t=J.referData)||void 0===t?void 0:t.roomStatuses}}],et=(0,o.useMemo)((function(){return[{label:"#",name:"Id",width:"100px",allowEditing:!1},{label:"Day",name:"DayNum",allowEditing:!1},{label:"Direction",name:"Direction",allowEditing:!1},{label:"Shift",name:"ShiftCode",alignment:"left",allowEditing:!1},{label:"Cluster",name:"ClusterId",haveLookup:{dataSource:function(t){return Y(t)},valueExpr:"value",displayExpr:"label",allowClearing:!0}},{label:"",name:"action",width:"170px",alignment:"center",cellRender:function(t){return(0,h.jsx)("button",{className:"edit-button",onClick:function(){return $(t.data)},children:"Change Shift"})}}]}),[y]),at=(0,o.useCallback)((function(t){var e=[];t.changes.map((function(t){e.push({flightGroupDetailId:t.key,clusterId:t.data.ClusterId})})),(0,c.Z)({method:"post",url:"tas/flightgroupdetail/setcluster",data:{request:e}}).then((function(t){})).catch((function(t){}))}),[]),nt=(0,o.useCallback)((function(){B(!1)}),[]),lt=(0,o.useCallback)((function(t){T(!0),(0,c.Z)({method:"put",url:"tas/flightgroupdetail/shift",data:(0,n.Z)((0,n.Z)({},t),{},{id:z.Id})}).then((function(t){W(),nt()})).catch((function(t){})).finally((function(){return T(!1)}))}),[z]),it=(0,o.useCallback)((function(t){t.editorOptions.showClearButton=!0}),[]);return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,h.jsx)("div",{className:"text-lg font-bold mb-2",children:"Transport Group Detail"}),(0,h.jsxs)("div",{className:"w-1/3",children:[(0,h.jsx)(i.Form,{form:O,fields:f,editData:p,className:"grid grid-cols-12 gap-x-8",size:"small",disabled:!0}),(0,h.jsx)("div",{className:"flex gap-4 justify-end",children:(0,h.jsx)(i.Button,{onClick:function(){return K(-1)},icon:(0,h.jsx)(u.Z,{}),children:"Back"})})]})]}),(0,h.jsx)(i.Table,{ref:Q,data:x,columns:et,allowColumnReordering:!1,loading:k,keyExpr:"Id",edit:{mode:"batch",allowUpdating:!0,startEditAction:"dblClick"},onEditorPreparing:it,onSaving:at,pager:{showPageSizeSelector:!1,showNavigationButtons:!1},defaultPageSize:100,tableClass:"max-h-[calc(100vh-290px)]"}),(0,h.jsx)(i.Modal,{title:"Change Shift",open:I,onCancel:nt,children:(0,h.jsx)(i.Form,{form:_,fields:tt,editData:z,onFinish:lt,labelCol:{flex:"90px"},children:(0,h.jsxs)("div",{className:"col-span-12 flex gap-3 justify-end",children:[(0,h.jsx)(i.Button,{htmlType:"submit",type:"primary",loading:R,children:"Save"}),(0,h.jsx)(i.Button,{onClick:nt,children:"Cancel"})]})})})]})}}}]);
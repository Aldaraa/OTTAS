"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[2912],{72912:function(e,n,t){t.r(n);var l=t(74165),o=t(15861),a=t(29439),s=t(56573),i=t(2880),c=t(42614),r=t(14261),d=t(47313),u=t(81514),p=t(65040),m=t(12998),h=t(29074),x=t(40765),f=t(6986),v=t(22231),b=t(10658),w=t.n(b),j=t(76738),y=t(46417);n.default=function(){var e,n,t,b,Z,g,N=(0,d.useState)([]),C=(0,a.Z)(N,2),R=C[0],k=C[1],E=(0,d.useState)([]),S=(0,a.Z)(E,2),F=S[0],A=S[1],D=(0,d.useState)(!1),B=(0,a.Z)(D,2),U=B[0],T=B[1],L=(0,d.useState)(!1),Y=(0,a.Z)(L,2),I=Y[0],_=Y[1],M=(0,d.useState)([]),P=(0,a.Z)(M,2),O=P[0],q=P[1],K=(0,d.useState)(!1),V=(0,a.Z)(K,2),z=V[0],G=V[1],J=(0,d.useState)(!1),H=(0,a.Z)(J,2),Q=H[0],W=H[1],X=(0,d.useState)(!1),$=(0,a.Z)(X,2),ee=$[0],ne=$[1],te=(0,d.useState)(null),le=(0,a.Z)(te,2),oe=le[0],ae=le[1],se=(0,d.useState)(null),ie=(0,a.Z)(se,2),ce=ie[0],re=ie[1],de=(0,d.useState)(!1),ue=(0,a.Z)(de,2),pe=ue[0],me=ue[1],he=(0,d.useState)(!1),xe=(0,a.Z)(he,2),fe=xe[0],ve=xe[1],be=(0,d.useState)(null),we=(0,a.Z)(be,2),je=we[0],ye=we[1],Ze=(0,d.useState)(!1),ge=(0,a.Z)(Ze,2),Ne=ge[0],Ce=ge[1],Re=(0,d.useState)(!1),ke=(0,a.Z)(Re,2),Ee=ke[0],Se=ke[1],Fe=(0,d.useState)(null),Ae=(0,a.Z)(Fe,2),De=Ae[0],Be=Ae[1],Ue=(0,d.useState)(null),Te=(0,a.Z)(Ue,2),Le=Te[0],Ye=Te[1],Ie=(0,d.useContext)(c.V),_e=Ie.state,Me=(Ie.action,p.Z.useForm()),Pe=(0,a.Z)(Me,1)[0],Oe=m.ZP.useNotification(),qe=(0,a.Z)(Oe,2),Ke=qe[0],Ve=qe[1];(0,d.useEffect)((function(){ze()}),[]);var ze=function(){T(!0),(0,s.Z)({method:"get",url:"tas/employer"}).then((function(e){if(k(e.data),Pe.getFieldValue("Active")){var n=e.data.filter((function(e){return 1===e.Active}));A(n)}else A(e.data)})).catch((function(e){})).then((function(){return T(!1)}))},Ge=[{label:"Code",name:"Code",width:"80px"},{label:"Description",name:"Description"},{label:"Email",name:"Email"},{label:"# Resource",name:"EmployeeCount",alignment:"left",cellRender:function(e){return e.value>0?(0,y.jsx)("button",{onClick:function(){return n=e.data,ye(n),void me(!0);var n},className:"text-blue-400 hover:underline",children:e.value}):(0,y.jsx)("span",{children:e.value})}},{label:"Active",name:"Active",width:"80px",alignment:"center",cellRender:function(e){return(0,y.jsx)(r.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}}],Je=[{label:"Excel Row Index",name:"ExcelRowIndex",alignment:"left",width:"120px"},{label:"Error",name:"Error",alignment:"left"}];return(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,y.jsx)("div",{className:"text-lg font-bold mb-2",children:"Employer Code"}),(0,y.jsx)(i.Form,{form:Pe,fields:[{label:"Code",name:"Code",className:"col-span-4 xl:col-span-3 2xl:col-span-2 mb-2",inputprops:{maxLength:10}},{label:"Number",name:"Number",className:"col-span-4 xl:col-span-3 2xl:col-span-2 mb-2"},{label:"Description",name:"Description",className:"col-span-4 xl:col-span-3 2xl:col-span-2 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],className:"flex gap-x-8",onFinish:function(e){_(!0),(0,u.Z)(e,R).then((function(e){A(e),_(!1)}))},noLayoutConfig:!0,children:(0,y.jsx)("div",{children:(0,y.jsx)(i.Button,{htmlType:"submit",loading:I,icon:(0,y.jsx)(x.Z,{}),children:"Search"})})})]}),(0,y.jsx)(i.Table,{dataSource:F,id:"room",className:"overflow-hidden max-h-[calc(100vh-250px)] ".concat(!(null!==(e=_e.userInfo)&&void 0!==e&&e.ReadonlyAccess)&&"border-t"),columns:Ge,showRowLines:!0,keyExpr:"Id",selection:{mode:"multiple",recursive:!1,showCheckBoxesMode:"always",allowSelectAll:!0,selectAllMode:"page"},selectedRowKeys:O,rowAlternationEnabled:!1,onSelectionChanged:function(e){q(e.selectedRowKeys)},onEditorPreparing:function(e){var n;null!==(n=_e.userInfo)&&void 0!==n&&n.ReadonlyAccess},autoExpandAll:!0,loading:U,title:null!==(n=_e.userInfo)&&void 0!==n&&n.ReadonlyAccess?"":(0,y.jsxs)("div",{className:"flex justify-between py-2 gap-3 border-b",children:[(0,y.jsxs)("div",{className:"ml-2",children:[(0,y.jsx)("span",{className:"font-bold",children:O.length})," people selected"]}),(0,y.jsxs)("div",{className:"flex gap-3",children:[(0,y.jsxs)(i.Button,{disabled:0===O.length,icon:(0,y.jsx)(f.Z,{}),onClick:function(){G(!0),(0,s.Z)({method:"post",url:"tas/employer/bulkrequest",responseType:"blob",data:{employerIds:O}}).then(function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){var t,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.URL.createObjectURL(new Blob([n.data]));case 2:return t=e.sent,o="TAS_Employer_Bulk_Download_".concat(w()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),e.next=6,document.createElement("a");case 6:return(a=e.sent).href=t,e.next=10,a.setAttribute("download",o);case 10:return e.next=12,document.body.appendChild(a);case 12:return e.next=14,a.click();case 14:return e.next=16,G(!1);case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){G(!1)}))},loading:z,children:["Download",O.length>0?" (".concat(O.length,")"):""]}),(0,y.jsx)(i.FileUploader,{icon:(0,y.jsx)(v.Z,{}),onChange:function(e){if((0,j.Z)(e)){re(e),W(!0);var n=new FormData;n.append("BulkEmployerFile",e),e&&(0,s.Z)({method:"post",url:"tas/employer/bulkuploadpreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){ae(e.data),ne(!0)})).catch((function(e){})).then((function(){return W(!1)}))}else Ke.error({message:"Error",placement:"top",duration:5,description:(0,y.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx",loading:Q,children:"Upload"}),(0,y.jsx)(i.FileUploader,{icon:(0,y.jsx)(v.Z,{}),onChange:function(e){if((0,j.Z)(e)){Ye(e),Se(!0);var n=new FormData;n.append("BulkEmployerFile",e),e&&(0,s.Z)({method:"post",url:"tas/employer/bulkuploademployeespreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){Be(e.data),ve(!0)})).catch((function(e){})).then((function(){return Se(!1)}))}else Ke.error({message:"Error",placement:"top",duration:0,description:(0,y.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx",loading:Ee,children:"Upload Employees"})]})]})}),(0,y.jsxs)(i.Modal,{title:"Uploaded",open:ee,onCancel:function(){return ne(!1)},children:[(0,y.jsxs)("div",{className:"mt-5 text-xs",children:[(0,y.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,y.jsxs)("div",{className:"col-span-4 text-green-500",children:["Added Row: ",(0,y.jsx)(h.Z,{className:"ml-1",color:"green",children:null===oe||void 0===oe?void 0:oe.AddRow})]}),(0,y.jsxs)("div",{className:"col-span-4 text-blue-400",children:["Updated Row: ",(0,y.jsx)(h.Z,{className:"ml-1",color:"blue",children:null===oe||void 0===oe?void 0:oe.UpdateRow})]}),(0,y.jsxs)("div",{className:"col-span-4 text-red-500",children:["Deactivated Row: ",(0,y.jsx)(h.Z,{className:"ml-1",color:"red",children:null===oe||void 0===oe?void 0:oe.DeleteRow})]}),(0,y.jsxs)("div",{className:"col-span-4",children:["Failed Row: ",(0,y.jsx)(h.Z,{className:"ml-1",children:null===oe||void 0===oe||null===(t=oe.FailedRows)||void 0===t?void 0:t.length})]}),(0,y.jsxs)("div",{className:"col-span-4",children:["None Row: ",(0,y.jsx)(h.Z,{className:"ml-1",children:null===oe||void 0===oe?void 0:oe.NoneRow})]})]}),(null===oe||void 0===oe||null===(b=oe.FailedRows)||void 0===b?void 0:b.length)>0&&(0,y.jsx)(i.Table,{columns:Je,data:null===oe||void 0===oe?void 0:oe.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,y.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,y.jsx)(i.Button,{type:"primary",loading:Q,onClick:function(){return function(){W(!0);var e=new FormData;e.append("BulkEmployerFile",ce),ce&&(0,s.Z)({method:"post",url:"tas/employer/bulkupload",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){ne(!1),re(null),Pe.submit()})).catch((function(e){})).then((function(){return W(!1)}))}()},children:"Process"}),(0,y.jsx)(i.Button,{onClick:function(){ne(!1),re(null)},disabled:Q,children:"Cancel"})]})]}),(0,y.jsxs)(i.Modal,{title:"Uploaded Employee",open:fe,onCancel:function(){return ve(!1)},children:[(0,y.jsxs)("div",{className:"mt-5 text-xs",children:[(0,y.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,y.jsxs)("div",{className:"col-span-4 text-blue-400",children:["Updated Row: ",(0,y.jsx)(h.Z,{className:"ml-1",color:"blue",children:null===De||void 0===De?void 0:De.UpdateRow})]}),(0,y.jsxs)("div",{className:"col-span-4",children:["Failed Row: ",(0,y.jsx)(h.Z,{className:"ml-1",children:null===De||void 0===De||null===(Z=De.FailedRows)||void 0===Z?void 0:Z.length})]}),(0,y.jsxs)("div",{className:"col-span-4",children:["None Row: ",(0,y.jsx)(h.Z,{className:"ml-1",children:null===De||void 0===De?void 0:De.NoneRow})]})]}),(null===De||void 0===De||null===(g=De.FailedRows)||void 0===g?void 0:g.length)>0&&(0,y.jsx)(i.Table,{columns:Je,data:null===De||void 0===De?void 0:De.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,y.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,y.jsx)(i.Button,{type:"primary",loading:Q,onClick:function(){return function(){W(!0);var e=new FormData;e.append("BulkEmployerFile",Le),Le&&(0,s.Z)({method:"post",url:"tas/employer/bulkuploademployees",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){ve(!1),Ye(null),Pe.submit(),ze()})).catch((function(e){})).then((function(){return W(!1)}))}()},children:"Process"}),(0,y.jsx)(i.Button,{onClick:function(){ve(!1),Ye(null)},disabled:Q,children:"Cancel"})]})]}),(0,y.jsx)(r.GI,{visible:pe,showTitle:!1,height:"auto",width:350,children:(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{children:"Are you sure you want to download this record data?"}),(0,y.jsxs)("div",{className:"flex gap-5 mt-3 justify-center",children:[(0,y.jsx)(i.Button,{type:"success",onClick:function(){Ce(!0),(0,s.Z)({method:"post",url:"tas/employer/bulkrequestemployees",responseType:"blob",data:{employerId:je.Id}}).then(function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){var t,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.URL.createObjectURL(new Blob([n.data]));case 2:return t=e.sent,o="TAS_".concat(je.Description,"_Employees_").concat(w()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),e.next=6,document.createElement("a");case 6:return(a=e.sent).href=t,e.next=10,a.setAttribute("download",o);case 10:return e.next=12,document.body.appendChild(a);case 12:return e.next=14,a.click();case 14:me(!1);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){})).then((function(){Ce(!1)}))},loading:Ne,children:"Yes"}),(0,y.jsx)(i.Button,{onClick:function(){return me(!1)},disabled:Ne,children:"No"})]})]})}),Ve]})}},81514:function(e,n,t){t.d(n,{Z:function(){return i}});var l=t(93433),o=t(4942),a=t(1413);var s=function e(n,t,l){var s=[],i=Object.keys(t);return n.map((function(n){if(n[l].length>0)s.push((0,a.Z)((0,a.Z)({},n),{},(0,o.Z)({},l,e(n[l],t,l))));else{var c=!1;i.map((function(e){var l,o;""!==t[e]&&"undefined"!==typeof t[e]&&null!==t[e]?c="string"===typeof t[e]?c||(null===(l=n[e])||void 0===l?void 0:l.toLowerCase().includes(null===(o=t[e])||void 0===o?void 0:o.toLowerCase())):c||n[e]===t[e]:c=!0})),c&&s.push(n)}})),s};function i(e,n,t,o){return"tree"===t?s(n,e,o):new Promise((function(t,o){var a=Object.keys(e),s=(0,l.Z)(n);a.map((function(n){""!==e[n]&&"undefined"!==typeof e[n]&&null!==e[n]&&(s="string"===typeof e[n]?s.filter((function(t){var l,o;return null===(l=t[n])||void 0===l?void 0:l.toLowerCase().includes(null===(o=e[n])||void 0===o?void 0:o.toLowerCase())})):s.filter((function(t){return t[n]===e[n]})))})),t(s)}))}},76738:function(e,n){var t=["text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];n.Z=function(e){return!!t.includes(e.type)}}}]);
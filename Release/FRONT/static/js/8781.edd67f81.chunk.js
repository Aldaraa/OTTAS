"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[8781],{98781:function(e,t,n){n.r(t);var a=n(1413),l=n(29439),i=n(2880),r=n(14261),s=n(47313),o=n(65040),c=n(56573),d=n(82138),u=n(40765),m=n(42614),p=n(2135),v=n(46417),h=function(e){switch(e){case 0:return"Subdepartment";case 1:return"OPS responbility";case 2:return"General department";case 3:return"OTUP Grouping";case 4:return"Division"}};t.default=function(){var e,t=(0,s.useState)([]),n=(0,l.Z)(t,2),f=n[0],x=n[1],b=(0,s.useState)(null),N=(0,l.Z)(b,2),g=N[0],j=N[1],y=(0,s.useState)(!1),w=(0,l.Z)(y,2),C=w[0],Z=w[1],D=(0,s.useState)(!1),A=(0,l.Z)(D,2),S=A[0],k=A[1],I=(0,s.useState)("search"),R=(0,l.Z)(I,2),L=R[0],F=R[1],T=(0,s.useState)(!1),E=(0,l.Z)(T,2),P=E[0],B=E[1],q=(0,s.useState)(null),G=(0,l.Z)(q,2),M=G[0],O=G[1],V=(0,s.useState)(!1),_=(0,l.Z)(V,2),z=_[0],J=_[1],K=(0,s.useState)(null),U=(0,l.Z)(K,2),Y=U[0],H=U[1],Q=o.Z.useForm(),W=(0,l.Z)(Q,1)[0],X=o.Z.useForm(),$=(0,l.Z)(X,1)[0],ee=(0,s.useContext)(m.V),te=ee.action,ne=ee.state,ae=(0,s.useRef)(null);(0,s.useEffect)((function(){te.changeMenuKey("/tas/department"),le()}),[]);var le=function(){var e;null===(e=ae.current)||void 0===e||e.instance.beginCustomLoading(),(0,c.Z)({method:"get",url:"tas/department"}).then((function(e){x(e.data)})).catch((function(e){})).then((function(){var e;return null===(e=ae.current)||void 0===e?void 0:e.instance.endCustomLoading()}))},ie=function(){te.changeLoadingStatusReferItem({departments:!0}),(0,c.Z)({method:"get",url:"tas/department?Active=1"}).then((function(e){te.setReferDataItem({departments:e.data})})).catch((function(e){})).then((function(){return te.changeLoadingStatusReferItem({departments:!1})}))},re=function(e){j(e),Z(!0)},se=[{label:"Department Name",name:"Name",width:"auto",cellRender:function(e){return(0,v.jsx)(i.DepartmentTooltip,{trigger:"click",id:e.data.Id,showStatus:!1,children:(0,v.jsx)("span",{className:"text-blue-500 hover:text-blue-400 transition-all cursor-pointer",children:e.value})})}},{label:"Level",name:"level",cellRender:function(e){var t;return(0,v.jsx)("span",{children:h(null===(t=e.row)||void 0===t?void 0:t.level)})}},{label:"Cost Code",name:"CostCodeDescr"},{label:"Admin",name:"Admins"},{label:"Approval",name:"Managers"},{label:"Supervisers",name:"Supervisers"},{label:"# Resource",name:"EmployeeCount"},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,v.jsx)(r.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"action",width:"395px",cellRender:function(e){return(0,v.jsxs)("div",{className:"flex gap-4 justify-end",children:[(0,v.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,H(t),void J(!0);var t},children:"View Audit"}),e.row.level<5?(0,v.jsx)("button",{type:"button",className:"edit-button flex items-center px-2",onClick:function(){return function(e,t){var n;j(null),O((0,a.Z)((0,a.Z)({},e),{},{level:null===t||void 0===t||null===(n=t.row)||void 0===n?void 0:n.level})),B(!0)}(e.data,e)},children:(0,v.jsx)(d.Z,{})}):null,e.data.ParentDepartmentId?(0,v.jsx)("button",{type:"button",className:"edit-button flex items-center gap-2",onClick:function(){return function(e,t){var n;O(null),j((0,a.Z)((0,a.Z)({},e),{},{level:null===t||void 0===t||null===(n=t.row)||void 0===n?void 0:n.level})),B(!0)}(e.data,e)},children:"Edit"}):null,(0,v.jsx)(p.Link,{to:"".concat(e.data.Id),target:"_blank",children:(0,v.jsx)("button",{type:"button",className:"edit-button flex items-center gap-2",children:"View"})}),1===e.data.Active?(0,v.jsx)("button",{type:"button",className:"dlt-button",onClick:function(){return re(e.data)},children:"Deactivate"}):(0,v.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return re(e.data)},children:"Reactivate"})]})}}],oe=[{label:"Department Name",name:"DepartmentName",className:"col-span-3 mb-2",rules:[{required:"edit"===L,message:"Department Name is required"}]},{label:"Related Employees",name:"keyword",className:"col-span-3 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:"edit"!==L}}],ce=[{label:"Parent Department",name:"ParentDepartmentId",className:"col-span-12 mb-2",type:"treeSelect",inputprops:{treeData:null===(e=ne.referData)||void 0===e?void 0:e.departments,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},allowClear:!0,showSearch:!0,filterTreeNode:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.Name)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}}},{label:"Department Name",name:"Name",className:"col-span-12 mb-2",rules:[{required:!0,message:"Department Name is required"}]},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{}}];return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,v.jsx)("div",{className:"text-lg font-bold mb-2",children:"Department"}),(0,v.jsx)(i.Form,{form:W,fields:oe,className:"grid grid-cols-12 lg:gap-x-8",onFinish:function(e){k(!0),(0,c.Z)({method:"get",url:"tas/department?DepartmentName=".concat(e.DepartmentName,"&keyword=").concat(e.keyword)}).then((function(e){x(e.data)})).catch((function(e){})).then((function(){return k(!1)}))},noLayoutConfig:!0,children:(0,v.jsx)("div",{className:"flex gap-4 items-baseline col-span-2",children:(0,v.jsx)(i.Button,{htmlType:"submit",className:"flex items-center",loading:S,icon:(0,v.jsx)(u.Z,{}),children:"Search"})})})]}),(0,v.jsx)(i.TreeTable,{ref:ae,title:(0,v.jsx)("div",{className:"flex items-center justify-end gap-3 bg-white py-2 px-3 rounded-t-ot",children:(0,v.jsx)(i.Button,{onClick:function(){H(null),J(!0)},children:"Audit"})}),dataSource:f,itemsExpr:"ChildDepartments",columns:se,className:"bg-white p-2 pt-0 shadow-md border-t h-[calc(100vh-250px)]",dataStructure:"tree",autoExpandAll:!0,paging:{enabled:!1},pager:{enabled:!1}}),(0,v.jsxs)(r.GI,{visible:C,showTitle:!1,height:110,width:350,children:[(0,v.jsxs)("div",{children:["Are you sure you want to ",1===(null===g||void 0===g?void 0:g.Active)?"deactivate":"reactivate"," this record?"]}),(0,v.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,v.jsx)(i.Button,{type:1===(null===g||void 0===g?void 0:g.Active)?"danger":"success",onClick:function(){(0,c.Z)({method:"delete",url:"tas/department",data:{id:g.Id}}).then((function(){le(),ie(),Z(!1)})).catch((function(e){}))},children:"Yes"}),(0,v.jsx)(i.Button,{onClick:function(){return Z(!1)},children:"No"})]})]}),(0,v.jsxs)(i.Modal,{title:(0,v.jsxs)("div",{children:[M?(0,v.jsxs)("div",{className:"text-gray-500 text-sm",children:["(",h(null===M||void 0===M?void 0:M.level),")"]}):(0,v.jsxs)("div",{className:"text-gray-500 text-sm",children:["(",h(null===g||void 0===g?void 0:g.level),")"]}),(0,v.jsxs)("div",{className:"mr-5 whitespace-pre-wrap",children:[g?"Edit":"Add"," department on ",g?null===g||void 0===g?void 0:g.Name:null===M||void 0===M?void 0:M.Name]})]}),open:P,onCancel:function(){return B(!1)},destroyOnClose:!0,children:[(0,v.jsx)(i.Form,{form:$,fields:ce,editData:g||{ParentDepartmentId:null===M||void 0===M?void 0:M.Id},onFinish:function(e){g?(0,c.Z)({method:"put",url:"tas/department",data:(0,a.Z)((0,a.Z)({},e),{},{Active:e.Active?1:0,Id:null===g||void 0===g?void 0:g.Id})}).then((function(e){le(),ie(),B(!1),F("search"),W.resetFields(),j(null)})).catch((function(e){})):(0,c.Z)({method:"post",url:"tas/department",data:(0,a.Z)((0,a.Z)({},e),{},{ParentDepartmentId:null===M||void 0===M?void 0:M.Id,Active:e.Active?1:0})}).then((function(e){le(),ie(),B(!1),$.resetFields(),O(null)})).catch((function(e){}))},size:"small"}),(0,v.jsxs)("div",{className:"flex gap-5 justify-end",children:[(0,v.jsx)(i.Button,{type:"primary",onClick:function(){return $.submit()},children:"Save"}),(0,v.jsx)(i.Button,{onClick:function(){return B(!1)},children:"Cancel"})]})]}),(0,v.jsx)(i.AuditTable,{title:"Department Audit",tablename:"Department",open:z,onClose:function(){return J(!1)},record:Y,recordName:Y?(0,v.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",Y.Name,"/"]}):""})]})}}}]);
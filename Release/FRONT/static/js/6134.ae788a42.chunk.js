"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[6134],{46134:function(e,n,t){t.r(n);var l=t(29439),a=t(56573),o=t(2880),s=t(42614),i=t(14261),c=t(47313),d=t(81514),r=t(65040),u=t(12998),m=t(29074),p=t(40765),f=t(6986),h=t(22231),v=t(10658),x=t.n(v),b=t(76738),w=t(46417);n.default=function(){var e,n,t,v,j=(0,c.useState)([]),g=(0,l.Z)(j,2),N=g[0],y=g[1],Z=(0,c.useState)([]),R=(0,l.Z)(Z,2),C=R[0],k=R[1],S=(0,c.useState)([]),A=(0,l.Z)(S,2),B=A[0],F=A[1],I=(0,c.useState)([]),T=(0,l.Z)(I,2),D=T[0],E=T[1],P=(0,c.useState)(!1),L=(0,l.Z)(P,2),U=L[0],_=L[1],Y=(0,c.useState)(!1),M=(0,l.Z)(Y,2),O=M[0],z=M[1],V=(0,c.useState)([]),J=(0,l.Z)(V,2),q=J[0],K=J[1],G=(0,c.useState)(!1),H=(0,l.Z)(G,2),Q=H[0],W=H[1],X=(0,c.useState)(!1),$=(0,l.Z)(X,2),ee=$[0],ne=$[1],te=(0,c.useState)(!1),le=(0,l.Z)(te,2),ae=le[0],oe=le[1],se=(0,c.useState)(null),ie=(0,l.Z)(se,2),ce=ie[0],de=ie[1],re=(0,c.useState)(null),ue=(0,l.Z)(re,2),me=ue[0],pe=ue[1],fe=(0,c.useContext)(s.V).state,he=r.Z.useForm(),ve=(0,l.Z)(he,1)[0],xe=u.ZP.useNotification(),be=(0,l.Z)(xe,2),we=be[0],je=be[1];(0,c.useEffect)((function(){ge(),ye(),Ne()}),[]);var ge=function(){_(!0),(0,a.Z)({method:"get",url:"tas/room"}).then((function(e){if(y(e.data),ve.getFieldValue("Active")){var n=e.data.filter((function(e){return 1===e.Active}));k(n)}else k(e.data)})).catch((function(e){})).then((function(){return _(!1)}))},Ne=function(){(0,a.Z)({method:"get",url:"tas/roomtype?Active=1"}).then((function(e){var n=[];e.data.map((function(e){return n.push({label:e.Description,value:e.Id})})),F(n)})).catch((function(e){}))},ye=function(){(0,a.Z)({method:"get",url:"tas/camp?Active=1"}).then((function(e){var n=[];e.data.map((function(e){return n.push({label:e.Description,value:e.Id})})),E(n)})).catch((function(e){}))},Ze=[{label:"Room Number",name:"Number",className:" col-span-6 xl:col-span-3 mb-2"},{label:"Bed Count",name:"BedCount",className:"col-span-6 xl:col-span-2 mb-2",type:"number",inputprops:{className:"w-full"}},{label:"Room Type",name:"RoomTypeId",className:"col-span-6 xl:col-span-3 mb-2",type:"select",inputprops:{options:B}},{label:"Camp",name:"CampId",className:"col-span-6 xl:col-span-4 mb-2",type:"select",inputprops:{options:D}},{label:"Private",name:"Private",className:"col-span-2 xl:col-span-1 mb-2",type:"check",inputprops:{}},{label:"Active",name:"Active",className:"col-span-2 xl:col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}},{label:"No Room",name:"VirtualRoom",className:"col-span-3 lg:col-span-2 mb-2",type:"check",inputprops:{}}],Re=[{label:"Room Number",name:"Number",width:"150px"},{label:"Camp Name",name:"CampName"},{label:"Bed Count",name:"BedCount",width:"80px"},{label:"Room Type",name:"RoomTypeName"},{label:"Private",name:"Private",width:"60px",alignment:"center",cellRender:function(e){return(0,w.jsx)(i.Jg,{disabled:!0,iconSize:18,value:1===e.data.Private||0})}},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,w.jsx)(i.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}}];return(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:(0,w.jsxs)("div",{className:"w-full",children:[(0,w.jsx)("div",{className:"text-lg font-bold mb-2",children:"Bulk Room"}),(0,w.jsx)(o.Form,{form:ve,fields:Ze,className:"grid grid-cols-12 gap-x-8",onFinish:function(e){z(!0),(0,d.Z)(e,N).then((function(e){k(e),z(!1)}))},noLayoutConfig:!0,size:"small",children:(0,w.jsx)("div",{className:"col-span-12 flex justify-end",children:(0,w.jsx)(o.Button,{htmlType:"submit",loading:O,icon:(0,w.jsx)(p.Z,{}),children:"Search"})})})]})}),(0,w.jsx)(o.Table,{dataSource:C,id:"room",columns:Re,showRowLines:!0,keyExpr:"Id",selection:!(null!==(e=fe.userInfo)&&void 0!==e&&e.ReadonlyAccess)&&{mode:"multiple",recursive:!1,showCheckBoxesMode:"always"},onSelectionChanged:function(e){K(e.selectedRowKeys)},onEditorPreparing:function(e){var n;null!==(n=fe.userInfo)&&void 0!==n&&n.ReadonlyAccess&&(e.editorOptions.disabled=!0)},autoExpandAll:!0,loading:U,tableClass:"max-h-[calc(100vh-305px)]",title:null!==(n=fe.userInfo)&&void 0!==n&&n.ReadonlyAccess?"":(0,w.jsxs)("div",{className:"flex justify-between py-2 gap-3 border-b",children:[(0,w.jsxs)("div",{className:"ml-2",children:[(0,w.jsx)("span",{className:"font-bold",children:q.length})," people selected"]}),(0,w.jsxs)("div",{className:"flex gap-3",children:[(0,w.jsx)(o.Button,{disabled:0===q.length,icon:(0,w.jsx)(f.Z,{}),onClick:function(){W(!0),(0,a.Z)({method:"post",url:"tas/room/bulkrequest",responseType:"blob",data:{roomIds:q}}).then((function(e){var n=window.URL.createObjectURL(new Blob([e.data])),t="TAS_Room_Bulk_Download_".concat(x()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),l=document.createElement("a");l.href=n,l.setAttribute("download",t),document.body.appendChild(l),l.click()})).catch((function(e){})).then((function(){return W(!1)}))},loading:Q,children:"Download"}),(0,w.jsx)(o.FileUploader,{icon:(0,w.jsx)(h.Z,{}),onChange:function(e){if((0,b.Z)(e)){ne(!0),pe(e);var n=new FormData;n.append("BulkRoomFile",e),e&&(0,a.Z)({method:"post",url:"tas/room/bulkuploadpreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){de(e.data),oe(!0)})).catch((function(e){})).then((function(){return ne(!1)}))}else we.error({message:"Error",placement:"top",duration:5,description:(0,w.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx",loading:ee,children:"Upload"})]})]})}),(0,w.jsxs)(o.Modal,{title:"Uploaded",open:ae,onCancel:function(){return oe(!1)},children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,w.jsxs)("div",{className:"col-span-6 text-green-500",children:["Added Row: ",(0,w.jsx)(m.Z,{className:"ml-1",color:"green",children:null===ce||void 0===ce?void 0:ce.AddRow})]}),(0,w.jsxs)("div",{className:"col-span-6",children:["None Row: ",(0,w.jsx)(m.Z,{className:"ml-1",children:null===ce||void 0===ce?void 0:ce.NoneRow})]}),(0,w.jsxs)("div",{className:"col-span-6 text-red-500",children:["Deactivated Row: ",(0,w.jsx)(m.Z,{className:"ml-1",color:"red",children:null===ce||void 0===ce?void 0:ce.DeleteRow})]}),(0,w.jsxs)("div",{className:"col-span-6",children:["Failed Row: ",(0,w.jsx)(m.Z,{className:"ml-1",children:null===ce||void 0===ce||null===(t=ce.FailedRows)||void 0===t?void 0:t.length})]}),(0,w.jsxs)("div",{className:"col-span-6 text-blue-400",children:["Updated Row: ",(0,w.jsx)(m.Z,{className:"ml-1",color:"blue",children:null===ce||void 0===ce?void 0:ce.UpdateRow})]})]}),(null===ce||void 0===ce||null===(v=ce.FailedRows)||void 0===v?void 0:v.length)>0&&(0,w.jsx)(o.Table,{columns:[{label:"Excel Row Index",name:"ExcelRowIndex",alignment:"left",width:"120px"},{label:"Error",name:"Error",alignment:"left"}],data:null===ce||void 0===ce?void 0:ce.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,w.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,w.jsx)(o.Button,{type:"primary",loading:ee,onClick:function(){return function(){ne(!0);var e=new FormData;e.append("BulkRoomFile",me),me&&(0,a.Z)({method:"post",url:"tas/room/bulkupload",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){oe(!1),pe(null),ve.submit()})).catch((function(e){})).then((function(){return ne(!1)}))}()},children:"Process"}),(0,w.jsx)(o.Button,{onClick:function(){oe(!1),pe(null)},disabled:ee,children:"Cancel"})]})]}),je]})}},81514:function(e,n,t){t.d(n,{Z:function(){return i}});var l=t(93433),a=t(4942),o=t(1413);var s=function e(n,t,l){var s=[],i=Object.keys(t);return n.map((function(n){if(n[l].length>0)s.push((0,o.Z)((0,o.Z)({},n),{},(0,a.Z)({},l,e(n[l],t,l))));else{var c=!1;i.map((function(e){var l,a;""!==t[e]&&"undefined"!==typeof t[e]&&null!==t[e]?c="string"===typeof t[e]?c||(null===(l=n[e])||void 0===l?void 0:l.toLowerCase().includes(null===(a=t[e])||void 0===a?void 0:a.toLowerCase())):c||n[e]===t[e]:c=!0})),c&&s.push(n)}})),s};function i(e,n,t,a){return"tree"===t?s(n,e,a):new Promise((function(t,a){var o=Object.keys(e),s=(0,l.Z)(n);o.map((function(n){""!==e[n]&&"undefined"!==typeof e[n]&&null!==e[n]&&(s="string"===typeof e[n]?s.filter((function(t){var l,a;return null===(l=t[n])||void 0===l?void 0:l.toLowerCase().includes(null===(a=e[n])||void 0===a?void 0:a.toLowerCase())})):s.filter((function(t){return t[n]===e[n]})))})),t(s)}))}},76738:function(e,n){var t=["text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];n.Z=function(e){return!!t.includes(e.type)}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[3182],{23182:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var a=n(1413),l=n(45987),s=n(29439),r=n(47313),o=n(2880),d=n(56573),c=n(65040),i=n(74294),u=n(93031),m=n(31283),h=n(58467),x=n(42614),p=n(10658),f=n.n(p),b=n(14261),j=n(58821),C=n(18711),v=n(2135),N=n(46417),g=[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,N.jsx)("div",{className:"flex items-center justify-center",children:(0,N.jsx)(v.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,N.jsx)("button",{type:"button",className:"text-blue-600 underline",children:e.value})})})}},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,N.jsx)(C.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname"},{label:"Lastname",name:"Lastname"},{label:"SAP #",name:"SAPID",alignment:"left"},{label:"Department",name:"DepartmentName"},{label:"Employer",name:"EmployerName"},{label:"CostCode",name:"CostCodeName",dataType:"string",cellRender:function(e){return(0,N.jsx)("span",{className:"text-primary2",children:e.value})}},{label:"Roster",name:"RosterName"},{label:"Resource Type",name:"PeopleTypeName"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,N.jsx)("span",{children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,N.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,N.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",cellRender:function(e){return(0,N.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,N.jsx)(j.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",cellRender:function(e,t){return(0,N.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,N.jsx)("i",{className:"dx-icon-home"})}}],Z=["key","name"];var D=function(){var e=(0,h.TH)(),t=(0,r.useState)(!1),n=(0,s.Z)(t,2),p=n[0],b=n[1],j=(0,r.useState)([]),C=(0,s.Z)(j,2),v=C[0],D=C[1],y=(0,r.useState)([]),w=(0,s.Z)(y,2),I=w[0],F=w[1],S=(0,r.useState)(!1),R=(0,s.Z)(S,2),k=R[0],V=R[1],E=(0,r.useContext)(x.V).state,M=c.Z.useForm(),P=(0,s.Z)(M,1)[0],L=c.Z.useForm(),Y=(0,s.Z)(L,1)[0],T=c.Z.useWatch("rosters",Y),U=(0,r.useRef)(null);(0,r.useEffect)((function(){e.state&&P.setFieldValue(e.state.name,e.state.value)}),[]),(0,r.useEffect)((function(){Y.setFieldsValue({rosters:v})}),[v]);var A=function(e,t){var n,a;null===(n=Y.getFieldsValue())||void 0===n||null===(a=n.rosters)||void 0===a||a.map((function(n,a){Y.setFieldValue(["rosters",a,t],e)}))},z=function(){V(!1),F(Y.getFieldValue("rosters")),D(Y.getFieldValue("rosters"))};return(0,N.jsxs)("div",{children:[(0,N.jsx)(o.PeolpeSelectionTable,{ref:U,onSelect:function(e){F(e)},onReturn:function(){var e=I.map((function(e){return{Fullname:"".concat(e.Firstname," ").concat(e.Lastname),Id:e.Id,CostCodeName:e.CostCodeName,CostCodeId:e.CostCodeId}}));D(e),V(!0)},selectedRowsData:I,focusedColumns:["CostCodeName"],columns:g,searchDefaultValues:{Active:1},hideFields:["Active"]}),(0,N.jsxs)(o.Modal,{open:k,onCancel:z,destroyOnClose:!1,title:(0,N.jsxs)("div",{children:["Change Cost Code ",(0,N.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",null===T||void 0===T?void 0:T.length," people selected)"]})]}),width:1100,forceRender:!0,children:[(0,N.jsx)(c.Z,{form:Y,size:"small",onFinish:function(e){b(!0);var t=e.rosters.map((function(e){return{DataId:e.CostCodeId,StartDate:e.StartDate?f()(e.StartDate).format("YYYY-MM-DD"):"",EndDate:e.profileUpdate?null:f()(e.EndDate).format("YYYY-MM-DD"),EmployeeId:e.Id,profileUpdate:e.profileUpdate?1:0}}));(0,d.Z)({method:"put",url:"tas/employee/changedata/costcode",data:t}).then((function(e){var t;V(!1),D([]),null===(t=U.current)||void 0===t||t.instance.clearSelection(),P.submit()})).catch((function(e){})).then((function(){return b(!1)}))},initialValues:{rosters:[]},children:(0,N.jsx)(c.Z.List,{name:"rosters",children:function(e,t){var n,s=t.remove;return(0,N.jsx)("div",{className:"border rounded-ot",children:(0,N.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,N.jsx)("thead",{className:"text-[#959595]",children:(0,N.jsxs)("tr",{className:"text-left",children:[(0,N.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:"Current Cost Code"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,N.jsx)(i.Z,{className:"w-full",options:null===(n=E.referData)||void 0===n?void 0:n.costCodes,placeholder:"Cost Code",onChange:function(e){return A(e,"CostCodeId")},allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}}):"Replacement Cost Code"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,N.jsx)(u.Z,{onChange:function(e){return A(e,"StartDate")},placeholder:"Start Date"}):"Start Date"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,N.jsx)(u.Z,{onChange:function(e){return A(e,"EndDate")},placeholder:"End Date"}):"End Date"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,N.jsx)(m.Z,{onChange:function(e){return A(e.target.checked,"profileUpdate")},children:"Permanent"}):"Permanent"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal"})]})}),(0,N.jsx)("tbody",{children:e.map((function(e){var t,n=e.key,r=e.name,o=(0,l.Z)(e,Z);return(0,N.jsxs)("tr",{className:"".concat((r+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[r,"Id"],className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px] w-[30px]",children:r+1})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[r,"Id"],className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",r,"Id"])})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",r,"Fullname"])})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",r,"CostCodeName"])})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[r,"CostCodeId"],className:"mb-0",rules:[{required:!0,message:"Missing cost code"}],children:(0,N.jsx)(i.Z,{options:null===(t=E.referData)||void 0===t?void 0:t.costCodes,placeholder:"Cost Code",allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,{name:[r,"StartDate"],className:"mb-0",children:(0,N.jsx)(u.Z,{placeholder:"Start Date"})},"startDate-".concat(n))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(c.Z.Item,{name:[r,"EndDate"],className:"mb-0",children:(0,N.jsx)(u.Z,{placeholder:"End Date"})},"endDate-".concat(n))}),(0,N.jsx)("td",{className:"py-1 border-t px-1 text-center",children:(0,N.jsx)(c.Z.Item,{name:[r,"profileUpdate"],className:"mb-0",valuePropName:"checked",children:(0,N.jsx)(m.Z,{})},"profileUpdate-".concat(n))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){!function(e){var t;null===(t=U.current)||void 0===t||t.instance.deselectRows([e])}(Y.getFieldValue(["rosters",r,"Id"])),s(r)},children:"Remove"})})]},n)}))})]})})}})}),v.length>0&&(0,N.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,N.jsx)(o.Button,{type:"primary",onClick:function(){return Y.submit()},loading:p,children:"Process"}),(0,N.jsx)(o.Button,{onClick:z,disabled:p,children:"Cancel"})]})]})]})}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[1213],{61213:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var n=a(45987),l=a(1413),s=a(29439),r=a(47313),d=a(2880),i=a(56573),o=a(65040),c=a(74294),u=a(93031),m=a(29074),h=a(58467),p=a(2135),x=a(42614),f=a(14261),v=a(58821),b=a(18711),j=a(46417),y=[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,j.jsx)("div",{className:"flex items-center text-blue-600",children:(0,j.jsx)(p.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,j.jsx)("span",{className:"underline",children:e.value})})})}},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,j.jsx)(b.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname",dataType:"string"},{label:"Lastname",name:"Lastname",dataType:"string"},{label:"Department",name:"DepartmentName",dataType:"string",width:"220px"},{label:"Employer",name:"EmployerName",dataType:"string"},{label:"Roster",name:"RosterName",dataType:"string",width:"70px",enableFilter:!0},{label:"Resource Type",name:"PeopleTypeName",dataType:"string"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,j.jsx)("span",{children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,j.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,j.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",cellRender:function(e){return(0,j.jsx)(f.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,j.jsx)(v.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",cellRender:function(e,t){return(0,j.jsx)(f.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,j.jsx)("i",{className:"dx-icon-home"})}}],g=a(10658),N=a.n(g),Z=["key","name"];var w=function(){var e,t=(0,h.TH)(),a=(0,r.useState)(!1),f=(0,s.Z)(a,2),v=f[0],b=f[1],g=(0,r.useState)([]),w=(0,s.Z)(g,2),I=w[0],D=w[1],R=(0,r.useState)([]),S=(0,s.Z)(R,2),F=S[0],C=S[1],T=(0,r.useState)(!1),k=(0,s.Z)(T,2),M=k[0],V=k[1],L=(0,r.useState)([]),Y=(0,s.Z)(L,2),P=Y[0],q=Y[1],E=(0,r.useState)(!1),z=(0,s.Z)(E,2),A=z[0],B=z[1],G=(0,r.useContext)(x.V).state,H=o.Z.useForm(),J=(0,s.Z)(H,1)[0],O=o.Z.useForm(),_=(0,s.Z)(O,1)[0],U=(0,r.useRef)(null);(0,r.useEffect)((function(){t.state&&J.setFieldValue(t.state.name,t.state.value)}),[]),(0,r.useEffect)((function(){_.setFieldsValue({employeeIds:I})}),[I]);var W=function(){V(!1),D(_.getFieldValue("employeeIds"))};return(0,j.jsxs)("div",{children:[(0,j.jsx)(d.PeolpeSelectionTable,{ref:U,onSelect:function(e){C(e)},onReturn:function(){var e=F.map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{Fullname:"".concat(e.Firstname," ").concat(e.Lastname)})}));D(e),V(!0)},selectedRowsData:F,columns:y,searchDefaultValues:{Active:1},hideFields:["Active"]}),(0,j.jsxs)(d.Modal,{open:M,onCancel:W,title:(0,j.jsxs)("div",{children:["Change Shift Status ",(0,j.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",null===I||void 0===I?void 0:I.length," people selected)"]})]}),width:1e3,children:[(0,j.jsxs)(o.Z,{form:_,size:"small",onFinish:function(e){b(!0),(0,i.Z)({method:"post",url:"tas/employeestatus/visualstatusdatechangebulk",data:(0,l.Z)((0,l.Z)({},e),{},{startDate:N()(e.startDate).format("YYYY-MM-DD"),endDate:N()(e.endDate).format("YYYY-MM-DD"),employeeIds:e.employeeIds.map((function(e){return e.Id}))})}).then((function(e){var t,a;V(!1),D([]),J.submit(),null===(t=U.current)||void 0===t||t.instance.clearSelection(),(null===(a=e.data)||void 0===a?void 0:a.length)>0&&(q(e.data),B(!0))})).catch((function(e){})).then((function(){return b(!1)}))},children:[(0,j.jsx)(o.Z.List,{name:"employeeIds",children:function(e,t){var a=t.remove;return(0,j.jsx)("div",{className:"border rounded-ot",children:(0,j.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,j.jsx)("thead",{className:"text-[#959595]",children:(0,j.jsxs)("tr",{className:"text-left",children:[(0,j.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,j.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,j.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,j.jsx)("th",{className:"border-b px-1 font-normal",children:"Department"}),(0,j.jsx)("th",{className:"border-b px-1 font-normal"})]})}),(0,j.jsx)("tbody",{className:"max-h-[400px]",children:e.map((function(e){e.key;var t=e.name,s=(0,n.Z)(e,Z);return(0,j.jsxs)("tr",{className:"".concat((t+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,j.jsx)("td",{className:"py-1 border-t px-1",children:(0,j.jsx)(o.Z.Item,(0,l.Z)((0,l.Z)({},s),{},{name:[t,"Id"],className:"mb-0",children:(0,j.jsx)("div",{className:"text-[13px] w-[30px]",children:t+1})}))}),(0,j.jsx)("td",{className:"py-1 border-t px-1",children:(0,j.jsx)(o.Z.Item,(0,l.Z)((0,l.Z)({},s),{},{name:[t,"Id"],className:"mb-0",children:(0,j.jsx)("div",{className:"text-[13px]",children:_.getFieldValue(["employeeIds",t,"Id"])})}))}),(0,j.jsx)("td",{className:"py-1 border-t px-1",children:(0,j.jsx)(o.Z.Item,(0,l.Z)((0,l.Z)({},s),{},{className:"mb-0",children:(0,j.jsx)("div",{className:"text-[13px]",children:_.getFieldValue(["employeeIds",t,"Fullname"])})}))}),(0,j.jsx)("td",{className:"py-1 border-t px-1",children:(0,j.jsx)(o.Z.Item,(0,l.Z)((0,l.Z)({},s),{},{className:"mb-0",children:(0,j.jsx)("div",{children:_.getFieldValue(["employeeIds",t,"DepartmentName"])})}))}),(0,j.jsx)("td",{className:"py-1 border-t px-1",children:(0,j.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){!function(e){var t;null===(t=U.current)||void 0===t||t.instance.deselectRows([e])}(_.getFieldValue(["employeeIds",t,"Id"])),a(t)},children:"Remove"})})]})}))})]})})}}),(0,j.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,j.jsx)(o.Z.Item,{label:"Shift Status",className:"mb-0",name:"shiftId",rules:[{required:!0,message:"Shift status is required"}],children:(0,j.jsx)(c.Z,{showSearch:!0,options:null===G||void 0===G||null===(e=G.referData)||void 0===e?void 0:e.roomStatuses,style:{width:160},popupMatchSelectWidth:!1,allowClear:!0,filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())}})},"form-shiftstatus"),(0,j.jsx)(o.Z.Item,{label:"Start Date",className:"mb-0",name:"startDate",rules:[{required:!0,message:"Start date is required"}],children:(0,j.jsx)(u.Z,{})},"form-startdate"),(0,j.jsx)(o.Z.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.startDate!==t.startDate},children:function(e){var t=e.getFieldValue,a=!1;return t("endDate")||(a=t("startDate")),(0,j.jsx)(o.Z.Item,{label:"End Date",className:"mb-0",name:"endDate",rules:[{required:!0,message:"End date is required"}],children:(0,j.jsx)(u.Z,{defaultPickerValue:a})},"form-enddate")}})]})]}),(null===I||void 0===I?void 0:I.length)>0&&(0,j.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,j.jsx)(d.Button,{type:"primary",onClick:function(){return _.submit()},loading:v,children:"Process"}),(0,j.jsx)(d.Button,{onClick:W,disabled:v,children:"Cancel"})]})]}),(0,j.jsx)(d.Modal,{title:"Shift updated employees",width:800,open:A,onCancel:function(){return B(!1)},children:(0,j.jsx)(d.Table,{containerClass:"shadow-none -mx-2",columns:[{label:"Person #",name:"Id",dataType:"string",width:"70px"},{label:"Fullname",name:"FullName",dataType:"string",cellRender:function(e){return(0,j.jsx)(p.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,j.jsx)("span",{className:"text-blue-400 hover:underline",children:e.value})})}},{label:"Reason",name:"SkippedReason",dataType:"string",width:100,cellRender:function(e){var t=e.value;return(0,j.jsx)("div",{children:null===t||void 0===t?void 0:t.Name})}},{label:"Date",name:"SkippedReason",dataType:"string",cellRender:function(e){var t,a=e.value;return(0,j.jsx)("div",{children:null===a||void 0===a||null===(t=a.Days)||void 0===t?void 0:t.map((function(e,t){return(0,j.jsx)(m.Z,{color:"On site days"===(null===a||void 0===a?void 0:a.Name)?"processing":"",className:"my-[2px]",children:e},t)}))})}}],data:P})})]})}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[9522],{99522:function(e,l,a){a.r(l),a.d(l,{default:function(){return W}});var o=a(1413),n=a(29439),t=a(47313),i=a(2880),s=a(49959),r=a(55080),d=a(39548),c=a(40765),u=a(56573),p=a(93433),m=a(74165),v=a(15861),b=a(24957),f=a(53979),h=a(12998),g=a(65040),x=a(74294),N=a(21975),y=a(93031),I=a(68197),F=a(59624),j=a(76298),C=a(76047),D=a(58467),L=a(2135),R=a(42614),q=a(63462),w=a(10658),Z=a.n(w),P=a(41303),S=a(46417),M=[{name:"PassportNumber",type:"image"},{name:"PassportName",type:"image"},{name:"PassportExpiry",type:"date"},{name:"PassportRawImage",type:"image"}],k=new RegExp(/^[\u0410-\u042f\u04ae\u04e8]{2}\d{8}$/),T=new RegExp(/^[0-9]{8}$/),A=new RegExp(/^[A-Za-z -]+$/g),E=new RegExp(/^[0-9 +]+$/);var G=function(e){var l,a=e.profileFields,s=e.fieldLoading,r=e.form,d=(0,t.useState)(0),c=(0,n.Z)(d,2),w=c[0],G=c[1],V=(0,t.useState)(!1),z=(0,n.Z)(V,2),H=z[0],U=z[1],Y=(0,t.useState)(null),O=(0,n.Z)(Y,2),B=O[0],$=O[1],J=(0,D.s0)(),K=h.ZP.useNotification(),W=(0,n.Z)(K,2),_=W[0],Q=W[1],X=(0,t.useContext)(R.V).state,ee=function(){(0,u.Z)({method:"post",url:"tas/employee/checkadaccount",data:{adAccount:r.getFieldValue("ADAccount")}}).then((function(e){e.data.AdAccountValidationStatus?_.success({message:e.data.AdAccountValidationFailedReason,duration:4,btn:!1,closeIcon:!1}):_.error({message:e.data.AdAccountValidationFailedReason,duration:4,btn:!1,closeIcon:!1,description:(0,S.jsx)("div",{children:e.data.EmployeeId&&(0,S.jsxs)(L.Link,{to:"/tas/people/search/".concat(e.data.EmployeeId),className:"text-blue-500 hover:underline",children:[e.data.Firstname," ",e.data.Lastname]})})})})).catch((function(e){})).then((function(){return U(!1)}))},le=(0,t.useCallback)((function(e,l){(0,u.Z)({method:"get",url:"tas/DepartmentGroupConfig/".concat(e)}).then((function(e){var a,o=[];(null===(a=o=e.data.filter((function(e){return e.EmployerId===l})))||void 0===a?void 0:a.length)>0?o.map((function(e){r.setFieldValue(e.GroupMasterId,e.GroupDetailId)})):e.data.filter((function(e){return!e.EmployerId})).map((function(e){r.setFieldValue(e.GroupMasterId,e.GroupDetailId)}))}))}),[r]),ae=(0,t.useMemo)((function(){var e,l,o,n,t,s,r,d,c,u,p,m,v,b,f,h,j,C,D,L,R,w,P,M,T,A,E,G,V;return[{label:null===(e=a.NationalityId)||void 0===e?void 0:e.Label,name:"NationalityId",className:"col-span-12 lg:col-span-6 mb-0",type:"select",rules:[{required:null===(l=a.NationalityId)||void 0===l?void 0:l.FieldRequired,message:"".concat(null===(o=a.NationalityId)||void 0===o?void 0:o.Label," is required")}],inputprops:{options:X.referData.nationalities}},{type:"component",component:(0,S.jsx)(g.Z.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.NRN!==l.NRN||e.NationalityId!==l.NationalityId},children:function(e){var l,o,n,t,i=e.getFieldValue,s=e.setFieldValue,r=X.referData.nationalities.find((function(e){return e.value===i("NationalityId")}));return"MN"===(null===r||void 0===r?void 0:r.Code)&&10===(null===(l=i("NRN"))||void 0===l?void 0:l.length)&&s("Gender",q.Z.getGender(i("NRN"))),(0,S.jsx)(g.Z.Item,{label:null===(o=a.Gender)||void 0===o?void 0:o.Label,name:"Gender",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(n=a.Gender)||void 0===n?void 0:n.FieldRequired,message:"".concat(null===(t=a.Gender)||void 0===t?void 0:t.Label," is required")}],children:(0,S.jsx)(x.Z,{options:[{value:1,label:"Male"},{value:0,label:"Female"}]})})}})},{type:"component",component:(0,S.jsx)(g.Z.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.NationalityId!==l.NationalityId},children:function(e){var l,o,n,t=e.getFieldValue,i=X.referData.nationalities.find((function(e){return e.value===t("NationalityId")}));return"MN"===(null===i||void 0===i?void 0:i.Code)&&(0,S.jsx)(g.Z.Item,{label:null===(l=a.NRN)||void 0===l?void 0:l.Label,name:"NRN",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(o=a.NRN)||void 0===o?void 0:o.FieldRequired,message:"".concat(null===(n=a.NRN)||void 0===n?void 0:n.Label," is required")},{pattern:k,message:"Please use only cyrillic characters"}],children:(0,S.jsx)(N.Z,{maxLength:10,onInput:function(e){return e.target.value=e.target.value.toUpperCase()}})})}})},{type:"component",component:(0,S.jsx)(g.Z.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.NRN!==l.NRN||e.NationalityId!==l.NationalityId},children:function(e){var l,o,n,t,i=e.getFieldValue,s=e.setFieldValue,r=X.referData.nationalities.find((function(e){return e.value===i("NationalityId")}));return"MN"!==(null===r||void 0===r?void 0:r.Code)||10!==(null===(l=i("NRN"))||void 0===l?void 0:l.length)||i("Dob")||s("Dob",Z()(q.Z.getDob(i("NRN")))),(0,S.jsx)(g.Z.Item,{label:null===(o=a.Dob)||void 0===o?void 0:o.Label,name:"Dob",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(n=a.Dob)||void 0===n?void 0:n.FieldRequired,message:"".concat(null===(t=a.Dob)||void 0===t?void 0:t.Label," is required")}],children:(0,S.jsx)(y.Z,{showWeek:!0})})}})},{label:null===(n=a.Firstname)||void 0===n?void 0:n.Label,name:"Firstname",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(t=a.Firstname)||void 0===t?void 0:t.FieldRequired,message:"".concat(null===(s=a.Firstname)||void 0===s?void 0:s.Label," is required")}]},{label:null===(r=a.Lastname)||void 0===r?void 0:r.Label,name:"Lastname",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(d=a.Lastname)||void 0===d?void 0:d.FieldRequired,message:"".concat(null===(c=a.Lastname)||void 0===c?void 0:c.Label," is required")}]},{label:null===(u=a.MFirstname)||void 0===u?void 0:u.Label,name:"MFirstname",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(p=a.MFirstname)||void 0===p?void 0:p.FieldRequired,message:"".concat(null===(m=a.MFirstname)||void 0===m?void 0:m.Label," is required")}]},{label:null===(v=a.MLastname)||void 0===v?void 0:v.Label,name:"MLastname",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(b=a.MLastname)||void 0===b?void 0:b.FieldRequired,message:"".concat(null===(f=a.MLastname)||void 0===f?void 0:f.Label," is required")}]},{label:null===(h=a.CommenceDate)||void 0===h?void 0:h.Label,name:"CommenceDate",className:"col-span-12 lg:col-span-6 mb-0",type:"date",rules:[{required:null===(j=a.CommenceDate)||void 0===j?void 0:j.FieldRequired,message:"".concat(null===(C=a.CommenceDate)||void 0===C?void 0:C.Label," is required")}],inputprops:{format:"MM/DD/YYYY"}},{label:"Completion Date",name:"CompletionDate",className:"col-span-12 lg:col-span-6 mb-0",type:"date",rules:[{required:!1,message:"Completion Date is required"}],inputprops:{format:"MM/DD/YYYY"}},{label:null===(D=a.DepartmentId)||void 0===D?void 0:D.Label,name:"DepartmentId",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(L=a.DepartmentId)||void 0===L?void 0:L.FieldRequired,message:"".concat(null===(R=a.DepartmentId)||void 0===R?void 0:R.Label," is required")}],type:"treeSelect",inputprops:{treeData:X.referData.departments,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},allowClear:!0,showSearch:!0,filterTreeNode:function(e,l){var a;return(null!==(a=null===l||void 0===l?void 0:l.Name)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())}}},{type:"component",component:(0,S.jsx)(i.Form.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.DepartmentId!==l.DepartmentId},children:function(e){var l,o,n,t,s=e.getFieldValue,r=e.setFieldValue,d=null===(l=X.referData.departments)||void 0===l?void 0:l.find((function(e){return e.Id===s("DepartmentId")}));return d&&d.CostCodeId&&r("CostCodeId",d.CostCodeId),(0,S.jsx)(i.Form.Item,{name:"CostCodeId",label:null===(o=a.CostCodeId)||void 0===o?void 0:o.Label,rules:[{required:null===(n=a.CostCodeId)||void 0===n?void 0:n.FieldRequired,message:"".concat(null===(t=a.CostCodeId)||void 0===t?void 0:t.Label," is required")}],className:"col-span-12 lg:col-span-6 mb-0",children:(0,S.jsx)(x.Z,{options:X.referData.costCodes,showSearch:!0,allowClear:!0,filterOption:function(e,l){var a;return(null!==(a=null===l||void 0===l?void 0:l.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())}})})}})},{label:null===(w=a.StateId)||void 0===w?void 0:w.Label,name:"StateId",className:"col-span-12 lg:col-span-6 mb-0",type:"select",rules:[{required:null===(P=a.StateId)||void 0===P?void 0:P.FieldRequired,message:"".concat(null===(M=a.StateId)||void 0===M?void 0:M.Label," is required")}],inputprops:{options:X.referData.states}},{label:null===(T=a.Email)||void 0===T?void 0:T.Label,name:"Email",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(A=a.Email)||void 0===A?void 0:A.FieldRequired,message:"".concat(null===(E=a.Email)||void 0===E?void 0:E.Label," is required")},{type:"email",message:"The input is not valid E-mail!"}]},{type:"component",component:(0,S.jsx)(g.Z.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.DepartmentId!==e.DepartmentId},children:function(e){var l=e.getFieldValue,a=(e.setFieldValue,l("DepartmentId")),o=l("EmployerId");a&&le(a,o)}})},{type:"component",component:(0,S.jsx)(g.Z.Item,{className:"col-span-12 lg:col-span-6 mb-0",label:"AD Account",children:(0,S.jsxs)(I.Z,{gutter:8,children:[(0,S.jsx)(F.Z,{span:12,children:(0,S.jsx)(g.Z.Item,{name:"ADAccount",className:"mb-0",children:(0,S.jsx)(N.Z,{})})}),(0,S.jsx)(F.Z,{span:12,children:(0,S.jsx)(i.Button,{onClick:ee,children:"Account Check"})})]})},"component-ADAccount")},{label:"Camp",name:"CampId",className:"col-span-12 lg:col-span-6 mb-0",type:"select",inputprops:{options:null===(G=X.referData)||void 0===G?void 0:G.camps}},{label:"Room Type",name:"RoomTypeId",className:"col-span-12 lg:col-span-6 mb-0",type:"select",depindex:"CampId",inputprops:{optionsurl:"tas/roomtype?active=1&campId=",optionvalue:"Id",optionlabel:"Description"}},"SystemAdmin"===(null===(V=X.userInfo)||void 0===V?void 0:V.Role)&&{label:"Create Request",name:"CreateRequest",className:"col-span-12 lg:col-span-6 mb-0",type:"check"}]}),[a,X]),oe=(0,t.useMemo)((function(){var e,l,o,n,t,i,s,d,c,u,p,m,v,b,f,h,g,x,N,y,I,F,j,C,D,L,R,q;return[{label:null===(e=a.EmployerId)||void 0===e?void 0:e.Label,name:"EmployerId",className:"col-span-6 mb-0",type:"select",rules:[{required:null===(l=a.EmployerId)||void 0===l?void 0:l.FieldRequired,message:"".concat(null===(o=a.EmployerId)||void 0===o?void 0:o.Label," is required")}],inputprops:{options:X.referData.employers}},{label:null===(n=a.PeopleTypeId)||void 0===n?void 0:n.Label,name:"PeopleTypeId",className:"col-span-6 mb-0",type:"select",rules:[{required:null===(t=a.PeopleTypeId)||void 0===t?void 0:t.FieldRequired,message:"".concat(null===(i=a.PeopleTypeId)||void 0===i?void 0:i.Label," type is required")}],inputprops:{options:X.referData.peopleTypes}},{label:null===(s=a.SAPID)||void 0===s?void 0:s.Label,name:"SAPID",className:"col-span-12 lg:col-span-6 mb-0",rules:[{required:null===(d=a.SAPID)||void 0===d?void 0:d.FieldRequired,message:"".concat(null===(c=a.SAPID)||void 0===c?void 0:c.Label," is required")}],inputprops:{maxLength:8}},{label:null===(u=a.ContractNumber)||void 0===u?void 0:u.Label,name:"ContractNumber",className:"col-span-6 mb-0",rules:[{required:null===(p=a.ContractNumber)||void 0===p?void 0:p.FieldRequired,message:"".concat(null===(m=a.ContractNumber)||void 0===m?void 0:m.Label," ID is required")}]},{label:"PersonId",name:"PersonId",className:"col-span-6 mb-0",inputprops:{disabled:!0}},{label:null===(v=a.PositionId)||void 0===v?void 0:v.Label,name:"PositionId",className:"col-span-6 mb-0",type:"select",rules:[{required:null===(b=a.PositionId)||void 0===b?void 0:b.FieldRequired,message:"".concat(null===(f=a.PositionId)||void 0===f?void 0:f.Label," is required")}],inputprops:{options:X.referData.positions}},{label:null===(h=a.RosterId)||void 0===h?void 0:h.Label,name:"RosterId",className:"col-span-6 mb-0",type:"select",rules:[{required:null===(g=a.RosterId)||void 0===g?void 0:g.FieldRequired,message:"".concat(null===(x=a.RosterId)||void 0===x?void 0:x.Label," is required")}],inputprops:{options:X.referData.rosters}},{label:null===(N=a.HotelCheck)||void 0===N?void 0:N.Label,name:"HotelCheck",className:"col-span-6 mb-0",type:"check",rules:[{required:null===(y=a.HotelCheck)||void 0===y?void 0:y.FieldRequired,message:"".concat(null===(I=a.HotelCheck)||void 0===I?void 0:I.Label," is required")}]},{label:null===(F=a.LocationId)||void 0===F?void 0:F.Label,name:"LocationId",className:"col-span-6 mb-0",type:"select",rules:[{required:null===(j=a.LocationId)||void 0===j?void 0:j.FieldRequired,message:"".concat(null===(C=a.LocationId)||void 0===C?void 0:C.Label," is required")}],inputprops:{options:null===(D=X.referData)||void 0===D?void 0:D.locations.filter((function(e){return 1!==e.onSite}))}},{label:null===(L=a.FlightGroupMasterId)||void 0===L?void 0:L.Label,name:"FlightGroupMasterId",className:"col-span-6 mb-0",type:"select",rules:[{required:null===(R=a.FlightGroupMasterId)||void 0===R?void 0:R.FieldRequired,message:"".concat(null===(q=a.FlightGroupMasterId)||void 0===q?void 0:q.Label," is required")}],inputprops:{options:X.referData.transportGroups}},{type:"component",component:(0,S.jsx)(P.Z,{profileFields:a,form:r})}]}),[a,X]),ne=(0,t.useMemo)((function(){var e,l,o,n,t,s,r,d,c,u,p,m,v,b,f,h;return[{label:null===(e=a.EmergencyContactName)||void 0===e?void 0:e.Label,name:"EmergencyContactName",className:"col-span-6 mb-0",rules:[{required:null===(l=a.EmergencyContactName)||void 0===l?void 0:l.FieldRequired,message:"".concat(null===(o=a.EmergencyContactName)||void 0===o?void 0:o.Label," is required")}]},{label:null===(n=a.EmergencyContactMobile)||void 0===n?void 0:n.Label,name:"EmergencyContactMobile",className:"col-span-6 mb-0",rules:[{required:null===(t=a.EmergencyContactMobile)||void 0===t?void 0:t.FieldRequired,message:"".concat(null===(s=a.EmergencyContactMobile)||void 0===s?void 0:s.Label," is required")},{pattern:E,message:"Invalid phone number"}],inputprops:{className:"w-full",maxLength:15}},{label:null===(r=a.Mobile)||void 0===r?void 0:r.Label,name:"Mobile",className:"col-span-6 mb-0",type:"number",rules:[{required:null===(d=a.Mobile)||void 0===d?void 0:d.FieldRequired,message:"".concat(null===(c=a.Mobile)||void 0===c?void 0:c.Label," is required")},{pattern:T,message:"".concat(null===(u=a.Mobile)||void 0===u?void 0:u.Label," must be 8 digit")}],inputprops:{prefix:"+976",className:"w-full",maxLength:8}},{type:"component",component:(0,S.jsx)(i.Form.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.PeopleTypeId!==l.PeopleTypeId},children:function(e){var l,o,n,t,s,r,d=(0,e.getFieldValue)("PeopleTypeId"),c="Visitor"===(null===(l=X.referData.peopleTypes)||void 0===l||null===(o=l.find((function(e){return e.value===d})))||void 0===o?void 0:o.Code);return(0,S.jsx)(i.Form.Item,{className:"col-span-6 mb-0",name:"PersonalMobile",label:null===(n=a.PersonalMobile)||void 0===n?void 0:n.Label,rules:[{required:!c&&(null===(t=a.PersonalMobile)||void 0===t?void 0:t.FieldRequired),message:"".concat(null===(s=a.PersonalMobile)||void 0===s?void 0:s.Label," is required")},{pattern:T,message:"".concat(null===(r=a.PersonalMobile)||void 0===r?void 0:r.Label," must be 8 digit")}],children:(0,S.jsx)(j.Z,{controls:!1,prefix:"+976",className:"w-full",maxLength:8})})}})},{label:null===(p=a.PickUpAddress)||void 0===p?void 0:p.Label,name:"PickUpAddress",className:"col-span-6 mb-0",type:"textarea",rules:[{required:null===(m=a.PickUpAddress)||void 0===m?void 0:m.FieldRequired,message:"".concat(null===(v=a.PickUpAddress)||void 0===v?void 0:v.Label," is required")}]},{label:null===(b=a.FrequentFlyer)||void 0===b?void 0:b.Label,name:"FrequentFlyer",className:"col-span-6 mb-0",rules:[{required:null===(f=a.FrequentFlyer)||void 0===f?void 0:f.FieldRequired,message:"".concat(null===(h=a.FrequentFlyer)||void 0===h?void 0:h.Label," is required")}]}]}),[a]),te=(0,t.useMemo)((function(){var e;return null===(e=X.referData)||void 0===e?void 0:e.fieldsOfGroups.map((function(e){return{name:e.Id,label:e.Description}}))}),[null===(l=X.referData)||void 0===l?void 0:l.fieldsOfGroups]),ie=(0,t.useMemo)((function(){var e,l;return[{type:"component",component:(0,S.jsx)(S.Fragment,{children:null===(e=X.referData)||void 0===e||null===(l=e.fieldsOfGroups)||void 0===l?void 0:l.map((function(e,l){var a;return(0,S.jsx)(g.Z.Item,{name:e.Id,label:e.Description,rules:[{required:e.Required,message:"".concat(e.Description," is required")}],className:"col-span-12 lg:col-span-7 mb-0",children:(0,S.jsx)(x.Z,{showSearch:!0,allowClear:!0,filterOption:function(e,l){var a;return(null!==(a=null===l||void 0===l?void 0:l.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},children:null===(a=e.details)||void 0===a?void 0:a.map((function(e,l){return(0,S.jsx)(x.Z.Option,{value:e.Id,children:e.Description},l)}))})},"g-fields-".concat(l))}))})}]}),[X]),se=(0,t.useMemo)((function(){return[{type:"component",component:(0,S.jsx)(g.Z.Item,{noStyle:!0,shouldUpdate:function(e,l){return e.NationalityId!==l.NationalityId},children:function(e){e.getFieldValue;var l,o,n,t,i,s,d,c,u,p,m,v=null===(l=X.referData)||void 0===l||null===(o=l.nationalities)||void 0===o?void 0:o.find((function(e){return e.value===r.getFieldValue("NationalityId")}));return"MN"!==(null===v||void 0===v?void 0:v.Code)&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.Z.Item,{label:null===(n=a.PassportNumber)||void 0===n?void 0:n.Label,name:"PassportNumber",className:"col-span-12 lg:col-span-7 mb-0",rules:[{required:null===(t=a.PassportExpiry)||void 0===t?void 0:t.FieldRequired,message:"".concat(null===(i=a.PassportNumber)||void 0===i?void 0:i.Label," is required")}],children:(0,S.jsx)(N.Z,{})}),(0,S.jsx)(g.Z.Item,{label:null===(s=a.PassportName)||void 0===s?void 0:s.Label,name:"PassportName",className:"col-span-12 lg:col-span-7 mb-0",rules:[{required:null===(d=a.PassportExpiry)||void 0===d?void 0:d.FieldRequired,message:"".concat(null===(c=a.PassportName)||void 0===c?void 0:c.Label," is required")},{pattern:A,message:"The input is not valid name!"}],children:(0,S.jsx)(N.Z,{})}),(0,S.jsx)(g.Z.Item,{label:null===(u=a.PassportExpiry)||void 0===u?void 0:u.Label,name:"PassportExpiry",className:"col-span-12 lg:col-span-7 mb-0",rules:[{required:null===(p=a.PassportExpiry)||void 0===p?void 0:p.FieldRequired,message:"".concat(null===(m=a.PassportExpiry)||void 0===m?void 0:m.Label," is required")}],children:(0,S.jsx)(y.Z,{})})]})}})},{label:"Passport Image",name:"PassportRawImage",className:"col-span-12 lg:col-span-7 mb-0",type:"image"}]}),[X,a]),re=(0,t.useCallback)((function(e){U(!0),$(null);var l=new FormData,a=[];Object.keys(e).map((function(o){var n,t;isNaN(o)?"PassportRawImage"===o?l.append(o,null!==(n=e.PassportRawImage)&&void 0!==n&&n.file?null===(t=e.PassportRawImage)||void 0===t?void 0:t.file:""):"Gender"===o?l.append(o,e[o]?1:0):"CommenceDate"===o||"CompletionDate"===o||"Dob"===o||"NextRosterDate"===o||"PassportExpiry"===o?l.append(o,e[o]?Z()(e[o]).format("YYYY-MM-DD"):""):l.append(o,e[o]?e[o]:""):a.push({GroupMasterId:parseInt(o),GroupDetailId:e[o]?e[o]:""})})),(0,u.Z)({method:"post",url:"tas/employee",data:l}).then(function(){var e=(0,v.Z)((0,m.Z)().mark((function e(l){return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,u.Z)({method:"post",url:"tas/groupmembers/".concat(l.data),data:a}).then((function(e){U(!1),J("/tas/people/search/".concat(l.data))})).catch((function(e){U(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(l){return e.apply(this,arguments)}}()).catch((function(e){U(!1);var l=JSON.parse(e.response.data.message);l&&l.length>0&&_.error({message:"Data Duplicated",duration:0,description:(0,S.jsx)("div",{children:(0,S.jsxs)("table",{className:"border-collapse border border-gray-200 text-xs mt-5",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{className:"text-[11px] font-medium",children:[(0,S.jsx)("th",{className:"border border-gray-200"}),(0,S.jsx)("th",{className:"border border-gray-200 px-1",children:"ADAccount"}),(0,S.jsx)("th",{className:"border border-gray-200 px-1",children:"SAP ID #"}),(0,S.jsx)("th",{className:"border border-gray-200 px-1",children:"Mobile"}),(0,S.jsx)("th",{className:"border border-gray-200 px-1",children:"NRN"})]})}),(0,S.jsx)("tbody",{children:null===l||void 0===l?void 0:l.map((function(e){return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:"border border-gray-200 text-center",children:(0,S.jsx)(L.Link,{to:"/tas/people/search/".concat(e.EmployeeId),children:(0,S.jsxs)("span",{className:"text-blue-500 hover:underline cursor-pointer",children:[e.FullName," (",e.EmployeeId,")"]})})}),(0,S.jsx)("td",{className:"border border-gray-200 text-center",children:"boolean"===typeof e.ADAccount?e.ADAccount?"":(0,S.jsx)(b.Z,{twoToneColor:"#eb2f96",style:{fontSize:"16px"}}):""}),(0,S.jsx)("td",{className:"border border-gray-200 text-center",children:"boolean"===typeof e.SAPID?e.SAPID?"":(0,S.jsx)(b.Z,{twoToneColor:"#eb2f96",style:{fontSize:"16px"}}):""}),(0,S.jsx)("td",{className:"border border-gray-200 text-center",children:"boolean"===typeof e.Mobile?e.Mobile?"":(0,S.jsx)(b.Z,{twoToneColor:"#eb2f96",style:{fontSize:"16px"}}):""}),(0,S.jsx)("td",{className:"border border-gray-200 text-center",children:"boolean"===typeof e.NRN?e.NRN?"":(0,S.jsx)(b.Z,{twoToneColor:"#eb2f96",style:{fontSize:"16px"}}):""})]})}))})]})})})}))}),[]),de=(0,t.useCallback)((function(e){e&&$(e.errorFields)}),[]),ce=(0,t.useCallback)((function(e){var l=0;return B&&B.map((function(a,o){null!==e&&void 0!==e&&e.find((function(e){return e.name===a.name[0]}))&&l++})),l>0&&(0,S.jsx)(i.ErrorTabElement,{children:l})}),[B]),ue=(0,t.useMemo)((function(){return[{label:(0,S.jsxs)("div",{children:["Personal ",ce([].concat((0,p.Z)(ae),[{name:"NRN"},{name:"Gender"}]))]}),key:0,forceRender:!0,children:(0,S.jsx)("div",{className:"px-4 grid grid-cols-12 gap-x-5 gap-y-2 pt-4",children:(0,S.jsx)(i.FormItemRender,{fields:ae,form:r},"t-item-1c")},"t-item-0")},{label:(0,S.jsxs)("div",{children:["On Site ",ce(oe)]}),key:1,forceRender:!0,children:(0,S.jsx)("div",{className:"px-4 grid grid-cols-12 gap-x-5 gap-y-2 pt-4",children:(0,S.jsx)(i.FormItemRender,{fields:oe,form:r},"t-item-2c")},"t-item-1")},{label:(0,S.jsxs)("div",{children:["Off Site ",ce([].concat((0,p.Z)(ne),[{name:"PersonalMobile"}]))]}),key:2,forceRender:!0,children:(0,S.jsx)("div",{className:"px-4 grid grid-cols-12 gap-x-5 gap-y-2 pt-4",children:(0,S.jsx)(i.FormItemRender,{fields:ne,form:r},"t-item-3c")},"t-item-2")},{label:(0,S.jsxs)("div",{children:["Group ",ce(te)]}),key:"3",forceRender:!0,children:(0,S.jsx)("div",{className:"px-4 grid grid-cols-12 gap-x-5 gap-y-2 pt-4",children:(0,S.jsx)(i.FormItemRender,{fields:ie,form:r},"t-item-4c")},"t-item-3")},{label:(0,S.jsxs)("div",{children:["Citizenship ",ce(M)]}),key:4,forceRender:!0,children:(0,S.jsx)("div",{className:"px-4 grid grid-cols-12 gap-x-5 gap-y-2 pt-4",children:(0,S.jsx)(i.FormItemRender,{fields:se,form:r},"t-item-5c")},"t-item-4")}]}),[ae,oe,ne,te,ie,r,se,B]);return(0,S.jsxs)(S.Fragment,{children:[s?(0,S.jsx)(i.Skeleton,{className:"h-[400px]"}):(0,S.jsxs)(g.Z,(0,o.Z)((0,o.Z)({form:r},{labelCol:{xs:{span:24},sm:{span:12},md:{span:8},lg:{span:12},xl:{span:8},xxl:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}}),{},{labelAlign:"left",onFinish:re,className:"bg-white rounded-lg",onFinishFailed:de,children:[(0,S.jsx)(C.Z,{defaultActiveKey:"1",type:"card",size:"middle",items:ue,activeKey:w,onTabClick:function(e){return G(e)}}),(0,S.jsx)(g.Z,{className:"px-4 pb-5 flex justify-end",children:(0,S.jsx)(i.Button,{htmlType:"button",className:"mt-5 mr-2",type:"primary",onClick:function(){return r.submit()},loading:H,icon:(0,S.jsx)(f.Z,{}),children:"Save"})})]})),Q]})},V=a(45442),z=a(95585),H=a.n(z),U=a(76629),Y=a(14261),O=a(25566),B=a.n(O),$=a(58821),J=a(18711),K=["Lastname","Firstname","SAPID","Id","DepartmentId","EmployerId","Active"];var W=function(){var e,l=U.Z.get("sFields"),a=(0,D.TH)(),p=U.Z.get("el"),m=p?p.sf:null,v=p?p.rd:null,b=(0,t.useState)(l||K),f=(0,n.Z)(b,2),h=f[0],g=f[1],x=(0,t.useState)(!1),N=(0,n.Z)(x,2),y=N[0],I=N[1],F=(0,t.useState)("search"),j=(0,n.Z)(F,2),C=j[0],q=j[1],w=(0,t.useState)([]),Z=(0,n.Z)(w,2),P=Z[0],M=Z[1],k=!1,T=(0,t.useState)(new V.Z({key:"Id",load:function(e){var l,a="",o={};return(null===(l=e.sort)||void 0===l?void 0:l.length)>1&&(a="?sortby=".concat(e.sort[0].selector,"&sortdirection=").concat(e.sort[0].desc?"desc":"asc")),e.filter&&!H()(null===e||void 0===e?void 0:e.filter)&&(o=e.filter),k?(0,u.Z)({method:"post",url:"tas/employee/search".concat(a),data:{model:o,pageIndex:e.skip/e.take,pageSize:e.take}}).then((function(l){var a,n,t,i,s,r;return null!==(a=o)&&void 0!==a&&a.searchTypeSave?U.Z.set("el",{rd:l.data,sf:{model:e.filter}}):U.Z.set("el",null),M([null===(n=e.filter)||void 0===n?void 0:n.Lastname,null===(t=e.filter)||void 0===t?void 0:t.Firstname,null===(i=e.filter)||void 0===i?void 0:i.NRN,null===(s=e.filter)||void 0===s?void 0:s.Mobile,null===(r=e.filter)||void 0===r?void 0:r.roomNumber]),{data:l.data.data,totalCount:l.data.totalcount}})):(k=!0,new Promise((function(e){e({totalCount:p?v.totalcount:0,data:p?v.data:[]})})))}})),A=(0,n.Z)(T,1)[0],E=(0,t.useContext)(R.V),z=E.state,O=E.action,W=(0,D.s0)(),_=i.Form.useForm(),Q=(0,n.Z)(_,1)[0],X=i.Form.useForm(),ee=(0,n.Z)(X,1)[0],le=(0,t.useRef)(null);(0,t.useEffect)((function(){a.state&&Q.setFieldValue(a.state.name,a.state.value),O.changeMenuKey("/tas/people/search")}),[]);var ae=(0,t.useMemo)((function(){var e,l,a,o,n,t,r,d,c,u,p,m,v,b,f,h,g,x,N,y,I,F,j;return[{label:null===(e=z.referData.profileFields.Firstname)||void 0===e?void 0:e.Label,name:"Firstname",className:"col-span-4 mb-2",inputprops:{className:"w-full"}},{label:null===(l=z.referData.profileFields.Lastname)||void 0===l?void 0:l.Label,name:"Lastname",className:"col-span-4 mb-2",inputprops:{className:"w-full"}},{label:"Room number",name:"roomNumber",className:"col-span-4 mb-2",inputprops:{className:"w-full"}},{label:null===(a=z.referData.profileFields.DepartmentId)||void 0===a?void 0:a.Label,name:"DepartmentId",className:"col-span-4 mb-2",type:"treeSelect",inputprops:{treeData:null===(o=z.referData)||void 0===o?void 0:o.departments,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},allowClear:!0,showSearch:!0,style:{display:"contents"},filterTreeNode:function(e,l){var a;return(null!==(a=null===l||void 0===l?void 0:l.Name)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())}}},{label:"Camp",name:"CampId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(n=z.referData)||void 0===n?void 0:n.camps}},{label:null===(t=z.referData.profileFields.LocationId)||void 0===t?void 0:t.Label,name:"LocationId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(r=z.referData)||void 0===r?void 0:r.locations}},{label:null===(d=z.referData.profileFields.FlightGroupMasterId)||void 0===d?void 0:d.Label,name:"FlightGroupMasterId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(c=z.referData)||void 0===c?void 0:c.transportGroups}},{label:"Room Type",name:"RoomTypeId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(u=z.referData)||void 0===u?void 0:u.roomTypes}},{label:null===(p=z.referData.profileFields.NRN)||void 0===p?void 0:p.Label,name:"NRN",className:"col-span-4 mb-2",inputprops:{className:"w-full"}},{label:null===(m=z.referData.profileFields.PeopleTypeId)||void 0===m?void 0:m.Label,name:"PeopleTypeId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(v=z.referData)||void 0===v?void 0:v.peopleTypes}},{label:null===(b=z.referData.profileFields.CostCodeId)||void 0===b?void 0:b.Label,name:"CostCodeId",className:"col-span-4 mb-2",type:"select",inputprops:{options:null===(f=z.referData)||void 0===f?void 0:f.costCodes}},{label:null===(h=z.referData.profileFields.EmployerId)||void 0===h?void 0:h.Label,name:"EmployerId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(g=z.referData)||void 0===g?void 0:g.employers}},{label:null===(x=z.referData.profileFields.PositionId)||void 0===x?void 0:x.Label,name:"PositionId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(N=z.referData)||void 0===N?void 0:N.positions}},{label:null===(y=z.referData.profileFields.RosterId)||void 0===y?void 0:y.Label,name:"RosterId",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(I=z.referData)||void 0===I?void 0:I.rosters}},{label:"Future Bookings",name:"futureBooking",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:[{label:"Has future booking",value:1},{label:"No future booking",value:0}]}},{label:"Group",name:"group",className:"col-span-4 mb-2",inputprops:{className:"w-full"}},{label:"Has room",name:"hasRoom",className:"col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:[{label:"Yes",value:1},{label:"No",value:0}]}},{label:null===(F=z.referData.profileFields.Mobile)||void 0===F?void 0:F.Label,name:"Mobile",className:"col-span-4 mb-2",inputprops:{className:"w-full"}},{label:null===(j=z.referData.profileFields.SAPID)||void 0===j?void 0:j.Label,name:"SAPID",className:"col-span-4 mb-2",type:"textarea",inputprops:{className:"w-full",autoSize:{minRows:1,maxRows:4},showCount:!0,maxLength:5e3}},{label:"Person #",name:"Id",className:"col-span-4 mb-2",type:"textarea",inputprops:{className:"w-full",autoSize:{minRows:1,maxRows:4},showCount:!0,maxLength:5e3}},{label:(0,S.jsxs)("div",{className:"flex gap-2",children:[(0,S.jsx)("span",{children:"Active Only"}),(0,S.jsx)(i.Tooltip,{title:(0,S.jsxs)("span",{children:["checked = Active ",(0,S.jsx)("br",{}),"  unchecked = Inactive ",(0,S.jsx)("br",{})," both check = Both"]}),children:(0,S.jsx)(s.Z,{className:"text-gray-400",size:16})})]}),name:"Active",className:"col-span-4 mb-2",type:"check",inputprops:{className:"w-full",indeterminatewith:!0}}]}),[z]),oe=(0,t.useMemo)((function(){return[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,S.jsx)("div",{className:"flex items-center justify-center",children:(0,S.jsx)(L.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,S.jsx)("button",{type:"button",className:"text-blue-600 underline",children:e.value})})})}},{label:"SAP ID #",name:"SAPID",alignment:"left",width:"90px"},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,S.jsx)(J.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname",dataType:"string",cellRender:function(e){return(0,S.jsx)(B(),{textToHighlight:e.value,searchWords:P,autoEscape:!0})}},{label:"Lastname",name:"Lastname",dataType:"string",cellRender:function(e){return(0,S.jsx)(B(),{textToHighlight:e.value,searchWords:P,autoEscape:!0})}},{label:"Department",name:"DepartmentName",dataType:"string"},{label:"Employer",name:"EmployerName",dataType:"string"},{label:"Roster",name:"RosterName",dataType:"string"},{label:"Resource Type",name:"PeopleTypeName",dataType:"string"},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,S.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,S.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",showInColumnChooser:!1,cellRender:function(e){return(0,S.jsx)(Y.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,l){return(0,S.jsx)($.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",showInColumnChooser:!1,cellRender:function(e,l){return(0,S.jsx)(Y.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,l){return(0,S.jsx)("i",{className:"dx-icon-home"})}}]}),[P]),ne=(0,t.useCallback)((function(e){"header"===e.target&&(e.items||(e.items=[]),e.items.push({text:"Column Chooser",icon:"columnchooser",onItemClick:function(){var l;null===(l=e.component)||void 0===l||l.showColumnChooser()}}))}),[]);return(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)(i.CustomSegmented,{value:C,onChange:function(e){"search"!==e?(q("add"),ee.setFieldsValue((0,o.Z)({},Q.getFieldsValue()))):q("search")},notDisabled:!0}),"search"===C?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"rounded-t-ot bg-white py-2 px-4 border-b shadow-md",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsx)("div",{className:"text-lg font-bold",children:"Search people"}),(0,S.jsx)(i.Button,{htmlType:"button",onClick:function(){return I(!0)},className:"px-2",icon:(0,S.jsx)(r.Z,{style:{fontSize:"16px"}}),children:"Filter"})]}),(0,S.jsx)(i.Form,{form:Q,fields:ae.filter((function(e){return h.includes(e.name)})),className:"grid grid-cols-12 grid-row-3 gap-x-8 grid-flow-row-dense",onFinish:function(e){var l;null===(l=le.current)||void 0===l||l.instance.filter((0,o.Z)((0,o.Z)({},e),{},{searchTypeSave:!1}))},initValues:p?m.model:null,size:"small",wrapperCol:{flex:1},labelCol:{flex:"100px"},children:(0,S.jsxs)("div",{className:"col-span-12 flex gap-4 justify-end mt-1",children:[(0,S.jsx)(L.Link,{to:"/tas/people/search/".concat(null===(e=z.userInfo)||void 0===e?void 0:e.Id),children:(0,S.jsx)(i.Button,{htmlType:"button",icon:(0,S.jsx)(d.Z,{}),children:"Use me"})}),(0,S.jsx)(i.Button,{htmlType:"button",icon:(0,S.jsx)(c.Z,{}),onClick:function(){var e;null===(e=le.current)||void 0===e||e.instance.filter((0,o.Z)((0,o.Z)({},Q.getFieldsValue()),{},{searchTypeSave:!0}))},children:"Save & Search"}),(0,S.jsx)(i.Button,{htmlType:"submit",icon:(0,S.jsx)(c.Z,{}),children:"Search"})]})})]}),(0,S.jsx)("div",{className:"sticky top-0 z-20",children:(0,S.jsx)(i.Table,{ref:le,data:A,columns:oe,isHeaderFilter:!1,isSearch:!1,allowColumnReordering:!1,remoteOperations:!0,onRowDblClick:function(e){return W("/tas/people/search/".concat(e.data.Id))},containerClass:"pt-0 rounded-b-ot rounded-t-none",defaultPageSize:100,style:{maxHeight:"calc(100vh - 330px)"},columnChooser:{enabled:!1,mode:"select",visible:!1},onContextMenuPreparing:ne})})]}):(0,S.jsx)(G,{changeMode:q,profileFields:z.referData.profileFields,form:ee}),(0,S.jsx)(i.ColumnFilter,{open:y,onCancel:function(){return I(!1)},selectedFields:h,setSelectedFields:g,profileFields:z.referData.profileFields})]})}}}]);
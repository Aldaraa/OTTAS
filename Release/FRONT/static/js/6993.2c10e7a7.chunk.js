"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[6993],{66993:function(e,t,n){n.r(t);var i=n(1413),a=n(29439),s=n(2880),o=n(14261),c=n(47313),l=n(65040),r=n(56573),d=n(40765),u=n(82138),m=n(92350),p=n(42614),h=n(95585),f=n.n(h),v=n(45442),x=n(46417),b="Position",g=[{label:"Code",name:"Code",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-12 mb-2",rules:[{required:!0,message:"Description is required"}]}],j=[{label:"Code",name:"Code",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-12 mb-2",rules:[{required:!0,message:"Description is required"}]},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check"}],C=[{label:"Code",name:"Code",className:"col-span-3 mb-2",inputprops:{}},{label:"Description",name:"Description",className:"col-span-3 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}];t.default=function(){var e=(0,c.useState)(0),t=(0,a.Z)(e,2),n=t[0],h=t[1],y=(0,c.useState)(null),N=(0,a.Z)(y,2),Z=N[0],k=N[1],A=(0,c.useState)(!1),D=(0,a.Z)(A,2),w=D[0],S=D[1],I=(0,c.useState)(!1),E=(0,a.Z)(I,2),R=E[0],q=E[1],B=(0,c.useState)(!1),F=(0,a.Z)(B,2),L=F[0],T=F[1],z=(0,c.useState)(!1),O=(0,a.Z)(z,2),P=O[0],_=O[1],M=(0,c.useState)(null),V=(0,a.Z)(M,2),G=V[0],J=V[1],K=(0,c.useState)(new v.Z({key:"Id",load:function(e){var t,n;null===(t=ee.current)||void 0===t||t.instance.beginCustomLoading();var a="";return(null===(n=e.sort)||void 0===n?void 0:n.length)>1&&(a="?sortby=".concat(e.sort[0].selector,"&sortdirection=").concat(e.sort[0].desc?"desc":"asc")),(0,r.Z)({method:"post",url:"tas/position/getall".concat(a),data:e.filter&&!f()(null===e||void 0===e?void 0:e.filter)?(0,i.Z)((0,i.Z)({},e.filter),{},{pageIndex:e.skip/e.take,pageSize:e.take}):{code:"",description:"",Active:1,pageIndex:e.skip/e.take,pageSize:e.take}}).then((function(e){return h(e.data.totalcount),{data:e.data.data,totalCount:e.data.totalcount}})).finally((function(){var e;return null===(e=ee.current)||void 0===e?void 0:e.instance.endCustomLoading()}))}})),Y=(0,a.Z)(K,2),H=Y[0],Q=(Y[1],l.Z.useForm()),U=(0,a.Z)(Q,1)[0],W=l.Z.useForm(),X=(0,a.Z)(W,1)[0],$=(0,c.useContext)(p.V).action,ee=(0,c.useRef)(null);(0,c.useEffect)((function(){$.changeMenuKey("/tas/position")}),[]);var te=function(){$.changeLoadingStatusReferItem({positions:!0}),(0,r.Z)({method:"get",url:"tas/position?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push((0,i.Z)({value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)},e))})),$.setReferDataItem({positions:t})})).catch((function(e){})).then((function(){return $.changeLoadingStatusReferItem({positions:!1})}))},ne=function(e){k(e),S(!0)},ie=[{label:"Description",name:"Description"},{label:"# Resource",name:"EmployeeCount",alignment:"left"},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,x.jsx)(o.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"action",width:"265px",cellRender:function(e){return(0,x.jsxs)("div",{className:"flex gap-3",children:[(0,x.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,J(t),void _(!0);var t},children:"View Audit"}),(0,x.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,k(t),void T(!0);var t},children:"Edit"}),1===e.data.Active?e.data.EmployeeCount>0?(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{id:"target".concat(e.data.Id),className:"dlt-button_lbl",children:"Deactivate"}),(0,x.jsx)(o.u,{target:"#target".concat(e.data.Id),showEvent:"mouseenter",hideEvent:"mouseleave",hideOnOutsideClick:!1,position:"top",children:(0,x.jsx)("div",{children:"Don't deactivate because there is an active Employee"})})]}):(0,x.jsx)("button",{type:"button",disabled:e.data.EmployeeCount>0,className:"dlt-button",onClick:function(){return ne(e.data)},children:"Deactivate"}):(0,x.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return ne(e.data)},children:"Reactivate"})]})}}],ae=function(){T(!1)};return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,x.jsx)("div",{className:"text-lg font-bold mb-2",children:b}),(0,x.jsx)(s.Form,{form:X,fields:C,className:"grid grid-cols-12 gap-x-8",onFinish:function(e){var t;null===(t=ee.current)||void 0===t||t.instance.filter(e)},noLayoutConfig:!0,children:(0,x.jsx)("div",{className:"flex gap-4 items-baseline col-span-2",children:(0,x.jsx)(s.Button,{htmlType:"submit",icon:(0,x.jsx)(d.Z,{}),children:"Search"})})})]}),(0,x.jsx)(s.Table,{ref:ee,data:H,columns:ie,allowColumnReordering:!1,cacheEnabled:!1,remoteOperations:!0,tableClass:"border-t max-h-[calc(100vh-250px)]",title:(0,x.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,x.jsxs)("div",{className:"flex items-center gap-1",children:[(0,x.jsx)("span",{className:"font-bold",children:n}),(0,x.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,x.jsxs)("div",{className:"flex items-center gap-3",children:[(0,x.jsx)(s.Button,{onClick:function(){J(null),_(!0)},children:"Audit"}),(0,x.jsxs)(s.Button,{icon:(0,x.jsx)(u.Z,{}),onClick:function(){k(null),U.resetFields(),T(!0)},children:["Add ",b]})]})]})}),(0,x.jsx)(s.Modal,{open:L,onCancel:ae,title:Z?"Edit ".concat(b):"Add ".concat(b),children:(0,x.jsx)(s.Form,{form:U,fields:Z?g:j,editData:Z,onFinish:function(e){q(!0),Z?(0,r.Z)({method:"put",url:"tas/position",data:(0,i.Z)((0,i.Z)({},e),{},{Id:Z.Id})}).then((function(e){ae(),te(),H.reload()})).catch((function(e){})).then((function(){return q(!1)})):(0,r.Z)({method:"post",url:"tas/position",data:(0,i.Z)((0,i.Z)({},e),{},{Active:e.Active?1:0})}).then((function(e){ae(),H.reload(),te()})).catch((function(e){})).then((function(){return q(!1)}))},children:(0,x.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,x.jsx)(s.Button,{type:"primary",onClick:function(){return U.submit()},loading:R,icon:(0,x.jsx)(m.Z,{}),children:"Save"}),(0,x.jsx)(s.Button,{onClick:ae,disabled:R,children:"Cancel"})]})})}),(0,x.jsxs)(o.GI,{visible:w,showTitle:!1,height:110,width:350,children:[(0,x.jsxs)("div",{children:["Are you sure you want to ",1===(null===Z||void 0===Z?void 0:Z.Active)?"deactivate":"reactivate"," this record?"]}),(0,x.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,x.jsx)(s.Button,{type:1===(null===Z||void 0===Z?void 0:Z.Active)?"danger":"success",onClick:function(){q(!0),(0,r.Z)({method:"delete",url:"tas/position",data:{id:Z.Id}}).then((function(){S(!1),H.reload()})).catch((function(e){})).then((function(){return q(!1)}))},loading:R,children:"Yes"}),(0,x.jsx)(s.Button,{onClick:function(){return S(!1)},disabled:R,children:"No"})]})]}),(0,x.jsx)(s.AuditTable,{title:"Position Audit",tablename:"Position",open:P,onClose:function(){return _(!1)},record:G,recordName:G?(0,x.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",G.Code," ",G.Description,"/"]}):""})]})}}}]);
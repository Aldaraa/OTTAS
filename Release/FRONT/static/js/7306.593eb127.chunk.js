"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[7306],{37306:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var a=n(1413),l=n(45987),r=n(29439),s=n(47313),o=n(2880),c=n(56573),i=n(65040),d=n(74294),u=n(93031),m=n(58467),h=n(42614),x=n(10658),p=n.n(x),f=n(14261),b=n(58821),j=n(18711),v=n(2135),N=n(46417),g=[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,N.jsx)("div",{className:"flex items-center justify-center",children:(0,N.jsx)(v.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,N.jsx)("button",{type:"button",className:"text-blue-600 underline",children:e.value})})})}},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,N.jsx)(j.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname"},{label:"Lastname",name:"Lastname"},{label:"SAP #",name:"SAPID",alignment:"left"},{label:"Department",name:"DepartmentName"},{label:"Employer",name:"EmployerName"},{label:"Roster",name:"RosterName"},{label:"Resource Type",name:"PeopleTypeName"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,N.jsx)("span",{children:e.value})}},{label:"Location",name:"LocationName",cellRender:function(e){return(0,N.jsx)("span",{className:"text-primary2",children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,N.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,N.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",cellRender:function(e){return(0,N.jsx)(f.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,N.jsx)(b.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",cellRender:function(e,t){return(0,N.jsx)(f.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,N.jsx)("i",{className:"dx-icon-home"})}}],Z=["key","name"];var w=function(){var e=(0,m.TH)(),t=(0,s.useState)(!1),n=(0,r.Z)(t,2),x=n[0],f=n[1],b=(0,s.useState)([]),j=(0,r.Z)(b,2),v=j[0],w=j[1],y=(0,s.useState)([]),L=(0,r.Z)(y,2),C=L[0],F=L[1],I=(0,s.useState)(!1),S=(0,r.Z)(I,2),R=S[0],D=S[1],V=(0,s.useContext)(h.V).state,k=i.Z.useForm(),M=(0,r.Z)(k,1)[0],P=i.Z.useForm(),T=(0,r.Z)(P,1)[0],A=(0,s.useRef)(null);(0,s.useEffect)((function(){e.state&&M.setFieldValue(e.state.name,e.state.value)}),[]),(0,s.useEffect)((function(){T.setFieldsValue({rosters:v})}),[v]);var E=function(e,t){var n,a;null===(n=T.getFieldsValue())||void 0===n||null===(a=n.rosters)||void 0===a||a.map((function(n,a){T.setFieldValue(["rosters",a,t],e)}))},Y=function(){D(!1),F(T.getFieldValue("rosters")),w(T.getFieldValue("rosters"))};return(0,N.jsxs)("div",{children:[(0,N.jsx)(o.PeolpeSelectionTable,{ref:A,onSelect:function(e){F(e)},onReturn:function(){var e=C.map((function(e){return{Fullname:"".concat(e.Firstname," ").concat(e.Lastname),Id:e.Id,LocationId:e.LocationId,LocationName:e.LocationName}}));w(e),D(!0)},selectedRowsData:C,columns:g,searchDefaultValues:{Active:1},hideFields:["Active"]}),(0,N.jsxs)(o.Modal,{open:R,onCancel:Y,title:(0,N.jsxs)("div",{children:["Change Location ",(0,N.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",v.length," people selected)"]})]}),width:1e3,forceRender:!0,children:[(0,N.jsx)(i.Z,{form:T,size:"small",onFinish:function(e){f(!0);var t=e.rosters.map((function(e){return{LocationId:e.LocationId,StartDate:e.StartDate?p()(e.StartDate).format("YYYY-MM-DD"):"",EmployeeId:e.Id}}));(0,c.Z)({method:"put",url:"tas/employee/changedata/location",data:{data:t}}).then((function(e){var t;D(!1),w([]),null===(t=A.current)||void 0===t||t.instance.clearSelection(),M.submit()})).catch((function(e){})).then((function(){return f(!1)}))},children:(0,N.jsx)(i.Z.List,{name:"rosters",children:function(e,t){var n,r=t.remove;return(0,N.jsx)("div",{className:"border rounded-ot",children:(0,N.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,N.jsx)("thead",{className:"text-[#959595]",children:(0,N.jsxs)("tr",{className:"text-left",children:[(0,N.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:"Current Location"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,N.jsx)(d.Z,{className:"w-full",options:null===(n=V.referData)||void 0===n?void 0:n.locations,placeholder:"Location",onChange:function(e){return E(e,"LocationId")},allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}}):"Replacement Location"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,N.jsx)(u.Z,{onChange:function(e){return E(e,"StartDate")},placeholder:"Start Date"}):"Start Date"}),(0,N.jsx)("th",{className:"border-b px-1 font-normal"})]})}),(0,N.jsx)("tbody",{children:e.map((function(e){var t,n=e.key,s=e.name,o=(0,l.Z)(e,Z);return(0,N.jsxs)("tr",{className:"".concat((s+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(i.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[s,"Id"],className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px] w-[30px]",children:s+1})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(i.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[s,"Id"],className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px]",children:T.getFieldValue(["rosters",s,"Id"])})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(i.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px]",children:T.getFieldValue(["rosters",s,"Fullname"])})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(i.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{className:"mb-0",children:(0,N.jsx)("div",{className:"text-[13px]",children:T.getFieldValue(["rosters",s,"LocationName"])})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(i.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[s,"LocationId"],className:"mb-0",rules:[{required:!0,message:"Missing Location"}],children:(0,N.jsx)(d.Z,{options:null===(t=V.referData)||void 0===t?void 0:t.locations,placeholder:"Location",allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})}))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)(i.Z.Item,{name:[s,"StartDate"],className:"mb-0",children:(0,N.jsx)(u.Z,{placeholder:"Start Date"})},"startDate-".concat(n))}),(0,N.jsx)("td",{className:"py-1 border-t px-1",children:(0,N.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){!function(e){var t;null===(t=A.current)||void 0===t||t.instance.deselectRows([e])}(T.getFieldValue(["rosters",s,"Id"])),r(s)},children:"Remove"})})]})}))})]})})}})}),v.length>0&&(0,N.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,N.jsx)(o.Button,{type:"primary",onClick:function(){return T.submit()},loading:x,children:"Process"}),(0,N.jsx)(o.Button,{onClick:Y,disabled:x,children:"Cancel"})]})]})]})}}}]);
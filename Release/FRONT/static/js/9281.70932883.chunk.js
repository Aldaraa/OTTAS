"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[9281],{29281:function(e,t,n){n.r(t);var a=n(1413),o=n(29439),i=n(2880),l=n(14261),s=n(47313),c=n(65040),r=n(56573),u=n(58467),d=n(2135),m=n(40765),p=n(82138),h=n(92350),f=n(81514),b=n(42614),v=n(46417),x="Room";t.default=function(){var e=(0,s.useState)([]),t=(0,o.Z)(e,2),n=t[0],g=t[1],N=(0,s.useState)([]),y=(0,o.Z)(N,2),C=y[0],j=y[1],Z=(0,s.useState)([]),R=(0,o.Z)(Z,2),k=R[0],w=R[1],A=(0,s.useState)([]),I=(0,o.Z)(A,2),B=I[0],S=I[1],q=(0,s.useState)(null),T=(0,o.Z)(q,2),P=T[0],D=T[1],L=(0,s.useState)(!1),E=(0,o.Z)(L,2),F=E[0],V=E[1],O=(0,s.useState)(!1),z=(0,o.Z)(O,2),_=z[0],J=z[1],G=(0,s.useState)(!1),M=(0,o.Z)(G,2),Y=M[0],H=M[1],K=(0,s.useState)(!1),Q=(0,o.Z)(K,2),U=Q[0],W=Q[1],X=(0,s.useState)(!1),$=(0,o.Z)(X,2),ee=$[0],te=$[1],ne=(0,s.useState)(null),ae=(0,o.Z)(ne,2),oe=ae[0],ie=ae[1],le=c.Z.useForm(),se=(0,o.Z)(le,1)[0],ce=c.Z.useForm(),re=(0,o.Z)(ce,1)[0],ue=(0,s.useContext)(b.V),de=ue.action,me=ue.state,pe=(0,u.s0)();(0,s.useEffect)((function(){return he(),be(),ve(),function(){r.Z.CancelToken.source().cancel()}}),[]);var he=function(){V(!0),(0,r.Z)({method:"get",url:"tas/room"}).then((function(e){if(g(e.data),1===re.getFieldValue("Active")){var t=e.data.filter((function(e){return 1===e.Active}));S(t)}else if(0===re.getFieldValue("Active")){var n=e.data.filter((function(e){return 0===e.Active}));S(n)}else S(e.data)})).catch((function(e){})).then((function(){return V(!1)}))},fe=function(){de.changeLoadingStatusReferItem({rooms:!1}),(0,r.Z)({method:"get",url:"tas/room?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push((0,a.Z)({value:e.Id,label:"".concat(e.Number," - ").concat(e.RoomTypeName)},e))})),de.setReferDataItem({rooms:t})})).catch((function(e){})).then((function(){return de.changeLoadingStatusReferItem({rooms:!1})}))},be=function(){(0,r.Z)({method:"get",url:"tas/roomtype?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push({label:e.Description,value:e.Id})})),j(t)})).catch((function(e){}))},ve=function(){(0,r.Z)({method:"get",url:"tas/camp?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push({label:e.Description,value:e.Id})})),w(t)})).catch((function(e){}))},xe=function(e){D(e),J(!0)},ge=[{label:"Room Number",name:"Number",width:"150px"},{label:"Camp Name",name:"CampName"},{label:"Bed Count",name:"BedCount",width:"80px",alignment:"left"},{label:"Room Type",name:"RoomTypeName",alignment:"left"},{label:"Resource #",name:"EmployeeCount",alignment:"left"},{label:"Private",name:"Private",width:"60px",alignment:"center",cellRender:function(e){return(0,v.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.Private||0})}},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,v.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"",width:"80px",cellRender:function(e){return(0,v.jsx)("div",{className:"flex gap-4",children:(0,v.jsx)(d.Link,{to:"/tas/room/".concat(e.data.Id),children:(0,v.jsx)("button",{type:"button",className:"edit-button",children:"Beds"})})})}},{label:"",name:"action",width:"265px",cellRender:function(e){var t,n;return(0,v.jsxs)("div",{className:"flex gap-3",children:[(0,v.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,ie(t),void te(!0);var t},children:"View Audit"}),(null===(t=me.referData)||void 0===t||null===(n=t.noRoomId)||void 0===n?void 0:n.Id)!==e.data.Id&&(0,v.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,D(t),void W(!0);var t},children:"Edit"}),1===e.data.Active?e.data.EmployeeCount>0?(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{id:"target".concat(e.data.Id),className:"dlt-button_lbl",children:"Deactivate"}),(0,v.jsx)(l.u,{target:"#target".concat(e.data.Id),showEvent:"mouseenter",hideEvent:"mouseleave",hideOnOutsideClick:!1,position:"top",children:(0,v.jsx)("div",{children:"Don't deactivate because there is an active Bed Count"})})]}):(0,v.jsx)("button",{type:"button",disabled:e.data.EmployeeCount>0,className:"dlt-button",onClick:function(){return xe(e.data)},children:"Deactivate"}):(0,v.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return xe(e.data)},children:"Reactivate"})]})}}],Ne=[{label:"Room Number",name:"Number",rules:[{required:!0,message:"Room Number is required"}],className:"col-span-12 mb-2",inputprops:{maxLength:30}},{label:"Bed Count",name:"BedCount",rules:[{required:!0,message:"Bed Count is required"}],className:"col-span-12 mb-2",type:"number"},{label:"Room Type",name:"RoomTypeId",rules:[{required:!0,message:"Room Type is required"}],className:"col-span-12 mb-2",type:"select",inputprops:{options:C}},{label:"Camp",name:"CampId",rules:[{required:!0,message:"Camp is required"}],className:"col-span-12 mb-2",type:"select",inputprops:{options:k}},{label:"Private",name:"Private",className:"col-span-12 mb-2",type:"check",inputprops:{}}],ye=[{label:"Room Number",name:"Number",rules:[{required:!0,message:"Room Number is required"}],className:"col-span-12 mb-2",inputprops:{maxLength:30}},{label:"Bed Count",name:"BedCount",rules:[{required:!0,message:"Bed Count is required"}],className:"col-span-12 mb-2",type:"number"},{label:"Room Type",name:"RoomTypeId",rules:[{required:!0,message:"Room Type is required"}],className:"col-span-12 mb-2",type:"select",inputprops:{options:C}},{label:"Camp",name:"CampId",rules:[{required:!0,message:"Camp is required"}],className:"col-span-12 mb-2",type:"select",inputprops:{options:k}},{label:"Private",name:"Private",className:"col-span-12 mb-2",type:"check",inputprops:{}},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{}}],Ce=[{label:"Room Number",name:"Number",className:"col-span-12 lg:col-span-3 2xl:col-span-2 mb-2"},{label:"Bed Count",name:"BedCount",className:"col-span-12 lg:col-span-3 2xl:col-span-2 mb-2",type:"number",inputprops:{className:"w-full"}},{label:"Room Type",name:"RoomTypeId",className:"col-span-12 lg:col-span-3 2xl:col-span-2 mb-2",type:"select",inputprops:{options:C}},{label:"Camp",name:"CampId",className:"col-span-12 lg:col-span-3 2xl:col-span-2 mb-2",type:"select",inputprops:{options:k}},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}},{label:"Private",name:"Private",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}},{label:"No Room",name:"VirtualRoom",className:"col-span-12 lg:col-span-2 2xl:col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],je=function(){W(!1)};return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,v.jsx)("div",{className:"text-lg font-bold mb-2",children:x}),(0,v.jsx)(i.Form,{form:re,fields:Ce,className:"grid grid-cols-12 gap-x-8 ",onFinish:function(e){(0,f.Z)(e,n).then((function(e){S(e)}))},noLayoutConfig:!0,size:"small",initValues:{Active:1,Private:null,VirtualRoom:null},children:(0,v.jsx)("div",{className:"col-span-1 flex items-baseline",children:(0,v.jsx)(i.Button,{htmlType:"submit",loading:F,icon:(0,v.jsx)(m.Z,{}),children:"Search"})})})]}),(0,v.jsx)(i.Table,{data:B,columns:ge,allowColumnReordering:!1,loading:F,keyExpr:"Id",onRowDblClick:function(e){return pe("/tas/room/".concat(e.data.Id))},tableClass:"border-t max-h-[calc(100vh-270px)]",title:(0,v.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)("span",{className:"font-bold",children:B.length}),(0,v.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)(i.Button,{onClick:function(){ie(null),te(!0)},children:"Audit"}),(0,v.jsxs)(i.Button,{icon:(0,v.jsx)(p.Z,{}),onClick:function(){D(null),se.resetFields(),W(!0)},children:["Add ",x]})]})]})}),(0,v.jsx)(i.Modal,{open:U,onCancel:function(){return W(!1)},title:P?"Edit ".concat(x):"Add ".concat(x),children:(0,v.jsx)(i.Form,{form:se,fields:P?Ne:ye,editData:P,onFinish:function(e){H(!0),P?(0,r.Z)({method:"put",url:"tas/room",data:(0,a.Z)((0,a.Z)({},e),{},{Id:P.Id})}).then((function(e){he(),fe(),je()})).catch((function(e){})).then((function(){return H(!1)})):(0,r.Z)({method:"post",url:"tas/room",data:(0,a.Z)((0,a.Z)({},e),{},{Active:e.Active?1:0})}).then((function(e){he(),fe(),je()})).catch((function(e){})).then((function(){return H(!1)}))},children:(0,v.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,v.jsx)(i.Button,{type:"primary",onClick:function(){return se.submit()},loading:Y,icon:(0,v.jsx)(h.Z,{}),children:"Save"}),(0,v.jsx)(i.Button,{onClick:je,disabled:Y,children:"Cancel"})]})})}),(0,v.jsxs)(l.GI,{visible:_,showTitle:!1,height:110,width:350,children:[(0,v.jsxs)("div",{children:["Are you sure you want to ",1===(null===P||void 0===P?void 0:P.Active)?"deactivate":"reactivate"," this record?"]}),(0,v.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,v.jsx)(i.Button,{type:1===(null===P||void 0===P?void 0:P.Active)?"danger":"success",onClick:function(){H(!0),(0,r.Z)({method:"delete",url:"tas/room",data:{id:P.Id}}).then((function(){he(),fe(),J(!1)})).catch((function(e){})).then((function(){return H(!1)}))},loading:Y,children:"Yes"}),(0,v.jsx)(i.Button,{onClick:function(){return J(!1)},disabled:Y,children:"No"})]})]}),(0,v.jsx)(i.AuditTable,{title:"Room Audit",tablename:"Room",open:ee,onClose:function(){return te(!1)},record:oe,recordName:oe?(0,v.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",oe.Code," ",oe.Description,"/"]}):""})]})}},81514:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(93433),o=n(4942),i=n(1413);var l=function e(t,n,a){var l=[],s=Object.keys(n);return t.map((function(t){if(t[a].length>0)l.push((0,i.Z)((0,i.Z)({},t),{},(0,o.Z)({},a,e(t[a],n,a))));else{var c=!1;s.map((function(e){var a,o;""!==n[e]&&"undefined"!==typeof n[e]&&null!==n[e]?c="string"===typeof n[e]?c||(null===(a=t[e])||void 0===a?void 0:a.toLowerCase().includes(null===(o=n[e])||void 0===o?void 0:o.toLowerCase())):c||t[e]===n[e]:c=!0})),c&&l.push(t)}})),l};function s(e,t,n,o){return"tree"===n?l(t,e,o):new Promise((function(n,o){var i=Object.keys(e),l=(0,a.Z)(t);i.map((function(t){""!==e[t]&&"undefined"!==typeof e[t]&&null!==e[t]&&(l="string"===typeof e[t]?l.filter((function(n){var a,o;return null===(a=n[t])||void 0===a?void 0:a.toLowerCase().includes(null===(o=e[t])||void 0===o?void 0:o.toLowerCase())})):l.filter((function(n){return n[t]===e[t]})))})),n(l)}))}}}]);
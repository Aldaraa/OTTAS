"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[9908],{9908:function(e,n,t){t.r(n);var l=t(74165),o=t(15861),a=t(1413),s=t(29439),i=t(56573),c=t(2880),d=t(42614),r=t(14261),u=t(47313),p=t(65040),m=t(12998),h=t(29074),x=t(40765),f=t(6986),v=t(22231),b=t(10658),j=t.n(b),w=t(42956),g=t(95585),y=t.n(g),Z=t(76738),C=t(46417);n.default=function(){var e,n,t,b,g,N=(0,u.useState)([]),k=(0,s.Z)(N,2),R=k[0],F=k[1],S=(0,u.useState)(!1),A=(0,s.Z)(S,2),B=A[0],D=A[1],U=(0,u.useState)(!1),E=(0,s.Z)(U,2),T=E[0],L=E[1],Y=(0,u.useState)(!1),I=(0,s.Z)(Y,2),M=I[0],P=I[1],_=(0,u.useState)(null),z=(0,s.Z)(_,2),O=z[0],q=z[1],K=(0,u.useState)(null),V=(0,s.Z)(K,2),G=V[0],J=V[1],H=(0,u.useState)(!1),Q=(0,s.Z)(H,2),W=Q[0],X=Q[1],$=(0,u.useState)(!1),ee=(0,s.Z)($,2),ne=ee[0],te=ee[1],le=(0,u.useState)(null),oe=(0,s.Z)(le,2),ae=oe[0],se=oe[1],ie=(0,u.useState)(!1),ce=(0,s.Z)(ie,2),de=ce[0],re=ce[1],ue=(0,u.useState)(!1),pe=(0,s.Z)(ue,2),me=pe[0],he=pe[1],xe=(0,u.useState)(null),fe=(0,s.Z)(xe,2),ve=fe[0],be=fe[1],je=(0,u.useState)(null),we=(0,s.Z)(je,2),ge=we[0],ye=we[1],Ze=(0,u.useRef)(null),Ce=(0,u.useState)(new w.Z({key:"Id",load:function(e){var n,t,l,o="";return(null===(n=e.sort)||void 0===n?void 0:n.length)>1&&(o="?sortby=".concat(e.sort[0].selector,"&sortdirection=").concat(e.sort[0].desc?"desc":"asc")),e.filter&&!y()(e.filter)?(null===(t=Ze.current)||void 0===t||t.instance.beginCustomLoading(),(0,i.Z)({method:"post",url:"tas/position/getall".concat(o),data:(0,a.Z)((0,a.Z)({},e.filter),{},{pageIndex:e.skip/e.take,pageSize:e.take})}).then((function(e){return{data:e.data.data,totalCount:e.data.totalcount}})).finally((function(){var e;return null===(e=Ze.current)||void 0===e?void 0:e.instance.endCustomLoading()}))):(null===(l=Ze.current)||void 0===l||l.instance.beginCustomLoading(),(0,i.Z)({method:"post",url:"tas/position/getall".concat(o),data:{code:"",description:"",Active:Ae.getFieldValue("Active"),pageIndex:e.skip/e.take,pageSize:e.take}}).then((function(e){return{data:e.data.data,totalCount:e.data.totalcount}})).finally((function(){var e;return null===(e=Ze.current)||void 0===e?void 0:e.instance.endCustomLoading()})))}})),Ne=(0,s.Z)(Ce,1)[0],ke=(0,u.useContext)(d.V),Re=ke.state,Fe=ke.action,Se=p.Z.useForm(),Ae=(0,s.Z)(Se,1)[0],Be=m.ZP.useNotification(),De=(0,s.Z)(Be,2),Ue=De[0],Ee=De[1];(0,u.useEffect)((function(){Fe.changeMenuKey("/tas/bulkposition")}),[]);var Te=[{label:"Code",name:"Code",width:"100px"},{label:"Description",name:"Description"},{label:"# Resource",name:"EmployeeCount",alignment:"left",cellRender:function(e){return e.value>0?(0,C.jsx)("button",{onClick:function(){return n=e.data,se(n),void X(!0);var n},className:"text-blue-400 hover:underline",children:e.value}):(0,C.jsx)("span",{children:e.value})}},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,C.jsx)(r.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}}],Le=(0,u.useCallback)((function(e){F(e.selectedRowKeys)}),[]),Ye=[{label:"Excel Row Index",name:"ExcelRowIndex",alignment:"left",width:"120px"},{label:"Error",name:"Error",alignment:"left"}];return(0,C.jsxs)("div",{children:[(0,C.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,C.jsx)("div",{className:"text-lg font-bold mb-2",children:"Bulk Position"}),(0,C.jsx)(c.Form,{form:Ae,fields:[{label:"Code",name:"Code",className:"col-span-6 xl:col-span-3 2xl:col-span-2 mb-2",inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-6 xl:col-span-3 2xl:col-span-2 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],className:"grid grid-cols-12 gap-x-8",onFinish:function(e){var n;null===(n=Ze.current)||void 0===n||n.instance.filter(e)},noLayoutConfig:!0,children:(0,C.jsx)("div",{className:"xl:col-span-1 col-span-12 flex justify-end xl:justify-start xl:items-baseline",children:(0,C.jsx)(c.Button,{htmlType:"submit",icon:(0,C.jsx)(x.Z,{}),children:"Search"})})})]}),(0,C.jsx)(c.Table,{ref:Ze,data:Ne,columns:Te,allowColumnReordering:!1,remoteOperations:!0,showRowLines:!0,selection:{mode:"multiple",recursive:!1,showCheckBoxesMode:"always",allowSelectAll:!0,selectAllMode:"page"},tableClass:"border-t max-h-[calc(100vh-250px)]",onSelectionChanged:Le,title:null!==(e=Re.userInfo)&&void 0!==e&&e.ReadonlyAccess?"":(0,C.jsxs)("div",{className:"flex justify-between py-2 gap-3 border-b",children:[(0,C.jsxs)("div",{className:"ml-2",children:[(0,C.jsx)("span",{className:"font-bold",children:R.length})," people selected"]}),(0,C.jsxs)("div",{className:"flex gap-3",children:[(0,C.jsx)(c.Button,{disabled:0===R.length,icon:(0,C.jsx)(f.Z,{}),onClick:function(){D(!0),(0,i.Z)({method:"post",url:"tas/position/bulkrequest",responseType:"blob",data:{positionIds:R}}).then((function(e){var n=window.URL.createObjectURL(new Blob([e.data])),t="TAS_Position_Bulk_Download_".concat(j()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),l=document.createElement("a");l.href=n,l.setAttribute("download",t),document.body.appendChild(l),l.click()})).catch((function(e){})).then((function(){return D(!1)}))},loading:B,children:"Download"}),(0,C.jsx)(c.FileUploader,{icon:(0,C.jsx)(v.Z,{}),onChange:function(e){if((0,Z.Z)(e)){L(!0),J(e);var n=new FormData;n.append("BulkPositionFile",e),e&&(0,i.Z)({method:"post",url:"tas/position/bulkuploadpreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){q(e.data),P(!0)})).catch((function(e){})).then((function(){return L(!1)}))}else Ue.error({message:"Error",placement:"top",duration:5,description:(0,C.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx, .csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",loading:T,children:"Upload"}),(0,C.jsx)(c.FileUploader,{icon:(0,C.jsx)(v.Z,{}),onChange:function(e){if((0,Z.Z)(e)){ye(e),he(!0);var n=new FormData;n.append("BulkPositionFile",e),e&&(0,i.Z)({method:"post",url:"tas/position/bulkuploademployeespreview",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:n}).then((function(e){be(e.data),te(!0)})).catch((function(e){})).then((function(){return he(!1)}))}else Ue.error({message:"Error",placement:"top",duration:0,description:(0,C.jsx)("div",{className:"flex items-center justify-center",children:"You can only upload an excel file !"})})},accept:".xlsx",loading:me,children:"Upload Employees"})]})]})}),(0,C.jsxs)(c.Modal,{title:"Uploaded",open:M,onCancel:function(){return P(!1)},children:[(0,C.jsxs)("div",{children:[(0,C.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,C.jsxs)("div",{className:"col-span-6 text-green-500",children:["Added Row: ",(0,C.jsx)(h.Z,{className:"ml-1",color:"green",children:null===O||void 0===O?void 0:O.AddRow})]}),(0,C.jsxs)("div",{className:"col-span-6",children:["None Row: ",(0,C.jsx)(h.Z,{className:"ml-1",children:null===O||void 0===O?void 0:O.NoneRow})]}),(0,C.jsxs)("div",{className:"col-span-6 text-red-500",children:["Deactivated Row: ",(0,C.jsx)(h.Z,{className:"ml-1",color:"red",children:null===O||void 0===O?void 0:O.DeleteRow})]}),(0,C.jsxs)("div",{className:"col-span-6",children:["Failed Row: ",(0,C.jsx)(h.Z,{className:"ml-1",children:null===O||void 0===O||null===(n=O.FailedRows)||void 0===n?void 0:n.length})]}),(0,C.jsxs)("div",{className:"col-span-6 text-blue-400",children:["Updated Row: ",(0,C.jsx)(h.Z,{className:"ml-1",color:"blue",children:null===O||void 0===O?void 0:O.UpdateRow})]})]}),(null===O||void 0===O||null===(t=O.FailedRows)||void 0===t?void 0:t.length)>0&&(0,C.jsx)(c.Table,{columns:Ye,data:null===O||void 0===O?void 0:O.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,C.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,C.jsx)(c.Button,{type:"primary",loading:T,onClick:function(){return function(){L(!0);var e=new FormData;e.append("BulkPositionFile",G),G&&(0,i.Z)({method:"post",url:"tas/position/bulkupload",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){P(!1),J(null),Ae.submit()})).catch((function(e){})).then((function(){return L(!1)}))}()},children:"Process"}),(0,C.jsx)(c.Button,{onClick:function(){P(!1),J(null)},disabled:T,children:"Cancel"})]})]}),(0,C.jsxs)(c.Modal,{title:"Uploaded Employee",open:ne,onCancel:function(){return te(!1)},children:[(0,C.jsxs)("div",{className:"mt-5 text-xs",children:[(0,C.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-5",children:[(0,C.jsxs)("div",{className:"col-span-4 text-blue-400",children:["Updated Row: ",(0,C.jsx)(h.Z,{className:"ml-1",color:"blue",children:null===ve||void 0===ve?void 0:ve.UpdateRow})]}),(0,C.jsxs)("div",{className:"col-span-4",children:["Failed Row: ",(0,C.jsx)(h.Z,{className:"ml-1",children:null===ve||void 0===ve||null===(b=ve.FailedRows)||void 0===b?void 0:b.length})]}),(0,C.jsxs)("div",{className:"col-span-4",children:["None Row: ",(0,C.jsx)(h.Z,{className:"ml-1",children:null===ve||void 0===ve?void 0:ve.NoneRow})]})]}),(null===ve||void 0===ve||null===(g=ve.FailedRows)||void 0===g?void 0:g.length)>0&&(0,C.jsx)(c.Table,{columns:Ye,data:null===ve||void 0===ve?void 0:ve.FailedRows,containerClass:"shadow-none border-t",tableClass:"max-h-[100px]"})]}),(0,C.jsxs)("div",{className:"flex justify-end gap-5 items-center",children:[(0,C.jsx)(c.Button,{type:"primary",loading:T,onClick:function(){return function(){L(!0);var e=new FormData;e.append("BulkPositionFile",ge),ge&&(0,i.Z)({method:"post",url:"tas/position/bulkuploademployees",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},data:e}).then((function(e){te(!1),ye(null),Ae.submit()})).catch((function(e){})).then((function(){return L(!1)}))}()},children:"Process"}),(0,C.jsx)(c.Button,{onClick:function(){te(!1),ye(null)},disabled:T,children:"Cancel"})]})]}),(0,C.jsx)(r.GI,{visible:W,showTitle:!1,height:"auto",width:350,children:(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{children:"Are you sure you want to download this record data?"}),(0,C.jsxs)("div",{className:"flex gap-5 mt-3 justify-center",children:[(0,C.jsx)(c.Button,{type:"success",onClick:function(){re(!0),(0,i.Z)({method:"post",url:"tas/position/bulkrequestemployees",responseType:"blob",data:{positionId:ae.Id}}).then(function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){var t,o,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.URL.createObjectURL(new Blob([n.data]));case 2:return t=e.sent,o="TAS_".concat(ae.Description,"_Employees_").concat(j()().format("YYYY-MM-DD hh:mm:ss"),".xlsx"),e.next=6,document.createElement("a");case 6:return(a=e.sent).href=t,e.next=10,a.setAttribute("download",o);case 10:return e.next=12,document.body.appendChild(a);case 12:return e.next=14,a.click();case 14:X(!1);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){})).then((function(){re(!1)}))},loading:de,children:"Yes"}),(0,C.jsx)(c.Button,{onClick:function(){return X(!1)},disabled:de,children:"No"})]})]})}),Ee]})}},76738:function(e,n){var t=["text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];n.Z=function(e){return!!t.includes(e.type)}}}]);
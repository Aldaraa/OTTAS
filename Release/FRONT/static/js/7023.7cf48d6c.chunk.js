"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[7023],{67023:function(e,n,t){t.r(n),t.d(n,{default:function(){return A}});var a=t(1413),l=t(29439),o=t(2880),s=t(14261),i=t(67325),r=t(47313),d=t(65040),c=t(93031),u=t(21975),m=t(83313),x=t(56573),p=t(23495),f=t(5186),h=t(40765),v=t(10658),b=t.n(v),j=t(76446),g=t.n(j),N=t(58467),D=t(2135),y=t(42614),w=t(58922),I=t(58821),R=t(26672),Y=t(165),C=t(10202);var S=function(e,n){for(var t=[],a=b()(e);a.isBefore(n)||a.isSame(n,"day");)t.push(a.format("YYYY-MM-DD")),a=a.add(1,"day");return t},k=t(82241),Z=t(74165),M=t(15861),T=t(82508),F=t(6986),E=t(46417);var B=function(e){var n=e.date,t=e.room,i=(0,r.useState)(!1),d=(0,l.Z)(i,2),c=d[0],u=d[1],m=(0,r.useState)([]),p=(0,l.Z)(m,2),f=p[0],h=p[1],v=(0,r.useState)(!1),j=(0,l.Z)(v,2),g=j[0],N=j[1],w=(0,r.useState)(!1),I=(0,l.Z)(w,2),Y=I[0],C=I[1],S=(0,r.useContext)(y.V).state,k=o.Form.useForm(),B=(0,l.Z)(k,1)[0];(0,r.useEffect)((function(){n&&t&&O()}),[n,t]);var O=function(){u(!0),(0,x.Z)({method:"post",url:"tas/room/detaildateprofile",data:{currentDate:n,roomId:null===t||void 0===t?void 0:t.Id}}).then((function(e){h(e.data)})).finally((function(){return u(!1)}))},L=[{label:"Fullname",name:"FullName",cellRender:function(e){var n;return(0,E.jsxs)("div",{className:"flex gap-1",children:[(0,E.jsxs)("div",{className:"flex",children:[1===e.data.Gender?(0,E.jsx)(R.FaMale,{size:14,className:"text-blue-600"}):(0,E.jsx)(R.FaFemale,{size:14,className:"text-pink-500"}),e.data.RoomOwner?(0,E.jsx)("i",{className:"dx-icon-home text-green-500"}):(0,E.jsx)("i",{className:"dx-icon-home text-gray-400"})]}),(0,E.jsx)(D.Link,{to:"/tas/roomassign/".concat(null===(n=e.data)||void 0===n?void 0:n.EmployeeId,"/roombooking"),children:(0,E.jsx)("span",{className:"cursor-pointer text-blue-500 hover:underline ml-1 whitespace-normal",children:e.value})})]})}},{label:"Department",name:"DepartmentName",cellRender:function(e){var n;return(0,E.jsx)(o.DepartmentTooltip,{showStatus:!1,id:null===(n=e.data)||void 0===n?void 0:n.DepartmentId,children:(0,E.jsx)("span",{className:" whitespace-normal",children:e.value})})}},{label:"People Type",name:"PeopleTypeCode"},{label:"Employer",name:"EmployerName",cellRender:function(e){return(0,E.jsx)("span",{className:" whitespace-normal",children:e.value})}}],P=[{label:"Resource Type",name:"PeopleTypeIds",className:"col-span-12 mb-2",type:"select",inputprops:{mode:"multiple",placeholder:"Select resource type",options:S.referData.peopleTypes}}];return(0,E.jsxs)("div",{className:"flex flex-col",children:[c?(0,E.jsx)("div",{className:"flex-1 flex justify-center items-center",children:(0,E.jsx)(T.Z,{})}):(0,E.jsx)(o.Table,{data:f,columns:L,pager:f>20,keyExpr:"Id",loading:c,isSearch:!0,containerClass:"shadow-none border overflow-hidden mb-4",tableClass:"border-t max-h-[calc(100vh-150px)]",title:(0,E.jsxs)("div",{className:"py-1 font-bold",children:["On Site Employees (",null===f||void 0===f?void 0:f.length,")"]}),toolbar:[{location:"after",render:function(e){return(0,E.jsx)("div",{className:"flex items-center gap-2",children:(0,E.jsx)(s.zx,{icon:"xlsfile",onClick:function(){return N(!0)}})})}}]}),(0,E.jsx)(o.Modal,{open:g,title:"Download Onsite Employees",onCancel:function(){return N(!1)},children:(0,E.jsx)(o.Form,{form:B,fields:P,onFinish:function(e){C(!0),(0,x.Z)({method:"post",responseType:"blob",url:"tas/room/dateprofileexport",data:(0,a.Z)((0,a.Z)({},e),{},{currentDate:n,roomId:null===t||void 0===t?void 0:t.Id})}).then(function(){var e=(0,M.Z)((0,Z.Z)().mark((function e(a){var l,o,s;return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.URL.createObjectURL(new Blob([a.data]));case 2:return l=e.sent,o="TAS_".concat(t.Number,"_").concat(b()(n).format("YYYY-MM-DD"),".xlsx"),e.next=6,document.createElement("a");case 6:return(s=e.sent).href=l,e.next=10,s.setAttribute("download",o);case 10:return e.next=12,document.body.appendChild(s);case 12:return e.next=14,s.click();case 14:N(!1);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){})).then((function(){C(!1)}))},layout:"vertical",children:(0,E.jsx)("div",{className:"col-span-12 flex justify-end gap-4 mt-4",children:(0,E.jsx)(o.Button,{icon:(0,E.jsx)(F.Z,{}),type:"primary",htmlType:"button",onClick:B.submit,loading:Y,children:"Download"})})})})]})},O=t(73030),L=[{label:"#",name:"Id",alignment:"left",width:"50px",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px]",children:e.value})}},{label:"Employee",name:"Firstname",alignment:"left",cellRender:function(e){return(0,E.jsx)("div",{className:"flex items-center gap-3 group p-1",children:(0,E.jsxs)("div",{id:"emp".concat(e.data.Id),style:{fontSize:"12px"},className:"flex items-center gap-3",children:[1===e.data.Gender?(0,E.jsx)(R.FaMale,{size:14,className:"text-blue-600"}):(0,E.jsx)(R.FaFemale,{size:14,className:"text-pink-500"}),(0,E.jsx)(D.Link,{to:"/tas/roomassign/".concat(e.data.Id),children:(0,E.jsxs)("span",{className:"cursor-pointer text-blue-500 hover:underline",children:[e.value," ",e.data.Lastname]})})]})})}},{label:"SAPID",name:"SAPID",alignment:"left",width:"70px",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] px-1",children:e.value})}},{label:"Department",name:"DepartmentName",alignment:"left",cellRender:function(e){var n;return(0,E.jsx)(o.DepartmentTooltip,{showStatus:!1,id:null===(n=e.data)||void 0===n?void 0:n.DepartmentId,children:(0,E.jsx)("span",{className:"text-[12px] px-1 flex whitespace-pre-wrap",children:e.value})})}},{label:"Employer",name:"EmployerName",alignment:"left",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] flex px-1",children:e.value})}},{label:"Res Type",name:"PeopleTypeName",alignment:"left",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] flex px-1",children:e.value})}},{label:"Position",name:"PositionName",alignment:"left",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] px-1 flex whitespace-pre-wrap",children:e.value})}},{label:"OnSite Date",name:"futureTransportDate",alignment:"left",width:110,cellRender:function(e){return(0,E.jsxs)("div",{className:"flex items-center gap-2 text-[12px] px-1",children:[e.data.futureTransportScheduleDescription&&(0,E.jsx)(o.Tooltip,{title:e.data.futureTransportScheduleDescription,children:(0,E.jsx)(I.dm9,{id:"airplane",size:14,color:"1a66ff",style:{transform:"rotate(135deg)",cursor:"pointer"}})}),(0,E.jsx)("div",{children:e.value?b()(e.value).format("YYYY-MM-DD"):""})]})}},{label:"Out Date",name:"futureTransportOUTDate",alignment:"left",width:110,cellRender:function(e){return(0,E.jsxs)("div",{className:"flex items-center gap-2 text-[12px] px-1",children:[e.data.futureTransportScheduleDescription&&(0,E.jsx)(o.Tooltip,{title:e.data.futureTransportScheduleDescription,children:(0,E.jsx)(I.dm9,{id:"airplane",size:14,color:"555",style:{transform:"rotate(45deg)",cursor:"pointer"}})}),(0,E.jsx)("div",{children:e.value?b()(e.value).format("YYYY-MM-DD"):""})]})}}],P=t(6761);var z=function(e){var n=e.open,t=e.onCancel,a=e.roomData,s=(0,N.UO)(),i=s.roomId,d=s.startDate,c=s.endDate,u=o.Form.useForm(),m=(0,l.Z)(u,1)[0],p=(0,r.useState)(!1),f=(0,l.Z)(p,2),h=f[0],v=f[1];return(0,E.jsx)(o.Modal,{title:"Audit",open:n,onCancel:t,children:(0,E.jsx)(o.Form,{form:m,fields:[{name:"startDate",label:"StartDate",className:"col-span-6 mb-0",type:"date"},{name:"endDate",label:"EndDate",className:"col-span-6 mb-0",type:"date"}],onFinish:function(e){v(!0),(0,x.Z)({method:"post",url:"tas/audit/roomauditbyroom",responseType:"blob",data:{roomId:i,startDate:e.startDate,endDate:e.endDate}}).then((function(n){var l="TAS_RoomAuditByRoom_".concat(null===a||void 0===a?void 0:a.Number,"_").concat(null===a||void 0===a?void 0:a.CampName,"_").concat(b()(e.startDate).format("YYYY-MM-DD"),"_").concat(b()(e.endDate).format("YYYY-MM-DD"),".xlsx");(0,P.p)(n.data,l),t()})).catch((function(){})).finally((function(){return v(!1)}))},initValues:{startDate:d?b()(d):b()().subtract(1,"month"),endDate:c?b()(c):b()()},children:(0,E.jsxs)("div",{className:"col-span-12 flex justify-end gap-4 mt-4",children:[(0,E.jsx)(o.Button,{loading:h,htmlType:"submit",type:"primary",icon:(0,E.jsx)(F.Z,{}),children:"Download"}),(0,E.jsx)(o.Button,{onClick:t,disabled:h,children:"Cancel"})]})})})};b().extend(g());var A=function(){var e,n,t,v,j,g,Z,M,T,F,P,A,V,_,G,U,K,H,W,J=(0,N.UO)(),q=J.roomId,Q=J.startDate,X=(0,r.useState)([]),$=(0,l.Z)(X,2),ee=$[0],ne=$[1],te=(0,r.useState)(!1),ae=(0,l.Z)(te,2),le=ae[0],oe=ae[1],se=(0,r.useState)(!1),ie=(0,l.Z)(se,2),re=ie[0],de=ie[1],ce=(0,r.useState)(!1),ue=(0,l.Z)(ce,2),me=(ue[0],ue[1]),xe=(0,r.useState)([]),pe=(0,l.Z)(xe,2),fe=pe[0],he=pe[1],ve=(0,r.useState)(null),be=(0,l.Z)(ve,2),je=be[0],ge=be[1],Ne=(0,r.useState)(Q?b()(Q).startOf("month"):null),De=(0,l.Z)(Ne,2),ye=De[0],we=De[1],Ie=(0,r.useState)(!1),Re=(0,l.Z)(Ie,2),Ye=Re[0],Ce=Re[1],Se=(0,r.useState)(null),ke=(0,l.Z)(Se,2),Ze=ke[0],Me=ke[1],Te=(0,r.useState)(!1),Fe=(0,l.Z)(Te,2),Ee=Fe[0],Be=Fe[1],Oe=(0,r.useState)(!1),Le=(0,l.Z)(Oe,2),Pe=Le[0],ze=Le[1],Ae=(0,r.useState)(null),Ve=(0,l.Z)(Ae,2),_e=Ve[0],Ge=Ve[1],Ue=(0,r.useState)([]),Ke=(0,l.Z)(Ue,2),He=Ke[0],We=Ke[1],Je=(0,r.useState)(!1),qe=(0,l.Z)(Je,2),Qe=qe[0],Xe=qe[1],$e=(0,r.useState)([]),en=(0,l.Z)($e,2),nn=(en[0],en[1]),tn=(0,r.useState)(!1),an=(0,l.Z)(tn,2),ln=an[0],on=an[1],sn=(0,r.useState)(!1),rn=(0,l.Z)(sn,2),dn=rn[0],cn=rn[1],un=(0,r.useState)(!1),mn=(0,l.Z)(un,2),xn=mn[0],pn=mn[1],fn=(0,r.useState)(null),hn=(0,l.Z)(fn,2),vn=hn[0],bn=hn[1],jn=(0,r.useState)(!1),gn=(0,l.Z)(jn,2),Nn=gn[0],Dn=gn[1],yn=(0,r.useState)(null),wn=(0,l.Z)(yn,2),In=wn[0],Rn=wn[1],Yn=(0,r.useState)(0),Cn=(0,l.Z)(Yn,2),Sn=Cn[0],kn=Cn[1],Zn=(0,r.useState)(0),Mn=(0,l.Z)(Zn,2),Tn=Mn[0],Fn=Mn[1],En=(0,r.useState)(10),Bn=(0,l.Z)(En,2),On=Bn[0],Ln=Bn[1],Pn=(0,r.useState)([]),zn=(0,l.Z)(Pn,2),An=zn[0],Vn=zn[1],_n=(0,r.useState)(!1),Gn=(0,l.Z)(_n,2),Un=Gn[0],Kn=Gn[1],Hn=d.Z.useForm(),Wn=(0,l.Z)(Hn,1)[0],Jn=d.Z.useForm(),qn=(0,l.Z)(Jn,1)[0],Qn=(0,r.useContext)(y.V),Xn=Qn.state,$n=Qn.action,et=(0,r.useRef)(null),nt=(0,N.s0)(),tt=(0,k.Z)(),at="roomDetail_".concat(q),lt=d.Z.useWatch([],Wn);(0,r.useEffect)((function(){lt&&(null!==lt&&void 0!==lt&&lt.CampId||null!==lt&&void 0!==lt&&lt.RoomNumber?cn(!0):cn(!1))}),[lt]),(0,r.useEffect)((function(){var e=tt.get("employeeId")||tt.get("empId");e&&je&&qn.setFieldValue("keyword",e)}),[tt,je]),(0,r.useEffect)((function(){An.length>0&&ct()}),[Tn]),(0,r.useEffect)((function(){return Xn.connectionMultiViewer&&Xn.userInfo&&(ot(),Xn.connectionMultiViewer.on("UsersInScreen",(function(e,n){var t=n.map((function(e){return{name:e.userName.split("_")[0],role:e.userName.split("_")[1],color:(0,C.Z)()}}));$n.setMultiViewers(t.filter((function(e){var n,t;return e.name!=="".concat(null===(n=Xn.userInfo)||void 0===n?void 0:n.Firstname," ").concat(null===(t=Xn.userInfo)||void 0===t?void 0:t.Lastname)})))}))),function(){Xn.connectionMultiViewer&&st()}}),[Xn.connectionMultiViewer,Xn.userInfo]),(0,r.useEffect)((function(){ye&&je&&dt()}),[ye,je]),(0,r.useEffect)((function(){var e,n;q&&Q&&ge(null===(e=Xn.referData)||void 0===e||null===(n=e.rooms)||void 0===n?void 0:n.find((function(e){return e.Id===parseInt(q)})))}),[q,Q,null===(e=Xn.referData)||void 0===e?void 0:e.rooms]);var ot=function(){try{var e,n,t,a;null===(e=Xn.connectionMultiViewer)||void 0===e||e.invoke("JoinScreen","".concat(null===(n=Xn.userInfo)||void 0===n?void 0:n.Firstname," ").concat(null===(t=Xn.userInfo)||void 0===t?void 0:t.Lastname,"_").concat(null===(a=Xn.userInfo)||void 0===a?void 0:a.Role),at)}catch(l){}},st=function(){var e,n,t,a;$n.setMultiViewers([]),null===(e=Xn.connectionMultiViewer)||void 0===e||e.invoke("LeaveScreen","".concat(null===(n=Xn.userInfo)||void 0===n?void 0:n.Firstname," ").concat(null===(t=Xn.userInfo)||void 0===t?void 0:t.Lastname,"_").concat(null===(a=Xn.userInfo)||void 0===a?void 0:a.Role),at)},it=(0,r.useCallback)((function(){_e&&(on(!0),(0,x.Z)({method:"get",url:"tas/room/employeeprofile/".concat(_e.Id)}).then((function(e){nn(e.data),Ce(!0)})).finally((function(){return on(!1)})))}),[_e]),rt=(0,r.useCallback)((function(e){nt("/tas/roomcalendar/".concat(e.Id,"/").concat(ye.format("YYYY-MM-DD"))),de(!1)}),[]),dt=function(){me(!0),(0,x.Z)({method:"get",url:"tas/room/getmonthroomdata/owner/".concat(b()(ye).format("YYYY-MM-DD"),"/").concat(je.Id)}).then((function(e){ne(e.data)})).catch((function(e){})).then((function(){return me(!1)})),ct()},ct=function(){oe(!0),(0,x.Z)({method:"post",url:"tas/room/getmonthroomdata",data:{pageIndex:Tn,pageSize:On,model:{currentDate:b()(ye).format("YYYY-MM-DD"),roomId:je.Id,keyword:qn.getFieldValue("keyword")}}}).then((function(e){Vn(e.data.data),kn(e.data.totalcount)})).catch((function(e){})).then((function(){return oe(!1)}))},ut=(0,r.useCallback)((function(e,n,t,a,l){if(!e)return null;var s=e[n];return s?(0,E.jsx)(o.Tooltip,{title:(0,E.jsx)(D.Link,{to:"/tas/roomcalendar/".concat(s.RoomId,"/").concat(Q,"?employeeId=").concat(null===t||void 0===t?void 0:t.Id),children:(0,E.jsx)("span",{className:"text-blue-500 hover:underline",children:s.RoomNumber})}),children:(0,E.jsxs)("button",{className:"flex-1 flex items-center justify-center text-[13px] bg-gray-200 relative",onClick:function(){return ft(a.columnIndex,t.Id,a)},children:[null!==l&&void 0!==l&&l.find((function(e){return _e.Id===a.data.Id&&e.date===b()(ye).date(a.columnIndex-6).format("YYYY-MM-DD")}))?(0,E.jsx)("div",{className:"absolute z-[90] inset-0 p-1 text border-[1px] border-red-500 flex bg-white bg-opacity-40 "}):null,(0,E.jsx)(I.FKN,{color:"gray"})]})}):void 0}),[Q,_e,ye]),mt=r.memo((function(e){var n,t,a,l,s,i=e.e,r=e.date,d=(e.currentDate,e.selectedItems),c=r,u=null===(n=i.data)||void 0===n||null===(t=n.OccupancyData[c])||void 0===t?void 0:t.ShiftColor,m=null===(a=i.data)||void 0===a?void 0:a.OccupancyData[c],x=Object.keys(null===(l=i.data)||void 0===l?void 0:l.AnotherRoomData).length>0?null===(s=i.data)||void 0===s?void 0:s.AnotherRoomData:null;return(0,E.jsx)("div",{className:"h-[26px] flex",style:null!==d&&void 0!==d&&d.find((function(e){return _e.Id===i.data.Id&&e.date===b()(ye).date(i.columnIndex-5).format("YYYY-MM-DD")}))?{borderColor:"red"}:{},children:i.value?(0,E.jsx)(o.Tooltip,{title:null===m||void 0===m?void 0:m.transporScheduleCode,children:(0,E.jsxs)("div",{className:"relative cursor-pointer py-1 text-[11px] border-x flex-1 flex items-center justify-center",style:{backgroundColor:u,color:(0,Y.Z)(u)>60?"black":"white"},onClick:function(){return ft(i.columnIndex,i.data.Id,i)},children:[null!==d&&void 0!==d&&d.find((function(e){return _e.Id===i.data.Id&&e.date===b()(ye).date(i.columnIndex-6).format("YYYY-MM-DD")}))?(0,E.jsx)("div",{className:"absolute z-[90] inset-0 p-1 text border-[1px] border-red-500 flex bg-white bg-opacity-40 "}):"",(0,E.jsx)("span",{className:"relative z-[100]",children:i.value})]})}):ut(x,c,i.data,i,d)})})),xt=(0,r.useCallback)((function(e){bn(e),pn(!0)}),[]),pt=(0,r.useMemo)((function(){var e=[{label:"#",name:"Id",alignment:"left",width:50,fixed:!0,cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] bg-transparent",children:e.value})}},{label:"Employee",name:"Firstname",alignment:"left",width:"150px",fixed:!0,cellRender:function(e){var n;return(0,E.jsx)("div",{className:"flex items-center gap-3 group",children:(0,E.jsxs)("div",{id:"emp".concat(e.data.Id),className:"flex items-center gap-1",children:[e.data.RoomOwner?(0,E.jsx)("i",{className:"dx-icon-home text-green-500"}):(0,E.jsx)(o.Tooltip,{title:e.data.RoomNumber&&(0,E.jsx)(D.Link,{to:"/tas/roomcalendar/".concat(e.data.RoomId,"/").concat(Q),children:(0,E.jsx)("span",{className:"text-blue-500 hover:underline",children:null===(n=e.data)||void 0===n?void 0:n.RoomNumber})}),color:"white",overlayInnerStyle:{color:"black",fontSize:"12px"},children:(0,E.jsx)("i",{className:"dx-icon-home text-gray-400 text-[14px]"})}),1===e.data.Gender?(0,E.jsx)(R.FaMale,{size:14,className:"text-blue-600"}):(0,E.jsx)(R.FaFemale,{size:14,className:"text-pink-500"}),(0,E.jsx)(D.Link,{to:"/tas/roomassign/".concat(e.data.Id,"?startDate=").concat(Q,"&endDate=").concat(b()(Q).add(1,"M").endOf("month").format("YYYY-MM-DD")),className:"cursor-pointer",style:{fontSize:"12px"},children:(0,E.jsxs)("span",{className:(0,O.m6)("whitespace-pre-wrap hover:underline text-blue-500","".concat(e.data.Id)===tt.get("employeeId")?"text-black bg-[#ffff05] ":""),children:[e.value," ",e.data.Lastname]})})]})})}},{label:"SAPID",name:"SAPID",alignment:"left",fixed:!0,width:"auto",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] px-1",children:e.value})}},{label:"Department",name:"DepartmentName",alignment:"left",fixed:!0,width:"150px",cellRender:function(e){var n;return(0,E.jsx)(o.DepartmentTooltip,{showStatus:!1,id:null===(n=e.data)||void 0===n?void 0:n.DepartmentId,children:(0,E.jsx)("span",{className:"text-[12px] px-1 whitespace-pre-wrap flex",children:e.value})})}},{label:"Employer",name:"EmployerName",alignment:"left",fixed:!0,width:"auto",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] px-1 w-full",children:e.value})}},{label:"Res Type",name:"PeopleTypeCode",alignment:"left",width:"auto",fixed:!0,cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] px-1",children:e.value})}},{label:"Position",name:"PositionName",alignment:"left",fixed:!0,width:"auto",cellRender:function(e){return(0,E.jsx)("span",{className:"text-[12px] px-1 flex whitespace-pre-wrap",children:e.value})}}];return S(ye,b()(ye).add(1,"M").endOf("month")).map((function(n,t){var a=b()(n).format("D"),l=b()(n).format("dd");e.push({label:n.split("-")[2],headerCellRender:function(e,t){return b()().format("YYYY-MM-DD")===n?(0,E.jsxs)("button",{className:"text-blue-500 font-bold",onClick:function(){return xt(n)},children:[(0,E.jsx)("div",{className:"font-semibold",children:a}),(0,E.jsx)("div",{className:"text-[10px] leading-none",children:l})]}):(0,E.jsxs)("span",{className:"",onClick:function(){return xt(n)},children:[(0,E.jsx)("div",{className:"font-semibold",children:a}),(0,E.jsx)("div",{className:"text-[10px] leading-none",children:l})]})},name:"OccupancyData.".concat(n,".ShiftCode"),alignment:"center",width:30,cellRender:function(e){return(0,E.jsx)(mt,{e:e,date:n,currentDate:ye,selectedItems:fe})}})})),e}),[ye,fe,tt]),ft=(0,r.useCallback)((function(e,n,t){var a=b()(ye).date(e-6).format("YYYY-MM-DD");if((null===_e||void 0===_e?void 0:_e.Id)===t.data.Id)if(fe.length>=2)he([{date:a}]);else if(1===fe.length)if(fe[0].date===a)he([]);else{var l=function(e,n){for(var t=new Date(e),a=new Date(n),l=[];t<=a;)l.push(b()(t).format("YYYY-MM-DD")),t.setDate(t.getDate()+1);return l}(fe[0].date,a),o=[],s=!1;l.map((function(e){t.data.OccupancyData[e]||t.data.AnotherRoomData[e]?s||o.push({date:e}):s=!0})),he(o)}else 0===fe.length&&he([{date:a,shift:t.value}]);else Ge(t.data),he([{date:a,shift:t.value}])}),[fe,_e,ye]),ht=(0,r.useCallback)((function(){we(b()(ye).subtract(1,"month"))}),[ye]),vt=(0,r.useCallback)((function(){we(b()(ye).add(1,"month"))}),[ye]),bt=(0,r.useCallback)((function(e){Me(e),Be(!0)}),[]),jt=[{label:"Camp",name:"CampId",className:"col-span-6 mb-2",type:"select",inputprops:{options:null===(n=Xn.referData)||void 0===n?void 0:n.camps}},{label:"Room Number",name:"RoomNumber",className:"col-span-6 mb-2"},{label:"Room Type",name:"RoomTypeId",className:"col-span-6 mb-2",type:"select",depindex:"CampId",inputprops:{optionsurl:"tas/roomtype?active=1&campId=",loading:Xn.customLoading,optionvalue:"Id",optionlabel:"Description"}},{label:"Bed Count",name:"bedCount",className:"col-span-6 mb-2",type:"number",inputprops:{min:0}},{label:"Private",name:"Private",className:"col-span-6 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],gt=[{label:"Room Number",name:"roomNumber",width:"150px"},{label:"Bed #",name:"BedCount",alignment:"left"},{label:"Owners",name:"RoomOwners",alignment:"left"},{label:"On Site Employees",name:"Employees",alignment:"left"},{label:"Owner In Date",name:"OwnerInDate",alignment:"center",cellRender:function(e){var n=e.value;return(0,E.jsx)("div",{children:n?b()(n).format("YYYY-MM-DD HH:mm"):"-"})}},{label:"",name:"action",width:"90px",cellRender:function(e){return(0,E.jsx)("div",{className:"flex gap-4",children:(0,E.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return bt(e.data)},children:"Select"})})}}],Nt=[{label:"Date",name:"EventDate",cellRender:function(e){return(0,E.jsx)("div",{children:b()(e.value).format("YYYY-MM-DD")})}},{label:"Room Number",name:"RoomNumber",cellRender:function(e){return(0,E.jsx)("div",{children:e.value})}},{label:"Bed Number",name:"BedDescr"}],Dt=(0,r.useCallback)((function(e){e&&"data"===(null===e||void 0===e?void 0:e.rowType)&&tt.get("empId")==(null===e||void 0===e?void 0:e.data.Id)&&e.rowElement.classList.add("focused-row-by-person")}),[tt]),yt=(0,r.useCallback)((function(){pn(!1)}),[]),wt=(0,r.useCallback)((function(){Ce(!1),We([])}),[]),It=[null===(t=Xn.referData)||void 0===t||null===(v=t.noRoomId)||void 0===v?void 0:v.Id,null===(j=Xn.referData)||void 0===j||null===(g=j.noRoomId)||void 0===g?void 0:g.NoAccommdationId,null===(Z=Xn.referData)||void 0===Z||null===(M=Z.noRoomId)||void 0===M?void 0:M.KhanbogdRoomId].includes(parseInt(q)),Rt=(0,r.useMemo)((function(){var e,n=null!==In&&void 0!==In&&null!==(e=In.BedInfo[0])&&void 0!==e&&e.EventDate?b()(In.BedInfo[0].EventDate).format("YYYY-MM-DD"):b()().format("YYYY-MM-DD");return"/tas/roomcalendar/".concat(null===Ze||void 0===Ze?void 0:Ze.RoomId,"/").concat(n,"?employeeId=").concat(null===_e||void 0===_e?void 0:_e.Id)}),[_e,fe]);return(0,E.jsxs)("div",{className:"rounded-ot bg-white p-5 mb-5 shadow-md",children:[(0,E.jsx)(o.Button,{className:"mb-4",icon:(0,E.jsx)(p.Z,{}),onClick:function(){return nt(-1)},children:"Back"}),(0,E.jsx)("div",{className:"mb-5",children:(0,E.jsxs)("div",{className:"xl:col-span-8 2xl:col-span-6",children:[(0,E.jsx)("div",{className:"text-lg font-bold mb-3",children:"View Room Booking"}),(0,E.jsxs)("div",{className:"flex justify-between mb-4 items-center",children:[(0,E.jsxs)("div",{className:"flex gap-5",children:[(0,E.jsxs)("div",{className:"flex",children:[(0,E.jsx)("div",{className:"border border-[#d9d9d9] flex items-center px-3 bg-gray-50 text-gray-600 border-r-0 rounded-l-[6px]",children:je&&(0,E.jsxs)("div",{className:"text-xs",children:[(0,E.jsxs)("span",{children:[null===je||void 0===je?void 0:je.Number," (",null===je||void 0===je?void 0:je.BedCount,")"]}),(0,E.jsxs)("span",{children:[" / ",null===je||void 0===je?void 0:je.RoomTypeName," / "]}),(0,E.jsxs)("span",{children:[null===je||void 0===je?void 0:je.CampName," /"]})]})}),(0,E.jsx)(o.Button,{className:"rounded-l-none border",onClick:function(){return de(!0)},children:"Select Room"})]}),(0,E.jsxs)("div",{className:"flex gap-1",children:[(0,E.jsx)(o.Button,{onClick:ht,icon:(0,E.jsx)(p.Z,{})}),(0,E.jsx)(c.Z,{picker:"month",value:ye,onChange:function(e){return we(e)},allowClear:!1}),(0,E.jsx)(o.Button,{onClick:vt,icon:(0,E.jsx)(f.Z,{})})]})]}),It?null:(0,E.jsx)(o.Button,{onClick:function(){return Kn(!0)},children:"Audit"})]})]})}),![null===(T=Xn.referData)||void 0===T||null===(F=T.noRoomId)||void 0===F?void 0:F.Id,null===(P=Xn.referData)||void 0===P||null===(A=P.noRoomId)||void 0===A?void 0:A.NoAccommdationId,null===(V=Xn.referData)||void 0===V||null===(_=V.noRoomId)||void 0===_?void 0:_.KhanbogdRoomId].includes(parseInt(q))&&(0,E.jsx)(w.Z,{data:null===ee||void 0===ee?void 0:ee.sort((function(e,n){return e.futureTransportDate<n.futureTransportDate?-1:e.futureTransportDate>n.futureTransportDate?1:0})),columns:L,focusedRowEnabled:!1,showColumnLines:!0,className:"border-t",containerClass:"shadow-none flex-1 border pb-2 mb-5",keyExpr:"RoomId",pager:ee.length>20,sorting:!1,title:(0,E.jsx)("div",{className:"flex justify-between items-end gap-5 my-2 font-bold",children:"Owners"})}),(0,E.jsxs)("div",{className:"border rounded-ot",id:"c-table",children:[(0,E.jsx)(i.LoadPanel,{visible:le,position:{of:"#c-table"}}),(0,E.jsx)(w.Z,{ref:et,dataSource:An,columns:pt,keyExpr:"Id",showColumnLines:!0,showRowLines:!0,containerClass:"shadow-none flex-1 border-none",rowAlternationEnabled:!1,pager:!1,paging:!1,sorting:!1,tableClass:"max-h-[calc(100vh-350px)] border-t",columnMinWidth:30,onRowPrepared:Dt,title:(0,E.jsx)("div",{className:"flex flex-col",children:(0,E.jsxs)("div",{className:"flex justify-between items-center gap-5 my-2",children:[(0,E.jsxs)("div",{className:"flex items-center gap-5",children:[(0,E.jsx)("div",{className:"font-bold",children:"On Site Employees"}),(0,E.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[(0,E.jsx)("i",{className:"dx-icon-home text-green-500"}),"Owner"]}),(0,E.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[(0,E.jsx)("i",{className:"dx-icon-home text-gray-400"}),"Guest"]}),(0,E.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[(0,E.jsx)(I.FKN,{color:"gray"}),"In Another Room"]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-5",children:[(0,E.jsx)(o.Form,{form:qn,className:"flex",onFinish:function(e){oe(!0),(0,x.Z)({method:"post",url:"tas/room/getmonthroomdata",data:{pageIndex:0,pageSize:On,model:{currentDate:b()(ye).format("YYYY-MM-DD"),roomId:je.Id,keyword:e.keyword}}}).then((function(e){Vn(e.data.data),kn(e.data.totalcount)})).catch((function(e){})).then((function(){return oe(!1)}))},children:(0,E.jsx)(o.Form.Item,{name:"keyword",className:"mb-0",children:(0,E.jsx)(u.Z,{placeholder:"Search by keywords",width:300})})}),(0,E.jsx)(o.Button,{type:"primary",onClick:it,loading:ln,disabled:0===fe.length,children:"Change Room"})]})]})})}),(0,E.jsx)(o.Pagination,{data:An,onChangePageSize:function(e){return Ln(e)},onChangePageIndex:function(e){return Fn(e)},pageSize:On,pageIndex:Tn,totalCount:Sn,isPagination:Sn>10,pageSizeDisabled:!0,containerClass:"shadow-none"})]}),(0,E.jsx)(o.Modal,{open:re,onCancel:function(){return de(!1)},title:"Room",width:900,children:(0,E.jsx)(o.RoomSearch,{onSelect:function(e){return rt(e)}})}),(0,E.jsx)(o.Modal,{open:Ye,onCancel:wt,title:"Change Room /".concat(null===(G=fe[0])||void 0===G?void 0:G.date).concat(fe.length>1?" - ".concat(null===(U=fe[fe.length-1])||void 0===U?void 0:U.date):"","/"),width:900,children:(0,E.jsxs)("div",{children:[(0,E.jsx)(o.Form,{form:Wn,fields:jt,className:"border rounded-ot p-4 gap-x-8 mb-5",onFinish:function(e){fe.map((function(e){return e.date}));Xe(!0),(0,x.Z)({method:"post",url:"tas/room/findavailablebydates",data:(0,a.Z)((0,a.Z)({},e),{},{Private:e.Private,StartDate:fe[0].date,EndDate:fe[fe.length-1].date})}).then((function(e){We(e.data)})).catch((function(e){})).then((function(){return Xe(!1)}))},initValues:{Private:null},children:(0,E.jsx)("div",{className:"col-span-12 flex justify-end",children:(0,E.jsx)(o.Button,{htmlType:"submit",icon:(0,E.jsx)(h.Z,{}),disabled:!dn,loading:Qe,children:"Search"})})}),(0,E.jsx)(o.Table,{containerClass:"shadow-none border",columns:gt,data:He,allowColumnReordering:!1,loading:le,keyExpr:"RoomId",focusedRowEnabled:!1,showRowLines:!0,scrolling:!0,tableClass:"max-h-[400px]",pager:!0,renderDetail:{enabled:!0,component:function(e){var n,t;return(0,E.jsx)(o.ExpandRowRoomDetail,{selectedItems:fe,startDate:null===(n=fe[0])||void 0===n?void 0:n.date,endDate:null===(t=fe[(null===fe||void 0===fe?void 0:fe.length)-1])||void 0===t?void 0:t.date,propData:e})}}})]})}),(0,E.jsxs)(s.GI,{visible:Ee,showTitle:!1,height:"auto",width:470,children:[(0,E.jsxs)("div",{children:["Are you sure to change the room assignment for ",(0,E.jsxs)("b",{className:"mr-1",children:["#",null===_e||void 0===_e?void 0:_e.Id," ",null===_e||void 0===_e?void 0:_e.Firstname," ",null===_e||void 0===_e?void 0:_e.Lastname]}),"from ",(0,E.jsx)("b",{children:null===je||void 0===je?void 0:je.Number})," room to ",(0,E.jsx)("span",{className:"text-success font-bold",children:null===Ze||void 0===Ze?void 0:Ze.roomNumber})," room on the following days ?",(0,E.jsx)("br",{}),"Dates: ",(0,E.jsxs)("b",{children:[null===(K=fe[0])||void 0===K?void 0:K.date,fe.length>1?" - ".concat(null===(H=fe[fe.length-1])||void 0===H?void 0:H.date):""]})]}),(0,E.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,E.jsx)(o.Button,{type:"success",onClick:function(){ze(!0);var e=fe.map((function(e){return b()(e.date).format("YYYY-MM-DD")}));(0,x.Z)({method:"post",url:"tas/employeestatus/changeroombydates",data:{employeeId:null===_e||void 0===_e?void 0:_e.Id,dates:e,roomId:null===Ze||void 0===Ze?void 0:Ze.RoomId}}).then((function(e){Be(!1),Ce(!1),dt(),he([]),Dn(!0),Rn(e.data)})).catch((function(e){})).then((function(){return ze(!1)}))},loading:Pe,children:"Yes"}),(0,E.jsx)(o.Button,{onClick:function(){return Be(!1)},disabled:Pe,children:"No"})]})]}),(0,E.jsx)(o.Modal,{open:Nn,onCancel:function(){return Dn(!1)},title:"Room Changed",width:700,children:(0,E.jsxs)("div",{className:"mb-5",children:[(0,E.jsxs)("div",{className:"border rounded-ot p-3 flex justify-between",children:[(0,E.jsxs)("div",{className:"flex flex-col",children:[(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("div",{children:"Fullname:"}),(0,E.jsx)(D.Link,{to:"/tas/people/search/".concat(null===In||void 0===In?void 0:In.EmployeeId),children:(0,E.jsxs)("span",{className:"cursor-pointer text-blue-500 hover:underline flex gap-2 items-center",children:[null===In||void 0===In?void 0:In.Firstname," ",null===In||void 0===In?void 0:In.Lastname]})})]}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("div",{children:"Department:"}),(0,E.jsx)("div",{children:null===In||void 0===In?void 0:In.DepartmentName})]}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("div",{children:"Employer:"}),(0,E.jsx)("div",{children:null===In||void 0===In?void 0:In.EmployerName})]}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("div",{children:"Resource Type:"}),(0,E.jsx)("div",{children:null===In||void 0===In?void 0:In.PeopleTypeCode})]})]}),(0,E.jsxs)("div",{children:[null!==In&&void 0!==In&&In.RoomOwner?(0,E.jsxs)("div",{children:[(0,E.jsx)("i",{className:"dx-icon-home text-green-500"})," Owner"]}):(0,E.jsxs)("div",{children:[(0,E.jsx)("i",{className:"dx-icon-home text-gray-400"})," Not Owner"]}),1===(null===In||void 0===In?void 0:In.Gender)?(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(R.FaMale,{className:"text-blue-600"}),"Male"]}):(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(R.FaFemale,{className:"text-pink-500"}),"Female"]})]})]}),(0,E.jsx)("div",{className:"mt-5",children:(0,E.jsx)(o.Table,{containerClass:"shadow-none border",columns:Nt,data:null===In||void 0===In?void 0:In.BedInfo,allowColumnReordering:!1,loading:le,keyExpr:"RoomId",pager:(null===In||void 0===In||null===(W=In.BedInfo)||void 0===W?void 0:W.length)>20,focusedRowEnabled:!1,showRowLines:!0,title:(0,E.jsx)("div",{className:"border-b text-sm font-bold py-2",children:"Booked Data"})})}),(null===In||void 0===In?void 0:In.BedInfo.length)>0?(0,E.jsx)("div",{className:"mt-5 flex justify-center",children:(0,E.jsx)(D.Link,{to:Rt,target:"_blank",children:(0,E.jsx)(o.Button,{type:"primary",children:"View Booking"})})}):null]})}),(0,E.jsx)(m.Z,{title:(0,E.jsxs)("div",{className:"flex gap-3 items-center",children:[null===je||void 0===je?void 0:je.Number," ",(0,E.jsx)("span",{className:"text-gray-400",children:vn})]}),open:xn,footer:!1,onClose:yt,width:700,children:(0,E.jsx)(B,{date:vn,room:je})}),(0,E.jsx)(z,{roomData:je,open:Un,onCancel:function(){return Kn(!1)}})]})}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[7655],{87655:function(e,t,a){a.r(t);var l=a(1413),n=a(29439),s=a(47313),o=a(2880),c=a(40765),r=a(56573),u=a(65040),i=a(29074),d=a(58467),m=a(2135),p=a(42614),f=a(10658),h=a.n(f),b=a(14261),v=a(42956),x=a(46417);t.default=function(){var e,t,a,f=(0,d.TH)(),y=(0,s.useState)([]),g=(0,n.Z)(y,2),D=g[0],N=g[1],w=(0,s.useState)([]),T=(0,n.Z)(w,2),k=T[0],j=T[1],C=(0,s.useState)(null),I=(0,n.Z)(C,2),q=I[0],E=I[1],Z=(0,s.useState)(!1),S=(0,n.Z)(Z,2),R=S[0],A=S[1],F=(0,s.useState)(!1),M=(0,n.Z)(F,2),H=M[0],L=M[1],V=(0,s.useState)(new v.Z({key:"Id",load:function(e){var t,a="";return(null===(t=e.sort)||void 0===t?void 0:t.length)>1&&(a="?sortby=".concat(e.sort[0].selector,"&sortdirection=").concat(e.sort[0].desc?"desc":"asc")),(0,r.Z)({method:"post",url:"tas/requestdocument/documentlist/cancelled".concat(a),data:{model:e.filter?(0,l.Z)({},e.filter):{startDate:"",endDate:"",Firstname:"",documentType:"",employerId:null,assignedEmployeeId:null,requestedEmployeeId:null,lastModifiedDate:""},pageIndex:e.skip/e.take,pageSize:e.take}}).then((function(e){return{data:e.data.data,totalCount:e.data.totalcount}})).catch((function(e){throw e}))}})),Y=(0,n.Z)(V,1)[0],B=(0,s.useContext)(p.V),U=B.state,G=B.action,O=(0,d.s0)(),z=u.Z.useForm(),P=(0,n.Z)(z,1)[0],_=(0,s.useRef)(null);(0,s.useEffect)((function(){f.state&&P.setFieldValue(f.state.name,f.state.value),K(),J(),G.changeMenuKey("/request/cancelrequest")}),[]);var K=function(){(0,r.Z)({method:"get",url:"tas/requestgroupemployee"}).then((function(e){var t=[];e.data.map((function(e){t.push({value:e.EmployeeId,label:e.FullName})})),N(t)})).catch((function(e){}))},J=function(){(0,r.Z)({method:"get",url:"tas/requestgroup"}).then((function(e){var t=[];e.data.map((function(e){t.push({value:e.Id,label:e.Description})})),j(t)})).catch((function(e){}))},Q=[{label:"Start Date",name:"StartDate",className:"col-span-6 xl:col-span-4 mb-2",type:"date",inputprops:{className:"w-full"}},{label:"End Date",name:"EndDate",className:"col-span-6 xl:col-span-4 mb-2",type:"date",inputprops:{className:"w-full"}},{label:"Request #",name:"Id",className:"col-span-6 xl:col-span-4 mb-2",type:"number",inputprops:{className:"w-full"}},{label:"Document",name:"DocumentType",className:"col-span-6 xl:col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(e=U.referData)||void 0===e||null===(t=e.master)||void 0===t?void 0:t.documentTypes}},{label:"Approvel Type",name:"ApprovelType",className:"col-span-6 xl:col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:k}},{label:"Last Modified",name:"LastModifiedDate",className:"col-span-6 xl:col-span-4 mb-2",type:"date",inputprops:{className:"w-full"}},{label:"Assigned To",name:"AssignedEmployeeId",className:"col-span-6 xl:col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:D}},{label:"Employer",name:"EmployerId",className:"col-span-6 xl:col-span-4 mb-2",type:"select",inputprops:{className:"w-full",options:null===(a=U.referData)||void 0===a?void 0:a.employers}},{label:"Requested By",name:"RequestedEmployeeId",className:"col-span-6 xl:col-span-4 mb-2",type:"select",inputprops:{className:"max-w-[300px]",options:D}}],W=(0,s.useCallback)((function(e){E(e),A(!0)}),[]),X=(0,s.useCallback)((function(){L(!0),(0,r.Z)({method:"delete",url:"tas/requestdocument/remove",data:{documentId:q.Id}}).then((function(){A(!1)})).catch((function(e){})).then((function(){return L(!1)}))}),[q,_]),$=(0,s.useMemo)((function(){return[{label:"DaysAway",name:"DaysAway",dataType:"string",width:"75px",alignment:"center"},{label:"Request #",name:"Id",dataType:"string",width:"75px",alignment:"center"},{label:"CurrentStatus",name:"CurrentStatus",alignment:"left",width:"100px",cellRender:function(e){return(0,x.jsx)(x.Fragment,{children:"Approved"===e.value?(0,x.jsx)(i.Z,{color:"blue",children:e.value}):"Cancelled"===e.value?(0,x.jsx)(i.Z,{color:"error",children:e.value}):"Completed"===e.value?(0,x.jsx)(i.Z,{color:"success",children:e.value}):"Declined"===e.value?(0,x.jsx)(i.Z,{children:e.value}):"Saved"===e.value?(0,x.jsx)(i.Z,{color:"warning",children:e.value}):(0,x.jsx)(i.Z,{color:"orange",children:e.value})})}},{label:"Assigned Group",name:"AssignedGroupName",alignment:"left"},{label:"Document",name:"DocumentType",alignment:"left",width:"120px"},{label:"Employer",name:"EmployerName",alignment:"left"},{label:"Requester",name:"RequesterFullName",alignment:"left"},{label:"Assigned To",name:"AssignedEmployeeFullName",alignment:"left"},{label:"Date Requested",name:"RequestedDate",alignment:"left",cellRender:function(e){return(0,x.jsx)("div",{children:h()(e.value).format("YYYY-MM-DD ddd HH:mm")})}},{label:"Subject",name:"EmployeeFullName",alignment:"left"},{label:"Updated",name:"UpdateInfo",alignment:"left"},{label:"",name:"",width:"150px",alignment:"center",showInColumnChooser:!1,cellRender:function(e){return(0,x.jsxs)("div",{className:"flex items-center gap-3",children:[(0,x.jsx)(m.Link,{to:te(e),children:(0,x.jsx)("button",{type:"button",className:"edit-button",children:"View"})}),(0,x.jsx)("button",{type:"button",className:"dlt-button",onClick:function(){return W(e.data)},children:"Delete"})]})}}]}),[]),ee=(0,s.useCallback)((function(e){var t;null===(t=_.current)||void 0===t||t.instance.filter(e)}),[_]),te=(0,s.useCallback)((function(e){if("Non Site Travel"===e.data.DocumentType)return"/request/task/nonsitetravel/".concat(e.data.Id);if("Profile Changes"===e.data.DocumentType)return"/request/task/profilechanges/".concat(e.data.Id);if("De Mobilisation"===e.data.DocumentType)return"/request/task/de-mobilisation/".concat(e.data.Id);if("Site Travel"===e.data.DocumentType){if("ADD"===e.data.DocumentTag)return"/request/task/sitetravel/addtravel/".concat(e.data.Id);if("RESCHEDULE"===e.data.DocumentTag)return"/request/task/sitetravel/reschedule/".concat(e.data.Id);if("REMOVE"===e.data.DocumentTag)return"/request/task/sitetravel/remove/".concat(e.data.Id)}}),[]),ae=(0,s.useCallback)((function(e){"Non Site Travel"===e.data.DocumentType?O("/request/task/nonsitetravel/".concat(e.data.Id)):"Profile Changes"===e.data.DocumentType?O("/request/task/profilechanges/".concat(e.data.Id)):"De Mobilisation"===e.data.DocumentType?O("/request/task/de-mobilisation/".concat(e.data.Id)):"Site Travel"===e.data.DocumentType&&("ADD"===e.data.DocumentTag?O("/request/task/sitetravel/addtravel/".concat(e.data.Id)):"RESCHEDULE"===e.data.DocumentTag?O("/request/task/sitetravel/reschedule/".concat(e.data.Id)):"REMOVE"===e.data.DocumentTag&&O("/request/task/sitetravel/remove/".concat(e.data.Id)))}),[]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"rounded-t-ot bg-white px-3 py-2 shadow-md border-b",children:[(0,x.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,x.jsx)("div",{className:"text-lg font-bold",children:"Search Task"})}),(0,x.jsx)(o.Form,(0,l.Z)((0,l.Z)({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}}),{},{form:P,fields:Q,className:"grid grid-cols-12 gap-x-8",onFinish:ee,size:"small",wrapperCol:{flex:1},labelCol:{flex:"100px"},children:(0,x.jsx)("div",{className:"col-span-12 flex gap-4 justify-end",children:(0,x.jsx)(o.Button,{htmlType:"submit",icon:(0,x.jsx)(c.Z,{}),children:"Search"})})}))]}),(0,x.jsx)(o.Table,{ref:_,data:Y,columns:$,isHeaderFilter:!1,isSearch:!1,allowColumnReordering:!1,remoteOperations:!0,onRowDblClick:ae,containerClass:"rounded-t-none",tableClass:"max-h-[calc(100vh-280px)]"}),(0,x.jsxs)(b.GI,{visible:R,showTitle:!1,height:110,width:350,children:[(0,x.jsx)("div",{children:"Are you sure you want to delete this record?"}),(0,x.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,x.jsx)(o.Button,{type:"danger",onClick:X,loading:H,children:"Yes"}),(0,x.jsx)(o.Button,{onClick:function(){return A(!1)},disabled:H,children:"No"})]})]})]})}}}]);
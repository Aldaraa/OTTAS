"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[3264],{73264:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var a=n(1413),l=n(45987),r=n(29439),s=n(47313),o=n(2880),i=n(56573),c=n(65040),d=n(74294),u=n(93031),m=n(31283),h=n(58467),x=n(42614),p=n(10658),f=n.n(p),b=n(14261),j=n(58821),v=n(18711),N=n(2135),g=n(46417),Z=[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,g.jsx)("div",{className:"flex items-center justify-center",children:(0,g.jsx)(N.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,g.jsx)("button",{type:"button",className:"text-blue-600 underline",children:e.value})})})}},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,g.jsx)(v.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname"},{label:"Lastname",name:"Lastname"},{label:"SAP #",name:"SAPID",alignment:"left"},{label:"Department",name:"DepartmentName"},{label:"Employer",name:"EmployerName"},{label:"Position",name:"PositionName",cellRender:function(e){return(0,g.jsx)("span",{className:"text-primary2",children:e.value})}},{label:"Roster",name:"RosterName"},{label:"Resource Type",name:"PeopleTypeName"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,g.jsx)("span",{children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,g.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,g.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",cellRender:function(e){return(0,g.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,g.jsx)(j.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",cellRender:function(e,t){return(0,g.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,g.jsx)("i",{className:"dx-icon-home"})}}],D=["key","name"];var y=function(){var e=(0,h.TH)(),t=(0,s.useState)(!1),n=(0,r.Z)(t,2),p=n[0],b=n[1],j=(0,s.useState)([]),v=(0,r.Z)(j,2),N=v[0],y=v[1],C=(0,s.useState)([]),w=(0,r.Z)(C,2),I=w[0],P=w[1],F=(0,s.useState)(!1),S=(0,r.Z)(F,2),R=S[0],k=S[1],E=(0,s.useContext)(x.V).state,M=c.Z.useForm(),V=(0,r.Z)(M,1)[0],L=c.Z.useForm(),Y=(0,r.Z)(L,1)[0],T=(0,s.useRef)(null);(0,s.useEffect)((function(){e.state&&V.setFieldValue(e.state.name,e.state.value)}),[]),(0,s.useEffect)((function(){Y.setFieldsValue({rosters:N})}),[N]);var U=function(e,t){var n,a;null===(n=Y.getFieldsValue())||void 0===n||null===(a=n.rosters)||void 0===a||a.forEach((function(n,a){Y.setFieldValue(["rosters",a,t],e)}))},A=function(){k(!1),P(Y.getFieldValue("rosters")),y(Y.getFieldValue("rosters"))};return(0,g.jsxs)("div",{children:[(0,g.jsx)(o.PeolpeSelectionTable,{ref:T,onSelect:function(e){P(e)},onReturn:function(){var e=I.map((function(e){return{Fullname:"".concat(e.Firstname," ").concat(e.Lastname),Id:e.Id,PositionName:e.PositionName,PositionId:e.PositionId}}));y(e),k(!0)},selectedRowsData:I,columns:Z,searchDefaultValues:{Active:1},hideFields:["Active"]}),(0,g.jsxs)(o.Modal,{open:R,onCancel:A,title:(0,g.jsxs)("div",{children:["Change Position ",(0,g.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",N.length," people selected)"]})]}),width:1e3,forceRender:!0,children:[(0,g.jsx)(c.Z,{form:Y,size:"small",onFinish:function(e){b(!0);var t=e.rosters.map((function(e){return{DataId:e.PositionId,StartDate:e.StartDate?f()(e.StartDate).format("YYYY-MM-DD"):"",EndDate:e.profileUpdate?null:f()(e.EndDate).format("YYYY-MM-DD"),EmployeeId:e.Id,profileUpdate:e.profileUpdate?1:0}}));(0,i.Z)({method:"put",url:"tas/employee/changedata/position",data:t}).then((function(e){var t;k(!1),y([]),null===(t=T.current)||void 0===t||t.instance.clearSelection(),V.submit()})).catch((function(e){})).then((function(){return b(!1)}))},children:(0,g.jsx)(c.Z.List,{name:"rosters",children:function(e,t){var n,r=t.remove;return(0,g.jsx)("div",{className:"border rounded-ot",children:(0,g.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,g.jsx)("thead",{className:"text-[#959595]",children:(0,g.jsxs)("tr",{className:"text-left",children:[(0,g.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:"Current Position"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,g.jsx)(d.Z,{className:"w-full",options:null===(n=E.referData)||void 0===n?void 0:n.positions,placeholder:"Position",onChange:function(e){return U(e,"PositionId")},allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}}):"Replacement Position"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,g.jsx)(u.Z,{onChange:function(e){return U(e,"StartDate")},placeholder:"Start Date"}):"Start Date"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,g.jsx)(u.Z,{onChange:function(e){return U(e,"EndDate")},placeholder:"End Date"}):"End Date"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,g.jsx)(m.Z,{onChange:function(e){return U(e.target.checked,"profileUpdate")},children:"Permanent"}):"Permanent"}),(0,g.jsx)("th",{className:"border-b px-1 font-normal"})]})}),(0,g.jsx)("tbody",{children:e.map((function(e){var t,n=e.key,s=e.name,o=(0,l.Z)(e,D);return(0,g.jsxs)("tr",{className:"".concat((s+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[s,"Id"],className:"mb-0",children:(0,g.jsx)("div",{className:"text-[13px] w-[30px]",children:s+1})}))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[s,"Id"],className:"mb-0",children:(0,g.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",s,"Id"])})}))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{className:"mb-0",children:(0,g.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",s,"Fullname"])})}))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{className:"mb-0",children:(0,g.jsx)("div",{className:"text-[13px]",children:Y.getFieldValue(["rosters",s,"PositionName"])})}))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,(0,a.Z)((0,a.Z)({},o),{},{name:[s,"PositionId"],className:"mb-0",rules:[{required:!0,message:"Missing position"}],children:(0,g.jsx)(d.Z,{options:null===(t=E.referData)||void 0===t?void 0:t.positions,placeholder:"Position",allowClear:!0,showSearch:!0,popupMatchSelectWidth:!1,filterOption:function(e,t){var n;return(null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())}})}))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,{name:[s,"StartDate"],className:"mb-0",children:(0,g.jsx)(u.Z,{placeholder:"Start Date"})},"startDate-".concat(n))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)(c.Z.Item,{name:[s,"EndDate"],className:"mb-0",children:(0,g.jsx)(u.Z,{placeholder:"End Date"})},"endDate-".concat(n))}),(0,g.jsx)("td",{className:"py-1 border-t px-1 text-center",children:(0,g.jsx)(c.Z.Item,{name:[s,"profileUpdate"],className:"mb-0",valuePropName:"checked",children:(0,g.jsx)(m.Z,{})},"profileUpdate-".concat(n))}),(0,g.jsx)("td",{className:"py-1 border-t px-1",children:(0,g.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){!function(e){var t;null===(t=T.current)||void 0===t||t.instance.deselectRows([e])}(Y.getFieldValue(["rosters",s,"Id"])),r(s)},children:"Remove"})})]})}))})]})})}})}),N.length>0&&(0,g.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,g.jsx)(o.Button,{type:"primary",onClick:function(){return Y.submit()},loading:p,children:"Process"}),(0,g.jsx)(o.Button,{onClick:A,disabled:p,children:"Cancel"})]})]})]})}}}]);
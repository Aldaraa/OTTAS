"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[8497],{38497:function(e,t,a){a.r(t);var n=a(29439),r=a(93031),l=a(56573),d=a(2880),s=a(42614),o=a(10658),i=a.n(o),c=a(47313),u=a(58467),m=a(2135),f=a(73030),h=a(76629),v=a(46417);t.default=function(){var e=(0,c.useState)([]),t=(0,n.Z)(e,2),a=t[0],o=t[1],p=(0,c.useState)(!1),x=(0,n.Z)(p,2),b=x[0],D=x[1],j=(0,c.useState)([]),N=(0,n.Z)(j,2),I=N[0],Y=N[1],C=d.Form.useForm(),g=(0,n.Z)(C,1)[0],S=(0,u.UO)().employeeId,y=(0,c.useContext)(s.V).state;(0,c.useEffect)((function(){h.Z.set("pp_rt","audit"),w()}),[]);var w=function(){D(!0);var e=g.getFieldsValue();(0,l.Z)({method:"get",url:"tas/audit/profileaudit/".concat(S,"?").concat(e.StartDate?"startdate=".concat(i()(e.StartDate).format("YYYY-MM-DD")):"").concat(e.EndDate?"".concat(e.StartDate?"&":"","enddate=").concat(i()(e.EndDate).format("YYYY-MM-DD")):"")}).then((function(e){o(e.data),Y(e.data.AuditData)})).catch((function(e){})).then((function(){return D(!1)}))},F=function(e,t){var a,n,r,l,d,s,o,c,u,m,f,h,v,p,x,b,D,j;switch(t){case"Dob":case"CommenceDate":return e?i()(e).format("YYYY-MM-DD"):"";case"Gender":return e?"Male":"Female";case"EmployerId":return null===(a=y.referData.employers)||void 0===a||null===(n=a.find((function(t){return e===t.Id})))||void 0===n?void 0:n.label;case"LocationId":return null===(r=y.referData.locations)||void 0===r||null===(l=r.find((function(t){return e===t.Id})))||void 0===l?void 0:l.label;case"NationalityId":return null===(d=y.referData.nationalities)||void 0===d||null===(s=d.find((function(t){return e===t.Id})))||void 0===s?void 0:s.label;case"PeopleTypeId":return null===(o=y.referData.peopleTypes)||void 0===o||null===(c=o.find((function(t){return e===t.Id})))||void 0===c?void 0:c.label;case"PositionId":return null===(u=y.referData.positions)||void 0===u||null===(m=u.find((function(t){return e===t.Id})))||void 0===m?void 0:m.label;case"RosterId":return null===(f=y.referData.rosters)||void 0===f||null===(h=f.find((function(t){return e===t.Id})))||void 0===h?void 0:h.label;case"StateId":return null===(v=y.referData.states)||void 0===v||null===(p=v.find((function(t){return e===t.Id})))||void 0===p?void 0:p.label;case"CostCodeId":return null===(x=y.referData)||void 0===x||null===(b=x.costCodes.find((function(t){return e===t.Id})))||void 0===b?void 0:b.label;case"DepartmentId":return null===(D=y.referData.departmentsmini)||void 0===D||null===(j=D.find((function(t){return e===t.Id})))||void 0===j?void 0:j.Name;default:return e}},M=[{label:"Changed User",name:"Username"},{label:"Changed Date",name:"DateCreated",cellRender:function(e){return(0,v.jsx)("div",{children:i()(e.value).format("YYYY-MM-DD")})}}];return(0,v.jsxs)("div",{className:"bg-white rounded-ot p-4 col-span-12 shadow-md",children:[(0,v.jsxs)("div",{className:"flex justify-between mb-3",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"text-lg font-bold",children:"Profile Audit"}),(0,v.jsxs)("div",{className:"text-sm flex gap-4 text-secondary2",children:["Profile created on ",i()(null===a||void 0===a?void 0:a.CreatedDate).format("YYYY-MM-DD")," ",null!==a&&void 0!==a&&a.CreatedFullName?"by ".concat((0,v.jsx)(m.Link,{to:"/tas/people/search/".concat(null===a||void 0===a?void 0:a.CreatedUserId),children:(0,v.jsx)("span",{children:null===a||void 0===a?void 0:a.CreatedFullName})})):null]})]}),(0,v.jsxs)(d.Form,{className:"flex items-center gap-2",form:g,onFinish:w,initValues:{StartDate:i()().subtract(6,"months"),EndDate:i()()},children:[(0,v.jsx)(d.Form.Item,{name:"StartDate",className:"mb-0",children:(0,v.jsx)(r.Z,{placeholder:"Start Date"})}),"-",(0,v.jsx)(d.Form.Item,{name:"EndDate",className:"mb-0",children:(0,v.jsx)(r.Z,{placeholder:"End Date"})}),(0,v.jsx)(d.Button,{htmlType:"button",disabled:b,onClick:function(){return g.submit()},children:"Search"})]})]}),(0,v.jsx)(d.Table,{data:I,columns:M,allowColumnReordering:!1,loading:b,containerClass:"shadow-none border",keyExpr:"Id",tableClass:"max-h-[calc(100vh-400px)]",pager:{showPageSizeSelector:a.length>100},renderDetail:{enabled:!0,component:function(e){var t=e.data,a=JSON.parse(t.data.OldValues),n=JSON.parse(t.data.NewValues),r=[];return n&&(r=Object.keys(n)),(0,v.jsx)("div",{className:"bg-white px-3",children:(0,v.jsxs)("table",{className:"border",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{className:"p-1 px-2 border",children:"Field"}),(0,v.jsx)("th",{className:"p-1 px-2 border",children:"Previous value"}),(0,v.jsx)("th",{className:"p-1 px-2 border",children:"New value"})]})}),(0,v.jsx)("tbody",{children:r.map((function(e,t){return(0,v.jsxs)("tr",{className:(0,f.m6)("hover:bg-blue-100 transition-all",t%2===0?"bg-gray-100":""),children:[(0,v.jsx)("td",{className:"p-1 px-2 border",children:e}),(0,v.jsx)("td",{className:"p-1 px-2 border",children:F(a[e],e)}),(0,v.jsx)("td",{className:"p-1 px-2 border",children:F(n[e],e)})]})}))})]})})}}})]})}}}]);
"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[4910],{14910:function(e,t,n){n.r(t);var a=n(74165),s=n(15861),i=n(1413),c=n(29439),o=n(2880),l=n(14261),r=n(47313),u=n(65040),d=n(56573),m=n(40765),p=n(82138),h=n(92350),f=n(81514),b=n(42614),v=n(46417),x="Cost Code",g=[{label:"Code",name:"Code",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{maxLength:20}},{label:"Number",name:"Number",className:"col-span-12 mb-2",rules:[{required:!0,message:"Number is required"},{min:5,message:"Number must be at least 5 character"}],inputprops:{maxLength:100}},{label:"Description",name:"Description",className:"col-span-12 mb-2",rules:[{required:!0,message:"Description is required"},{min:5,message:"Number must be at least 5 character"}]}],C=[{label:"Code",name:"Code",className:"col-span-12 mb-2",rules:[{required:!0,message:"Code is required"}],inputprops:{maxLength:20}},{label:"Number",name:"Number",className:"col-span-12 mb-2",rules:[{required:!0,message:"Number is required"},{min:5,message:"Number must be at least 5 character"}],inputprops:{maxLength:100}},{label:"Description",name:"Description",className:"col-span-12 mb-2",rules:[{required:!0,message:"Description is required"},{min:5,message:"Number must be at least 5 character"}]},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{}}],N=[{label:"Code",name:"Code",className:"col-span-3 mb-2",inputprops:{}},{label:"Number",name:"Number",className:"col-span-3 mb-2"},{label:"Description",name:"Description",className:"col-span-3 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}];t.default=function(){var e=(0,r.useState)([]),t=(0,c.Z)(e,2),n=t[0],j=t[1],Z=(0,r.useState)([]),y=(0,c.Z)(Z,2),k=y[0],A=y[1],w=(0,r.useState)(null),D=(0,c.Z)(w,2),S=D[0],q=D[1],I=(0,r.useState)(!1),L=(0,c.Z)(I,2),E=L[0],F=L[1],R=(0,r.useState)(!1),B=(0,c.Z)(R,2),O=B[0],T=B[1],V=(0,r.useState)(!1),_=(0,c.Z)(V,2),M=_[0],z=_[1],G=(0,r.useState)(!1),J=(0,c.Z)(G,2),K=J[0],P=J[1],Y=(0,r.useState)(!1),H=(0,c.Z)(Y,2),Q=H[0],U=H[1],W=(0,r.useState)(null),X=(0,c.Z)(W,2),$=X[0],ee=X[1],te=u.Z.useForm(),ne=(0,c.Z)(te,1)[0],ae=u.Z.useForm(),se=(0,c.Z)(ae,1)[0],ie=(0,r.useContext)(b.V).action;(0,r.useEffect)((function(){ie.changeMenuKey("/tas/costcode"),ce()}),[]);var ce=function(){T(!0),(0,d.Z)({method:"get",url:"tas/costcode"}).then((function(e){if(j(e.data),1===se.getFieldValue("Active")){var t=e.data.filter((function(e){return 1===e.Active}));A(t)}else if(0===se.getFieldValue("Active")){var n=e.data.filter((function(e){return 0===e.Active}));A(n)}else A(e.data)})).catch((function(e){})).then((function(){return T(!1)}))},oe=function(){ie.changeLoadingStatusReferItem({costCodes:!0}),(0,d.Z)({method:"get",url:"tas/costcode?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push((0,i.Z)({value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)},e))})),ie.setReferDataItem({costCodes:t})})).catch((function(e){})).then((function(){return ie.changeLoadingStatusReferItem({costCodes:!1})}))},le=function(e){q(e),F(!0)},re=[{label:"Number",name:"Number",width:"200px"},{label:"Code",name:"Code"},{label:"Description",name:"Description"},{label:"# Resource",name:"EmployeeCount",alignment:"left"},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,v.jsx)(l.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"action",width:"265px",cellRender:function(e){return(0,v.jsxs)("div",{className:"flex gap-3",children:[(0,v.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,ee(t),void U(!0);var t},children:"View Audit"}),(0,v.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,q(t),void P(!0);var t},children:"Edit"}),1===e.data.Active?e.data.EmployeeCount>0?(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{id:"target".concat(e.data.Id),className:"dlt-button_lbl",children:"Deactivate"}),(0,v.jsx)(l.u,{target:"#target".concat(e.data.Id),showEvent:"mouseenter",hideEvent:"mouseleave",hideOnOutsideClick:!1,position:"top",children:(0,v.jsx)("div",{children:"Don't deactivate because there is an active Employee"})})]}):(0,v.jsx)("button",{type:"button",disabled:e.data.EmployeeCount>0,className:"dlt-button",onClick:function(){return le(e.data)},children:"Deactivate"}):(0,v.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return le(e.data)},children:"Reactivate"})]})}}],ue=(0,r.useCallback)((function(e){z(!0),S?(0,d.Z)({method:"put",url:"tas/costcode",data:(0,i.Z)((0,i.Z)({},e),{},{Id:S.Id})}).then((function(e){ce(),oe(),pe()})).catch((function(e){})).then((function(){return z(!1)})):(0,d.Z)({method:"post",url:"tas/costcode",data:(0,i.Z)((0,i.Z)({},e),{},{Active:e.Active?1:0})}).then((function(e){ce(),oe(),pe()})).catch((function(e){})).then((function(){return z(!1)}))}),[S]),de=(0,r.useCallback)((function(){z(!0),(0,d.Z)({method:"delete",url:"tas/costcode",data:{id:S.Id}}).then((function(){ce(),oe(),F(!1)})).catch((function(e){})).then((function(){return z(!1)}))}),[S]),me=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(!0),(0,f.Z)(t,n).then((function(e){A(e),T(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=(0,r.useCallback)((function(){P(!1)}),[]),he=(0,r.useCallback)((function(){ee(null),U(!0)}),[]);return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,v.jsx)("div",{className:"text-lg font-bold mb-2",children:x}),(0,v.jsx)("div",{className:"w-full",children:(0,v.jsx)(o.Form,{form:se,fields:N,className:"grid grid-cols-12 gap-x-8",onFinish:me,noLayoutConfig:!0,children:(0,v.jsx)("div",{className:"flex col-span-2 items-baseline",children:(0,v.jsx)(o.Button,{htmlType:"submit",className:"flex items-center",loading:O,icon:(0,v.jsx)(m.Z,{}),children:"Search"})})})})]}),(0,v.jsx)(o.Table,{data:k,columns:re,allowColumnReordering:!1,loading:O,keyExpr:"Id",tableClass:"border-t max-h-[calc(100vh-250px)]",title:(0,v.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,v.jsxs)("div",{className:"flex items-center gap-1",children:[(0,v.jsx)("span",{className:"font-bold",children:k.length}),(0,v.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)(o.Button,{onClick:he,children:"Audit"}),(0,v.jsxs)(o.Button,{icon:(0,v.jsx)(p.Z,{}),onClick:function(){q(null),ne.resetFields(),P(!0)},children:["Add ",x]})]})]})}),(0,v.jsx)(o.Modal,{open:K,onCancel:function(){return P(!1)},title:S?"Edit ".concat(x):"Add ".concat(x),children:(0,v.jsx)(o.Form,{form:ne,fields:S?g:C,editData:S,onFinish:ue,children:(0,v.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,v.jsx)(o.Button,{type:"primary",onClick:function(){return ne.submit()},loading:M,icon:(0,v.jsx)(h.Z,{}),children:"Save"}),(0,v.jsx)(o.Button,{onClick:pe,disabled:M,children:"Cancel"})]})})}),(0,v.jsxs)(l.GI,{visible:E,showTitle:!1,height:110,width:350,children:[(0,v.jsxs)("div",{children:["Are you sure you want to ",1===(null===S||void 0===S?void 0:S.Active)?"deactivate":"reactivate"," this record?"]}),(0,v.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,v.jsx)(o.Button,{type:1===(null===S||void 0===S?void 0:S.Active)?"danger":"success",onClick:de,loading:M,children:"Yes"}),(0,v.jsx)(o.Button,{onClick:function(){return F(!1)},disabled:M,children:"No"})]})]}),(0,v.jsx)(o.AuditTable,{title:"Cost Code Audit",tablename:"CostCode",open:Q,onClose:function(){return U(!1)},record:$,recordName:$?(0,v.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",$.Code," ",$.Description,"/"]}):""})]})}},81514:function(e,t,n){n.d(t,{Z:function(){return o}});var a=n(93433),s=n(4942),i=n(1413);var c=function e(t,n,a){var c=[],o=Object.keys(n);return t.map((function(t){if(t[a].length>0)c.push((0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},a,e(t[a],n,a))));else{var l=!1;o.map((function(e){var a,s;""!==n[e]&&"undefined"!==typeof n[e]&&null!==n[e]?l="string"===typeof n[e]?l||(null===(a=t[e])||void 0===a?void 0:a.toLowerCase().includes(null===(s=n[e])||void 0===s?void 0:s.toLowerCase())):l||t[e]===n[e]:l=!0})),l&&c.push(t)}})),c};function o(e,t,n,s){return"tree"===n?c(t,e,s):new Promise((function(n,s){var i=Object.keys(e),c=(0,a.Z)(t);i.map((function(t){""!==e[t]&&"undefined"!==typeof e[t]&&null!==e[t]&&(c="string"===typeof e[t]?c.filter((function(n){var a,s;return null===(a=n[t])||void 0===a?void 0:a.toLowerCase().includes(null===(s=e[t])||void 0===s?void 0:s.toLowerCase())})):c.filter((function(n){return n[t]===e[t]})))})),n(c)}))}}}]);
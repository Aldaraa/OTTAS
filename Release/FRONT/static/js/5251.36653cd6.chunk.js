"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[5251],{25251:function(e,t,o){o.r(t),o.d(t,{default:function(){return C}});var n=o(93433),a=o(47313),l=o(81404),r=o(165),i=o(30468),d=o(6761),s=o(2880),u=o(10658),p=o.n(u),c=o(46417),m=function(e){var t=new l.Workbook,o=t.addWorksheet("Confirmed Rosters");o.columns=[{width:5},{width:30},{width:25},{width:15},{width:25},{width:40}],(0,i.d)({component:e.component,worksheet:o,keepColumnWidths:!1,topLeftCell:{row:2,column:2},customizeCell:function(e){var t=e.gridCell,o=e.excelCell;if("data"===t.rowType&&"Available"===t.column.name){var n=t.data.Seats-t.data.Confirmed-t.data.OverBooked;o.value=n,n<=0&&(o.font={color:{argb:"FFFF0000"}})}"group"===t.rowType&&(o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"BEDFE6"}}),"totalFooter"===t.rowType&&o.value&&(o.font.italic=!0)}}).then((function(){t.xlsx.writeBuffer().then((function(e){(0,d.p)(new Blob([e],{type:"application/octet-stream"}),"Confirmed_rosters.xlsx")}))}))},f=[{label:"Fullname",name:"FullName",groupIndex:0},{label:"Date",name:"EventDate",width:80,cellRender:function(e){return(0,c.jsx)("span",{children:p()(e.value).format("YYYY-MM-DD")})}},{label:"Transport Code",name:"TransportCode",width:120},{label:"Transport Mode",name:"TransportMode",width:120},{label:"Dir",name:"Direction",width:50},{label:"Shift",name:"ShiftCode",width:50,cellRender:function(e){return(0,c.jsx)("div",{className:"text-center rounded ",style:{background:e.data.ShiftColorCode,color:(0,r.Z)(e.data.ShiftColorCode)>60?"black":"white"},children:e.value})}},{label:"Description",name:"Description"},{label:"Seats",name:"Seats"},{label:"Available seats",name:"Confirmed",cellRender:function(e){var t=e.data,o=t.Seats-t.Confirmed-t.OverBooked;return(0,c.jsx)("div",{className:o<=0?"text-red-400":"text-green-400",children:o})}}],h=function(e){var t=e.data,o=void 0===t?[]:t;return(0,c.jsx)(s.Table,{data:o,columns:f,isGrouping:!0,keyExpr:"EmployeeId",autoExpandAllGroup:!0,tableClass:"max-h-[600px]",export:{enabled:!0},onExporting:m,isGroupedCount:!0})},x=function(e){var t=new l.Workbook,o=t.addWorksheet("Skipped Rosters");o.columns=[{width:5},{width:30},{width:25},{width:15},{width:25},{width:40}],(0,i.d)({component:e.component,worksheet:o,keepColumnWidths:!1,topLeftCell:{row:2,column:2},customizeCell:function(e){var t=e.gridCell,o=e.excelCell;t.rowType,"group"===t.rowType&&(o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"BEDFE6"}}),"totalFooter"===t.rowType&&o.value&&(o.font.italic=!0)}}).then((function(){t.xlsx.writeBuffer().then((function(e){(0,d.p)(new Blob([e],{type:"application/octet-stream"}),"Skipped_roster.xlsx")}))}))},v=[{label:"Fullname",name:"FullName"},{label:"In Date",name:"InTransportDate",cellRender:function(e){var t=e.value;return(0,c.jsx)("span",{children:p()(t).format("YYYY-MM-DD")})}},{label:"Out Date",name:"OutTransportDate",cellRender:function(e){var t=e.value;return(0,c.jsx)("span",{children:p()(t).format("YYYY-MM-DD")})}}],w=function(e){var t=e.data,o=void 0===t?[]:t;return(0,c.jsx)(s.Table,{data:o,columns:v,isGrouping:!0,keyExpr:"EmployeeId",tableClass:"max-h-[600px]",autoExpandAllGroup:!1,export:{enabled:!0},onExporting:x})},b=o(76047);var C=function(e){var t=e.data,o=(0,a.useMemo)((function(){var e,o=(0,n.Z)(new Set(null===t||void 0===t?void 0:t.RosterExecutedEmployees.map((function(e){return e.EmployeeId}))));return[{key:"1",label:"Executed Employee (".concat(o.length,")"),children:(0,c.jsx)(h,{data:null===t||void 0===t?void 0:t.RosterExecutedEmployees})},{key:"2",label:"Skipped (".concat(null===t||void 0===t||null===(e=t.RosterSkippedEmployees)||void 0===e?void 0:e.length,")"),children:(0,c.jsx)(w,{data:t.RosterSkippedEmployees})}]}),[t]);return(0,c.jsx)(b.Z,{items:o,type:"card"})}}}]);
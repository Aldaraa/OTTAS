"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[5364],{15364:function(e,t,o){o.r(t),o.d(t,{default:function(){return H}});var l=o(74165),n=o(15861),a=o(29439),i=o(47313),r=o(56573),s=o(65040),d=o(21975),u=o(74294),c=o(2880),m=o(4942),v=o(1413),p=o(93031),h=o(31283),f=o(42614),x=o(10658),D=o.n(x),I=o(73945),S=o(61033),g=o(26672),b=o(73030),j=o(46417),F=i.memo((function(e){var t=e.children,o=e.run;return(0,j.jsx)("div",{className:(0,b.m6)("origin-center",o?"animate-jump":""),children:t})}));var T=function(e){var t=e.form,o=e.isEdit,l=e.initData,n=(0,i.useState)(!1),s=(0,a.Z)(n,2),u=s[0],m=s[1],v=(0,i.useState)(!1),p=(0,a.Z)(v,2),h=p[0],x=p[1],b=(0,i.useState)(!1),T=(0,a.Z)(b,2),N=T[0],y=T[1],R=(0,i.useContext)(f.V).state,C=(0,i.useMemo)((function(){if(l)return D()(null===l||void 0===l?void 0:l.startDate).diff(null===l||void 0===l?void 0:l.endDate)>0}),[l]);(0,i.useEffect)((function(){null!==l&&void 0!==l&&l.RoomId&&0!==(null===l||void 0===l?void 0:l.ReScheduleId)&&0!==(null===l||void 0===l?void 0:l.existingScheduleId)&&Z()}),[l]);var Z=function(){var e;(0,r.Z)({method:"post",url:"tas/room/findavailablebyroomid",data:{startDate:C?D()(null===l||void 0===l?void 0:l.endDate).format("YYYY-MM-DD"):D()(null===l||void 0===l?void 0:l.startDate).format("YYYY-MM-DD"),endDate:C?D()(null===l||void 0===l?void 0:l.startDate).format("YYYY-MM-DD"):D()(null===l||void 0===l?void 0:l.endDate).format("YYYY-MM-DD"),roomId:null===l||void 0===l?void 0:l.RoomId,EmployeeId:null===(e=R.userProfileData)||void 0===e?void 0:e.Id}}).then((function(e){e.data.status?x(!1):(x(!0),V())})).catch((function(e){}))},w=function(){var e,o=t.getFieldValue("startDate"),n=t.getFieldValue("endDate"),a=t.getFieldValue("RoomId");null!==l&&void 0!==l&&l.RoomId&&(0,r.Z)({method:"post",url:"tas/room/findavailablebyroomid",data:{startDate:C?D()(n).format("YYYY-MM-DD"):D()(o).format("YYYY-MM-DD"),endDate:C?D()(o).format("YYYY-MM-DD"):D()(n).format("YYYY-MM-DD"),roomId:a,EmployeeId:null===(e=R.userProfileData)||void 0===e?void 0:e.Id}}).then((function(e){e.data.status?x(!1):(x(!0),V())})).catch((function(e){}))},V=function(){y(!0),setTimeout((function(){y(!1)}),700)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Form.Item,{label:"Room",className:"col-span-12 mb-2",children:(0,j.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,j.jsx)(c.Form.Item,{name:"RoomId",noStyle:!0}),(0,j.jsx)(c.Form.Item,{name:"RoomNumber",className:"flex-1 mb-0",rules:[{required:!0,message:"Room is required"}],validateStatus:!!h&&"error",help:!!h&&(0,j.jsx)(F,{run:N,children:"Room is not available"}),children:(0,j.jsx)(d.Z,{readOnly:!0})},"form-item-RoomId"),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.RoomId!==t.RoomId},children:function(e){var t,n=e.getFieldValue;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{className:"text-xs py-1 px-2",type:"primary",onClick:function(){return m(!0)},disabled:!o,icon:(0,j.jsx)(S.Z,{})}),null!==l&&void 0!==l&&l.RoomId?(0,j.jsx)(c.Tooltip,{title:"Check room",children:(0,j.jsx)(c.Button,{className:"text-xs py-1 px-2",type:(null===(t=R.userProfileData)||void 0===t?void 0:t.RoomId)!==n("RoomId")?"default":"success",disabled:!n("startDate")||!n("endDate"),icon:(0,j.jsx)(g.FaHouseUser,{size:14}),onClick:w})}):null]})}})]})}),(0,j.jsx)(c.Modal,{open:u,onCancel:function(){return m(!1)},title:"Change Room /".concat(D()(t.getFieldValue("startDate")).format("YYYY-MM-DD")," ").concat(D()(t.getFieldValue("endDate")).format("YYYY-MM-DD"),"/"),width:900,forceRender:!0,children:(0,j.jsx)(I.Z,{form:t,closeModal:function(){return m(!1)},startDate:C?D()(null===l||void 0===l?void 0:l.endDate).format("YYYY-MM-DD"):D()(null===l||void 0===l?void 0:l.startDate).format("YYYY-MM-DD"),endDate:C?D()(null===l||void 0===l?void 0:l.startDate).format("YYYY-MM-DD"):D()(null===l||void 0===l?void 0:l.endDate).format("YYYY-MM-DD"),handleSelect:function(e){t.setFieldValue("RoomId",e.RoomId),t.setFieldValue("RoomNumber",e.roomNumber)}})})]})},N=o(5049),y=function(e){var t,o=e.data,l=e.refreshData,n=e.disabled,x=e.currentGroup,I=e.hasActionPermission,S=(0,i.useState)(!1),g=(0,a.Z)(S,2),b=g[0],F=g[1],y=(0,i.useState)(!1),R=(0,a.Z)(y,2),C=R[0],Z=R[1],w=(0,i.useState)(!1),V=(0,a.Z)(w,2),Y=V[0],E=V[1],M=(0,i.useState)(!1),k=(0,a.Z)(M,2),A=k[0],G=k[1],q=(0,i.useState)(null),L=(0,a.Z)(q,2),U=L[0],O=L[1],B=(0,i.useContext)(f.V).state,P=s.Z.useForm(),z=(0,a.Z)(P,1)[0],_=(0,i.useMemo)((function(){if(o)return{startDate:o.ExistingScheduleDate?D()(o.ExistingScheduleDate):null,endDate:o.ReScheduleDate?D()(o.ReScheduleDate):null,ShiftId:o.shiftId,Direction:o.ExistingScheduleDirection||o.ReScheduleDirection,ExistingScheduleDescription:o.ExistingScheduleDescription,ExistingScheduleDirection:o.ExistingScheduleDirection,ExistingScheduleIdDescr:o.ExistingScheduleIdDescr,existingScheduleId:o.ExistingScheduleId,ReScheduleIdDescr:o.ReScheduleIdDescr,ReScheduleId:o.ReScheduleId,ReScheduleDescription:o.ReScheduleDescription,ReScheduleDirection:o.ReScheduleDirection,ReScheduleGoShow:null===o||void 0===o?void 0:o.ReScheduleGoShow,ExistingFromLocationId:o.ExistingFromLocationid,ExistingScheduleIdNoShow:null===o||void 0===o?void 0:o.ExistingScheduleIdNoShow,ExistingToLocationId:o.ExistingToLocationid,FromLocationId:o.ReScheduleFromLocationid,ToLocationId:o.ReScheduleToLocationid,RoomId:null===o||void 0===o?void 0:o.RoomId,RoomNumber:o.RoomnNumber}}),[o]);(0,i.useEffect)((function(){_&&z.setFieldsValue(_)}),[_]);var W=function(){var e=z.getFieldValue("FromLocationId"),t=z.getFieldValue("ToLocationId"),o=z.getFieldValue("ExistingFromLocationId"),l=z.getFieldValue("ExistingToLocationId"),n={StartDate:null,EndDate:null,DepartLocationId:null,ArriveLocationId:null};e&&t&&((n={StartDate:z.getFieldValue("endDate")?z.getFieldValue("endDate"):null,EndDate:z.getFieldValue("endDate")?z.getFieldValue("endDate"):null}).DepartLocationId=e,n.ArriveLocationId=t),o&&l&&(n.DepartLocationId=o,n.ArriveLocationId=l),O((0,v.Z)({},n)),G(!0)},H=function(e){z.setFieldValue("endDate",D()(e.EventDate)),z.setFieldValue("FormLocationId",e.FromLocationId),z.setFieldValue("ToLocationId",e.ToLocationId),z.setFieldValue("ReScheduleDescription","".concat(e.Code," ").concat(e.Description)),z.setFieldValue("ReScheduleDirection",e.Direction),z.setFieldValue("ReScheduleId",e.Id)},J=[{type:"component",component:(0,j.jsx)(c.Form.Item,{label:"Existing",shouldUpdate:function(e,t){return(null===e||void 0===e?void 0:e.startDate)!==(null===t||void 0===t?void 0:t.startDate)},className:"col-span-12 mb-2",children:function(e){var t=e.getFieldValue,l=t("startDate");t("ExistingScheduleId");return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{name:"startDate",noStyle:!l,className:"mb-0 w-[115px]",children:l?(0,j.jsx)(p.Z,{disabled:!0,className:"w-full"}):null}),(0,j.jsx)(c.Form.Item,{name:"ExistingScheduleDirection",noStyle:!l,className:"mb-0 w-[50px]",children:l?(0,j.jsx)(d.Z,{disabled:!0,className:"w-full py-[1px]"}):null}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"existingScheduleId"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"ExistingFromLocationid"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"ExistingToLocationId"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.existingScheduleId!==t.existingScheduleId},children:function(e){var t=(0,e.getFieldValue)("existingScheduleId");return(0,j.jsx)(c.Form.Item,{name:"ExistingScheduleDescription",noStyle:!l,className:"flex-1 mb-0",rules:[{required:!0,message:"Flight is required"}],children:l?(0,j.jsx)(d.Z,{disabled:!0,className:"py-[1px]",addonAfter:(0,j.jsx)(c.SeatTooltip,{id:t})}):null})}}),l?null:(0,j.jsx)(c.RemovedTransportField,{description:null===o||void 0===o?void 0:o.ExistingScheduleIdDescr,form:z}),(0,j.jsx)(c.Form.Item,{name:"ExistingScheduleIdNoShow",labelCol:{flex:"150px"},className:"col-span-12 mb-0",valuePropName:"checked",getValueFromEvent:function(e){var t;return null!==(t=e.target)&&void 0!==t&&t.checked?1:0},children:(0,j.jsx)(h.Z,{children:"No Show"})})]})}})},{type:"component",component:(0,j.jsx)(c.Form.Item,{label:(0,j.jsxs)("span",{children:[(0,j.jsx)("span",{className:"text-red-400",children:"*"}),"Reschedule"]}),className:"col-span-12 mb-2",shouldUpdate:function(e,t){return e.ReScheduleId!==t.ReScheduleId},children:function(e){var t=0===(0,e.getFieldValue)("ReScheduleId");return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.startDate!==t.startDate||e.endDate!==t.endDate},children:function(e){var o=e.getFieldValue,l=!1;return o("endDate")||(l=!!o("startDate")&&o("startDate")),(0,j.jsx)(c.Form.Item,{name:"endDate",className:"mb-0 w-[115px]",noStyle:t,children:t?null:(0,j.jsx)(p.Z,{defaultPickerValue:l,showWeek:!0,className:"w-full",onChange:function(){z.setFieldValue("ReScheduleDescription",null),z.setFieldValue("ReScheduleId",null)}})})}}),(0,j.jsx)(c.Form.Item,{name:"ReScheduleDirection",className:"mb-0",noStyle:t,children:t?null:(0,j.jsx)(d.Z,{disabled:!0,className:"w-[50px] py-[2px]"})}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"ReScheduleId"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"FormLocationId"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"ToLocationId"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.ReScheduleId!==t.ReScheduleId},children:function(e){var o=e.getFieldValue,l=o("ReScheduleId"),n=o("ReScheduleDescription");return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(c.Form.Item,{name:"ReScheduleDescription",rules:[{required:!0,message:"ReSchedule Transport is required"}],className:"flex-1 mb-0",noStyle:t,children:t?null:(0,j.jsx)(d.Z,{title:n,readOnly:!0,className:"py-[2px]",addonAfter:(0,j.jsx)(c.SeatTooltip,{id:l})})})})}}),t?(0,j.jsx)(c.Tooltip,{title:"Removed schedule",children:(0,j.jsx)(c.Form.Item,{className:"w-full mb-0",name:"ReScheduleIdDescr",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),className:"w-full"})})}):null,(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.endDate!==t.endDate},children:function(e){var o=(0,e.getFieldValue)("endDate");return(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.Button,{disabled:!C||!o&&!t,className:"text-xs py-[3px]",type:"primary",onClick:W,children:"..."})})}}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.endDate!==t.endDate},children:function(e){var o=e.getFieldValue,l=o("endDate"),n={eventDate:l,direction:o("Direction")};return(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.ButtonDrive,{onRecieve:H,searchValues:n,disabled:!C||!l&&!t})})}}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.endDate!==t.endDate},children:function(e){var o=e.getFieldValue,l=o("endDate"),n={eventDate:l,direction:o("Direction")};return(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.ButtonDrive,{onRecieve:H,searchValues:n,disabled:!C||!l&&!t,mode:"evening"})})}}),(0,j.jsx)(c.Form.Item,{name:"ReScheduleGoShow",labelCol:{flex:"150px"},className:"col-span-12 mb-0",valuePropName:"checked",getValueFromEvent:function(e){var t;return null!==(t=e.target)&&void 0!==t&&t.checked?1:0},children:(0,j.jsx)(h.Z,{children:"Go Show"})})]})}})},{type:"component",component:(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.endDate!==t.endDate},children:function(e){var t,l,n,a=e.getFieldValue,i=(e.setFieldValue,null),s=a("endDate");return s&&o.ExistingScheduleDate&&(D()(s).diff(D()(o.ExistingScheduleDate))>0?"IN"===a("Direction")?(i=0,function(e){var t;(0,r.Z)({method:"get",url:"tas/employeestatus/lasterstatus/offsite/".concat(null===(t=B.userProfileData)||void 0===t?void 0:t.Id,"/").concat(e)}).then((function(e){z.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(D()(s).format("YYYY-MM-DD"))):(i=1,function(e){var t;(0,r.Z)({method:"get",url:"tas/employeestatus/lasterstatus/onsite/".concat(null===(t=B.userProfileData)||void 0===t?void 0:t.Id,"/").concat(e)}).then((function(e){z.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(D()(s).format("YYYY-MM-DD"))):"IN"===a("Direction")?(i=1,function(e){var t;(0,r.Z)({method:"get",url:"tas/employeestatus/futurefirststatus/onsite/".concat(null===(t=B.userProfileData)||void 0===t?void 0:t.Id,"/").concat(e)}).then((function(e){z.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(D()(s).format("YYYY-MM-DD"))):(i=0,function(e){var t;(0,r.Z)({method:"get",url:"tas/employeestatus/futurefirststatus/offsite/".concat(null===(t=B.userProfileData)||void 0===t?void 0:t.Id,"/").concat(e)}).then((function(e){z.setFieldValue("ShiftId",e.data.ShiftId)})).catch((function(e){}))}(D()(s).format("YYYY-MM-DD")))),(0,j.jsx)(c.Form.Item,{label:"Shift Status",name:"ShiftId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Shift is required"}],children:(0,j.jsx)(u.Z,{options:"number"===typeof i?null===(t=B.referData)||void 0===t||null===(l=t.roomStatuses)||void 0===l?void 0:l.filter((function(e){return e.OnSite===i})):null===(n=B.referData)||void 0===n?void 0:n.roomStatuses,filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},className:"w-full",showSearch:!0,allowClear:!0})})}})}],K=[{type:"component",component:(0,j.jsx)(c.Form.Item,{label:"Existing Transport",className:"col-span-12 mb-2",shouldUpdate:function(e,t){return e.existingScheduleId!==t.existingScheduleId},children:function(e){var t=0===(0,e.getFieldValue)("existingScheduleId");return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{name:"startDate",className:"mb-0 w-[115px]",noStyle:t,children:t?null:(0,j.jsx)(p.Z,{disabled:!0,className:"w-full"})}),(0,j.jsx)(c.Form.Item,{name:"Direction",className:"mb-0 w-[60px]",noStyle:t,children:t?null:(0,j.jsx)(d.Z,{disabled:!0,className:"w-full py-[1px]"})}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"existingScheduleId"}),(0,j.jsx)(c.Form.Item,{name:"ExistingScheduleDescription",noStyle:t,className:"flex-1 mb-0",rules:[{required:!0,message:"Flight is required"}],children:t?null:(0,j.jsx)(d.Z,{disabled:!0,className:"py-[1px]",addonAfter:(0,j.jsx)(c.SeatTooltip,{id:null===o||void 0===o?void 0:o.ExistingScheduleId})})}),t?(0,j.jsx)(c.Tooltip,{title:"Removed schedule",children:(0,j.jsx)(c.Form.Item,{className:"w-full mb-0",name:"ExistingScheduleIdDescr",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),className:"w-full"})})}):null,(0,j.jsx)(c.Form.Item,{name:"ExistingScheduleIdNoShow",labelCol:{flex:"150px"},className:"col-span-12 mb-0",valuePropName:"checked",getValueFromEvent:function(e){var t;return null!==(t=e.target)&&void 0!==t&&t.checked?1:0},children:(0,j.jsx)(h.Z,{disabled:!0,children:"No Show"})})]})}})},{type:"component",component:(0,j.jsx)(c.Form.Item,{label:"Reschedule Transport",className:"col-span-12 mb-2",shouldUpdate:function(e,t){return e.ReScheduleId!==t.ReScheduleId},children:function(e){var t=0===(0,e.getFieldValue)("ReScheduleId");return(0,j.jsxs)("div",{className:"flex gap-2",children:[t?(0,j.jsx)(c.Tooltip,{title:"Removed schedule",children:(0,j.jsx)(c.Form.Item,{className:"w-full mb-0",name:"ReScheduleIdDescr",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),className:"w-full"})})}):null,(0,j.jsx)(c.Form.Item,{name:"endDate",className:"mb-0 w-[115px]",noStyle:t,children:t?null:(0,j.jsx)(p.Z,{showWeek:!0,className:"w-[115px]",disabled:!0})}),(0,j.jsx)(c.Form.Item,{name:"Direction",className:"mb-0 w-[60px]",noStyle:t,children:t?null:(0,j.jsx)(d.Z,{disabled:!0,className:"w-[60px] py-[1px]"})}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:"ReScheduleId"}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.ReScheduleId!==t.ReScheduleId},children:function(e){var o=(0,e.getFieldValue)("ReScheduleId");return(0,j.jsx)(c.Form.Item,{name:"ReScheduleDescription",rules:[{required:!0,message:"ReSchedule Transport is required"}],className:"flex-1 mb-0",noStyle:t,children:t?null:(0,j.jsx)(d.Z,{disabled:!0,readOnly:!0,className:"py-[2px]",addonAfter:(0,j.jsx)(c.SeatTooltip,{id:o})})})}}),(0,j.jsx)(c.Form.Item,{name:"ReScheduleGoShow",labelCol:{flex:"150px"},className:"col-span-12 mb-0",valuePropName:"checked",getValueFromEvent:function(e){var t;return null!==(t=e.target)&&void 0!==t&&t.checked?1:0},children:(0,j.jsx)(h.Z,{disabled:!0,children:"Go Show"})})]})}})},{label:"Shift Status",name:"ShiftId",className:"col-span-12 mb-2",type:"select",rules:[{required:!0,message:"Shift Status is required"}],inputprops:{style:{maxWidth:"200px"},options:null===(t=B.referData)||void 0===t?void 0:t.roomStatuses,disabled:!0}},{type:"component",component:(0,j.jsx)(T,{form:z,isEdit:C,initData:_})}],Q=(0,i.useMemo)((function(){var e=[];return null!==x&&void 0!==x&&x.GroupTag&&(e="accomodation"===(null===x||void 0===x?void 0:x.GroupTag)?K:J),e}),[x,K,J]);(0,i.useEffect)((function(){_&&Q.length>0&&E(!0)}),[_,Q]);return(0,j.jsxs)("div",{className:"w-full",children:[Y?(0,j.jsx)(c.Form,{form:z,fields:Q,onFinish:function(e){var t;F(!0),(0,r.Z)({method:"put",url:"tas/requestsitetravel/reschedule",data:(t={id:null===o||void 0===o?void 0:o.Id,shiftId:e.ShiftId,roomId:e.RoomId,reScheduleId:e.ReScheduleId,existingScheduleId:e.existingScheduleId,ExistingScheduleIdNoShow:e.ExistingScheduleIdNoShow},(0,m.Z)(t,"reScheduleId",e.ReScheduleId),(0,m.Z)(t,"ReScheduleGoShow",e.ReScheduleGoShow),(0,m.Z)(t,"Reason",o.Reason),t)}).then((function(e){Z(!1),l()})).catch((function(e){})).then((function(){return F(!1)}))},disabled:!C,className:"grid grid-cols-12 gap-x-5",size:"small",labelAlign:"left",labelCol:{flex:"100px"},children:!n&&"Completed"!==(null===x||void 0===x?void 0:x.GroupTag)&&(0,j.jsx)("div",{className:"col-span-12 flex justify-end gap-5",children:I?C?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){return z.submit()},type:"success",loading:b,className:"text-xs",children:"Save"}),(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){Z(!1),z.setFieldsValue(_)},disabled:b,className:"text-xs",children:"Cancel"})]}):(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){return Z(!0)},type:"primary",className:"text-xs",children:"Edit"})}):null})}):null,(0,j.jsx)(c.Modal,{title:"Select Transport",open:A,width:900,onCancel:function(){return G(!1)},destroyOnClose:!1,children:(0,j.jsx)(c.TransportSearch,{initialSearchValues:U,handleSelect:function(e){z.setFieldValue("endDate",D()(e.EventDate)),z.setFieldValue("FormLocationId",e.FromLocationId),z.setFieldValue("ToLocationId",e.ToLocationId),z.setFieldValue("ReScheduleDescription","".concat(e.Code," ").concat(e.Description)),z.setFieldValue("ReScheduleDirection",e.Direction),z.setFieldValue("ReScheduleId",e.Id),G(!1)},directionDisabled:!1})})]})},R=o(40765),C=o(43681);var Z=function(e){var t,o,l,n,s,m=e.form,x=e.editData,S=e.currentGroup,g=e.disabled,b=(0,i.useContext)(f.V).state,F=(0,i.useState)(!1),T=(0,a.Z)(F,2),y=T[0],Z=T[1],w=(0,i.useState)(!1),V=(0,a.Z)(w,2),Y=V[0],E=V[1],M=(0,i.useState)(!1),k=(0,a.Z)(M,2),A=k[0],G=k[1],q=(0,i.useState)(null),L=(0,a.Z)(q,2),U=L[0],O=L[1];(0,i.useEffect)((function(){var e={};x&&b.userProfileData&&(e=(0,v.Z)((0,v.Z)({},x),{},{ShiftId:x.shiftId,Room:{RoomId:x.RoomId,roomNumber:null===x||void 0===x?void 0:x.RoomNumber},firstTransport:{flightId:x.FirstScheduleId,NoShow:x.FirstScheduleNoShow,Direction:x.FirstScheduleDirection,Date:x.FirstScheduleDate?D()(x.FirstScheduleDate):null,Description:(x.FirstScheduleDirection,x.FirstScheduleDescription)},lastTransport:{flightId:x.LastScheduleId,NoShow:x.LastScheduleNoShow,Direction:x.LastScheduleDirection,Date:x.LastScheduleDate?D()(x.LastScheduleDate):null,Description:(x.LastScheduleDirection,x.LastScheduleDescription)},CostCodeId:null===x||void 0===x?void 0:x.CostCodeId}),m.setFieldsValue(e),E(!0))}),[x,b.userProfileData]);var B=[{type:"component",component:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(c.Form.Item,{label:"First Transport",className:"col-span-12 mb-2",shouldUpdate:function(e,t){var o,l;return(null===e||void 0===e||null===(o=e.firstTransport)||void 0===o?void 0:o.Date)!==(null===t||void 0===t||null===(l=t.firstTransport)||void 0===l?void 0:l.Date)},children:function(e){var t=(0,e.getFieldValue)(["firstTransport","Date"]);return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{name:["firstTransport","Date"],className:"mb-0 w-[115px]",noStyle:!t,children:t?(0,j.jsx)(p.Z,{disabled:!0,className:"w-full"}):null}),(0,j.jsx)(c.Form.Item,{name:["firstTransport","Direction"],className:"mb-0 w-[65px]",noStyle:!t,children:t?(0,j.jsx)(u.Z,{disabled:!0,options:[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}],className:"w-full"}):null}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===(o=e.firstTransport)||void 0===o?void 0:o.flightId)!==(null===(l=t.firstTransport)||void 0===l?void 0:l.flightId)},children:function(e){var o=(0,e.getFieldValue)(["firstTransport","flightId"]);return(0,j.jsx)(c.Form.Item,{className:"mb-0 flex-1",name:["firstTransport","Description"],noStyle:!t,rules:[{required:!0,message:"Flight is required"}],children:t?(0,j.jsx)(d.Z,{disabled:!0,addonAfter:(0,j.jsx)(c.SeatTooltip,{id:o})}):null})}}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["firstTransport","flightId"]}),t?null:(0,j.jsx)(c.Tooltip,{title:"Removed schedule",children:(0,j.jsx)(c.Form.Item,{className:"mb-0 w-full",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),value:null===x||void 0===x?void 0:x.FirstScheduleIdDescr,className:"w-full"})})}),(0,j.jsx)(c.Form.Item,{className:"mb-0",name:["firstTransport","NoShow"],label:"",valuePropName:"checked",getValueFromEvent:function(e){return e.target.checked?1:0},children:(0,j.jsx)(h.Z,{children:"No Show"})})]})}})})},{type:"component",component:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(c.Form.Item,{label:"Last Transport",className:"col-span-12 mb-2",shouldUpdate:function(e,t){var o,l;return(null===(o=e.lastTransport)||void 0===o?void 0:o.Date)!==(null===(l=t.lastTransport)||void 0===l?void 0:l.Date)},children:function(e){var t=(0,e.getFieldValue)(["lastTransport","Date"]);return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{name:["lastTransport","Date"],className:"mb-0 w-[115px]",noStyle:!t,children:t?(0,j.jsx)(p.Z,{disabled:!0,className:"w-full"}):null}),(0,j.jsx)(c.Form.Item,{name:["lastTransport","Direction"],className:"mb-0 w-[65px]",noStyle:!t,children:t?(0,j.jsx)(u.Z,{disabled:!0,options:[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}],className:"w-full"}):null}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===(o=e.lastTransport)||void 0===o?void 0:o.flightId)!==(null===(l=t.lastTransport)||void 0===l?void 0:l.flightId)},children:function(e){var o=(0,e.getFieldValue)(["lastTransport","flightId"]);return(0,j.jsx)(c.Form.Item,{className:"mb-0 flex-1",name:["lastTransport","Description"],rules:[{required:!0,message:"Flight is required"}],noStyle:!t,children:t?(0,j.jsx)(d.Z,{disabled:!0,addonAfter:(0,j.jsx)(c.SeatTooltip,{id:o})}):null})}}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["lastTransport","flightId"]}),t?null:(0,j.jsx)(c.Tooltip,{title:"Removed schedule",children:(0,j.jsx)(c.Form.Item,{className:"mb-0 w-full",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),value:null===x||void 0===x?void 0:x.LastScheduleIdDescr,className:"w-full"})})}),(0,j.jsx)(c.Form.Item,{className:"mb-0",name:["lastTransport","NoShow"],label:"",valuePropName:"checked",getValueFromEvent:function(e){return e.target.checked?1:0},children:(0,j.jsx)(h.Z,{children:"No Show"})})]})}})})},{label:"Shift Status",name:"ShiftId",className:"col-span-12 mb-2",type:"select",rules:[{required:!0,message:"Shift Status is required"}],inputprops:{style:{width:"auto"},options:"IN"===(null===x||void 0===x?void 0:x.FirstScheduleDirection)?null===(t=b.referData)||void 0===t||null===(o=t.roomStatuses)||void 0===o?void 0:o.filter((function(e){return 0===e.OnSite})):null===(l=b.referData)||void 0===l||null===(n=l.roomStatuses)||void 0===n?void 0:n.filter((function(e){return 1===e.OnSite}))}},{label:"Cost Code",name:"CostCodeId",className:"col-span-12 mb-2",type:"select",rules:[{required:!0,message:"Cost Code is required"}],inputprops:{style:{width:"auto",minWidth:"200px"},options:null===(s=b.referData)||void 0===s?void 0:s.costCodes}}];return(0,j.jsxs)("div",{className:"w-full max-w-[1200px]",children:[console.log("valll",m.getFieldsValue()),Y?(0,j.jsx)(c.Form,{form:m,fields:B,size:"small",labelAlign:"right",labelCol:{flex:"120px"},wrapperCol:{flex:1},disabled:g,children:"OUT"===(null===x||void 0===x?void 0:x.FirstScheduleDirection)&&"accomodation"===(null===S||void 0===S?void 0:S.GroupTag)?(0,j.jsx)(c.Form.Item,{label:"Room",className:"col-span-12 mb-0",children:(0,j.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,j.jsx)(c.Form.Item,{name:["Room","roomNumber"],className:"mb-2",rules:[{required:!0,message:"Room is required"}],validateStatus:!(!y||m.getFieldValue(["Room","RoomId"]))&&"error",help:!(!y||m.getFieldValue(["Room","RoomId"]))&&"Owner Room is unavailable",children:(0,j.jsx)(d.Z,{readOnly:!0,className:""})},"form-item-RoomId"),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["Room","RoomId"],children:(0,j.jsx)(d.Z,{className:"hidden"})},"form-item-RoomI"),function(){var e,t;return(null===x||void 0===x||!x.RoomId||null!==(e=b.userProfileData)&&void 0!==e&&e.RoomId)&&null!==(t=b.userProfileData)&&void 0!==t&&t.RoomId?y&&m.getFieldValue(["Room","RoomId"])&&U?(0,j.jsxs)("button",{className:"border py-[5px] leading-none px-2 rounded-md bg-[#e57200] text-white hover:bg-[#ff9225] shadow-btn border-[#e57200] disabled:bg-[#ebb37a] disabled:border-[#ebb37a] hover:border-[#ff9225] transition-all",type:"button",onClick:function(){return G(!0)},disabled:g,children:[(0,j.jsx)(R.Z,{})," Search"]}):y&&m.getFieldValue(["Room","RoomId"])&&!U?(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(c.Button,{htmlType:"button",type:"success",disabled:!0,icon:(0,j.jsx)(C.Z,{}),className:"py-0",children:"Checked"}),(0,j.jsxs)("button",{className:"border py-[5px] leading-none px-2 rounded-md bg-[#e57200] text-white hover:bg-[#ff9225] shadow-btn border-[#e57200] disabled:bg-[#ebb37a] disabled:border-[#ebb37a] hover:border-[#ff9225] transition-all",type:"button",onClick:function(){return G(!0)},disabled:g,children:[(0,j.jsx)(R.Z,{})," Search"]})]}):!y||m.getFieldValue(["Room","RoomId"])||U?(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(e){return function(){var e,t;(0,r.Z)({method:"post",url:"tas/room/findavailablebyroomid",data:{startDate:null===x||void 0===x?void 0:x.FirstScheduleDate,endDate:null===x||void 0===x?void 0:x.LastScheduleDate,roomId:null===(e=b.userProfileData)||void 0===e?void 0:e.RoomId,EmployeeId:null===(t=b.userProfileData)||void 0===t?void 0:t.Id}}).then((function(e){var t,o;e.data.status?(m.setFieldValue(["Room","RoomId"],null===(t=b.userProfileData)||void 0===t?void 0:t.RoomId),m.setFieldValue(["Room","roomNumber"],null===(o=b.userProfileData)||void 0===o?void 0:o.RoomNumber)):(m.setFieldValue(["Room","RoomId"],null),m.setFieldValue(["Room","roomNumber"],null)),Z(!0)})).catch((function(e){}))}()},className:"py-0",disabled:g,children:"Check"}):(0,j.jsxs)("button",{className:"border py-[5px] leading-none px-2 rounded-md bg-[#e57200] text-white hover:bg-[#ff9225] shadow-btn border-[#e57200] disabled:bg-[#ebb37a] disabled:border-[#ebb37a] hover:border-[#ff9225] transition-all",type:"button",onClick:function(){return G(!0)},disabled:g,children:[(0,j.jsx)(R.Z,{})," Search"]}):(0,j.jsxs)("button",{className:"border py-[5px] leading-none px-2 rounded-md bg-[#e57200] text-white hover:bg-[#ff9225] shadow-btn border-[#e57200] disabled:bg-[#ebb37a] disabled:border-[#ebb37a] hover:border-[#ff9225] transition-all",type:"button",onClick:function(){return G(!0)},disabled:g,children:[(0,j.jsx)(R.Z,{})," Search"]})}()]})}):null}):null,(0,j.jsx)(c.Modal,{open:A,onCancel:function(){return G(!1)},title:"Change Room /".concat(D()(m.getFieldValue(["firstTransport","Date"])).format("YYYY-MM-DD")," ").concat(D()(m.getFieldValue(["lastTransport","Date"])).format("YYYY-MM-DD"),"/"),width:900,forceRender:!0,children:(0,j.jsx)(I.Z,{form:m,closeModal:function(){return G(!1)},startDate:D()(m.getFieldValue(["firstTransport","Date"])).format("YYYY-MM-DD"),endDate:D()(m.getFieldValue(["lastTransport","Date"])).format("YYYY-MM-DD"),documentDetail:x,handleSelect:function(e){return O(e)}})})]})},w=o(58467),V=o(14261),Y=o(3489),E=o(66736),M=o(82138),k=Y.Z.Dragger;var A=function(e){e.mainForm,e.getMaster;var t=e.disabled,o=e.showTitle,l=void 0===o||o,n=(0,i.useState)(!1),d=(0,a.Z)(n,2),u=d[0],m=d[1],p=(0,i.useState)(!0),h=(0,a.Z)(p,2),f=(h[0],h[1]),x=(0,i.useState)(!1),I=(0,a.Z)(x,2),S=I[0],g=I[1],b=(0,i.useState)(!1),F=(0,a.Z)(b,2),T=F[0],N=F[1],y=(0,i.useState)([]),R=(0,a.Z)(y,2),C=R[0],Z=R[1],Y=(0,i.useState)(null),A=(0,a.Z)(Y,2),G=A[0],q=A[1],L=(0,i.useState)([]),U=(0,a.Z)(L,2),O=U[0],B=U[1],P=s.Z.useForm(),z=(0,a.Z)(P,1)[0],_=(0,w.UO)().documentId;(0,i.useEffect)((function(){W()}),[]);var W=function(){f(!0),(0,r.Z)({method:"get",url:"/tas/requestdocumentattachment/".concat(_)}).then((function(e){Z(e.data)})).catch((function(e){})).then((function(){return f(!1)}))},H=[{type:"component",component:(0,j.jsx)(c.Form.Item,{name:"files",valuePropName:"file",label:"File",className:"col-span-12 mb-2",rules:[{required:!0,message:"File is required"}],children:(0,j.jsxs)(k,{beforeUpload:!0,multiple:!0,maxCount:5,onChange:function(e){return function(e){var t=[];e.fileList.map((function(e){t.push(e.originFileObj)})),B(t)}(e)},accept:".doc, .docx, .pdf, .txt, .rtf, .ppt, .pptx, .xls, .xlsx, .jpg, .jpeg, .png, .gif, .bmp, .tiff, .svg, .eml, .msg",children:[(0,j.jsx)(E.Z,{color:"blue",style:{fontSize:32,marginBottom:8}}),(0,j.jsx)("p",{className:"text-sm pb-1",children:"Click or drag file to this area to upload"}),(0,j.jsx)("p",{className:"opacity-50 text-sm",children:"Support for a single or bulk upload."})]})},"form-item-c file-1")},{label:"Description",name:"Description",className:"col-span-12 mb-2",type:"textarea"},{label:"Include E-Mail",name:"includeEmail",className:"col-span-12 mb-2",type:"check"}],J=[{label:"File",name:"FileAddress",alignment:"left",cellRender:function(e){return(0,j.jsx)(c.Tooltip,{title:"".concat("https://ottas-api").concat(e.value),children:(0,j.jsx)("a",{className:"edit-button",href:"".concat("https://ottas-api").concat(e.value),target:"_blank",children:"View File"})})}},{label:"Uploader name",name:"FullName",alignment:"left"},{label:"Created Date",name:"CreatedDate",alignment:"left",cellRender:function(e){var t=e.value;return(0,j.jsx)("div",{children:D()(t).format("YYYY-MM-DD HH:mm")})}},{label:"Include E-Mail",name:"IncludeEmail",alignment:"left",cellRender:function(e){return(0,j.jsx)(V.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})}},{label:"Comment",name:"Description",alignment:"left"},{label:"",name:"action",width:"".concat(t?"0px":"150px"),alignment:"center",cellRender:function(e){return!t&&(0,j.jsxs)("div",{className:"flex gap-4",children:[(0,j.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,q(t),void m(!0);var t},children:"Edit"}),(0,j.jsx)("button",{type:"button",className:"dlt-button",onClick:function(t){return o=e.data,q(o),void g(!0);var o},children:"Delete"})]})}}],K=function(){z.resetFields(),m(!1),N(!1)};return(0,j.jsxs)("div",{className:"col-span-12",children:[(0,j.jsx)(c.Table,{data:C,columns:J,allowColumnReordering:!1,containerClass:"shadow-none border border-gray-300",keyExpr:"Id",pager:C.length>20,title:(0,j.jsxs)("div",{className:"flex justify-between items-center py-2 gap-3 border-b",children:[(0,j.jsx)("div",{className:"text-md font-bold pl-2",children:l?"Attachments":null}),!t&&(0,j.jsx)("div",{className:"flex gap-4 items-center",children:(0,j.jsx)(c.Button,{icon:(0,j.jsx)(M.Z,{}),onClick:function(){q(null),m(!0)},className:"text-xs",htmlType:"button",children:"Add Attachment"})})]})}),(0,j.jsx)(c.Modal,{title:"Add Attachment",open:u,onCancel:function(){return m(!1)},children:(0,j.jsx)(c.Form,{form:z,fields:G?[{label:"Comment",name:"Description",className:"col-span-12 mb-2",type:"textarea"},{label:"Include E-Mail",name:"IncludeEmail",className:"col-span-12 mb-2",type:"check"}]:H,size:"small",className:"grid grid-cols-12 gap-x-8",onFinish:function(e){if(N(!0),G)(0,r.Z)({method:"put",url:"tas/requestdocumentattachment",data:(0,v.Z)((0,v.Z)({},e),{},{id:G.Id})}).then((function(e){W(),K()})).catch((function(e){})).then((function(){return N(!1)}));else if(O.length>0){var t=new FormData;O.map((function(e){t.append("files",e)})),(0,r.Z)({method:"post",url:"/tas/SysFile/multi",data:t}).then((function(t){(0,r.Z)({method:"post",url:"/tas/requestdocumentattachment",data:(0,v.Z)((0,v.Z)({},e),{},{fileAddressIds:t.data.map((function(e){return e.Id})),documentId:_})}).then((function(e){W(),B([])})).catch((function(e){})).then((function(){return K()}))})).catch((function(e){K()}))}},noLayoutConfig:!0,layout:"vertical",children:(0,j.jsxs)("div",{className:"col-span-12 flex justify-end gap-3",children:[(0,j.jsx)(c.Button,{htmlType:"submit",type:"primary",icon:(0,j.jsx)(M.Z,{}),loading:T,children:"Save"}),(0,j.jsx)(c.Button,{htmlType:"button",onClick:K,disabled:T,children:"Cancel"})]})})}),(0,j.jsxs)(V.GI,{visible:S,showTitle:!1,height:110,width:350,children:[(0,j.jsx)("div",{children:"Are you sure you want to delete this record?"}),(0,j.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,j.jsx)(c.Button,{type:"danger",onClick:function(){(0,r.Z)({method:"delete",url:"tas/requestdocumentattachment/".concat(G.Id)}).then((function(){W(),g(!1)})).catch((function(e){}))},children:"Yes"}),(0,j.jsx)(c.Button,{onClick:function(){return g(!1)},children:"No"})]})]})]})},G=o(52957),q=i.memo((function(e){var t=e.children,o=e.run;return(0,j.jsx)("div",{className:(0,b.m6)("origin-center",o?"animate-jump":""),children:t})}));var L=function(e){var t=e.form,o=e.isEdit,l=e.documentDetail,n=(0,i.useState)(!1),s=(0,a.Z)(n,2),u=s[0],m=s[1],v=(0,i.useState)(!1),p=(0,a.Z)(v,2),h=p[0],x=p[1],b=(0,i.useState)(!1),F=(0,a.Z)(b,2),T=F[0],N=F[1],y=(0,i.useContext)(f.V).state,R=c.Form.useWatch("firstTransport",t),C=c.Form.useWatch("lastTransport",t);(0,i.useEffect)((function(){var e;null!==(e=y.userProfileData)&&void 0!==e&&e.RoomId&&Z()}),[R,C,y.userProfileData]);var Z=function(){var e,o=t.getFieldValue(["firstTransport","Date"]),l=t.getFieldValue(["Room","RoomId"]),n=t.getFieldValue(["lastTransport","Date"]);o&&n&&l&&(0,r.Z)({method:"post",url:"tas/room/findavailablebyroomid",data:{startDate:o?D()(o).format("YYYY-MM-DD"):null,endDate:n?D()(n).format("YYYY-MM-DD"):null,roomId:l,EmployeeId:null===(e=y.userProfileData)||void 0===e?void 0:e.Id}}).then((function(e){e.data.status?x(!1):(x(!0),V())})).catch((function(e){}))},w=function(){var e,o=t.getFieldValue(["firstTransport","Date"]),l=t.getFieldValue(["lastTransport","Date"]),n=t.getFieldValue(["Room","RoomId"]);o&&l&&(0,r.Z)({method:"post",url:"tas/room/findavailablebyroomid",data:{startDate:o?D()(o).format("YYYY-MM-DD"):null,endDate:l?D()(l).format("YYYY-MM-DD"):null,roomId:n,EmployeeId:null===(e=y.userProfileData)||void 0===e?void 0:e.Id}}).then((function(e){e.data.status?x(!1):(x(!0),V())})).catch((function(e){}))},V=function(){N(!0),setTimeout((function(){N(!1)}),700)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Form.Item,{label:"Room",name:"Room",className:"col-span-12 mb-2",children:(0,j.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,j.jsx)(c.Form.Item,{name:["Room","roomNumber"],className:"flex-1 mb-0",rules:[{required:!0,message:"Room is required"}],validateStatus:!!h&&"error",help:!!h&&(0,j.jsx)(q,{run:T,children:"Owner Room is not available"}),children:(0,j.jsx)(d.Z,{readOnly:!0})},"form-item-RoomId"),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===(o=e.Room)||void 0===o?void 0:o.RoomId)!==(null===(l=t.Room)||void 0===l?void 0:l.RoomId)},children:function(e){var t,l,n=e.getFieldValue;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{className:"text-xs py-1 px-2",type:"primary",onClick:function(){return m(!0)},disabled:!o,icon:(0,j.jsx)(S.Z,{})}),null!==(t=y.userProfileData)&&void 0!==t&&t.RoomId?(0,j.jsx)(c.Tooltip,{title:"Check own room",children:(0,j.jsx)(c.Button,{className:"text-xs py-1 px-2",type:(null===(l=y.userProfileData)||void 0===l?void 0:l.RoomId)!==n(["Room","RoomId"])?"default":"success",icon:(0,j.jsx)(g.FaHouseUser,{size:14}),onClick:w})}):null]})}})]})}),(0,j.jsx)(c.Modal,{open:u,onCancel:function(){return m(!1)},title:"Change Room /".concat(D()(t.getFieldValue(["firstTransport","Date"])).format("YYYY-MM-DD")," ").concat(D()(t.getFieldValue(["lastTransport","Date"])).format("YYYY-MM-DD"),"/"),width:900,forceRender:!0,children:(0,j.jsx)(I.Z,{form:t,closeModal:function(){return m(!1)},startDate:D()(t.getFieldValue(["firstTransport","Date"])).format("YYYY-MM-DD"),endDate:D()(t.getFieldValue(["lastTransport","Date"])).format("YYYY-MM-DD"),documentDetail:l,handleSelect:function(){return x(!1)}})})]})};var U=function(e){var t,o,l,n,m,x,I,g,b,F,T,y=e.documentDetail,R=e.refreshData,C=e.disabled,Z=e.currentGroup,w=e.travelData,V=(0,i.useState)([]),Y=(0,a.Z)(V,2),E=(Y[0],Y[1]),M=(0,i.useState)([]),k=(0,a.Z)(M,2),A=(k[0],k[1]),q=(0,i.useState)(null),U=(0,a.Z)(q,2),O=(U[0],U[1]),B=(0,i.useState)(!1),P=(0,a.Z)(B,2),z=P[0],_=P[1],W=(0,i.useState)(!1),H=(0,a.Z)(W,2),J=H[0],K=H[1],Q=(0,i.useState)(null),X=(0,a.Z)(Q,2),$=X[0],ee=X[1],te=(0,i.useState)(!1),oe=(0,a.Z)(te,2),le=(oe[0],oe[1]),ne=(0,i.useState)(!1),ae=(0,a.Z)(ne,2),ie=ae[0],re=ae[1],se=(0,i.useState)(null),de=(0,a.Z)(se,2),ue=de[0],ce=de[1],me=(0,i.useContext)(f.V).state,ve=s.Z.useForm(),pe=(0,a.Z)(ve,1)[0],he={DepartLocationId:null===(t=me.referData)||void 0===t||null===(o=t.locations)||void 0===o?void 0:o.find((function(e){return"UB"===e.Code})).Id,ArriveLocationId:null===(l=me.referData)||void 0===l||null===(n=l.locations)||void 0===n?void 0:n.find((function(e){return"OT"===e.Code})).Id},fe={DepartLocationId:null===(m=me.referData)||void 0===m||null===(x=m.locations)||void 0===x?void 0:x.find((function(e){return"OT"===e.Code})).Id,ArriveLocationId:null===(I=me.referData)||void 0===I||null===(g=I.locations)||void 0===g?void 0:g.find((function(e){return"UB"===e.Code})).Id},xe=function(){var e,t,o,l,n,a={RoomId:null,roomNumber:null};me.userProfileData&&(a={roomNumber:null!==(e=me.userProfileData)&&void 0!==e&&e.RoomNumber?null===(t=me.userProfileData)||void 0===t?void 0:t.RoomNumber:"Virtual Room",RoomId:null!==(o=me.userProfileData)&&void 0!==o&&o.RoomId?null===(l=me.userProfileData)||void 0===l?void 0:l.RoomId:null===(n=me.referData)||void 0===n?void 0:n.noRoomId.Id});return a};(0,i.useEffect)((function(){var e;w&&me.userProfileData&&(e=D()(w.inScheduleDate).diff(D()(w.outScheduleDate))>0?(0,v.Z)((0,v.Z)({},w),{},{ShiftId:null===w||void 0===w?void 0:w.shiftId,Room:w.RoomId?{RoomId:w.RoomId,roomNumber:w.RoomNumber}:xe(),firstTransport:{seats:{Seats:null===w||void 0===w?void 0:w.OUTScheduleSeatsCount,Booked:null===w||void 0===w?void 0:w.OUTScheduleBookedCount,Available:null===w||void 0===w?void 0:w.OUTScheduleAvailableCount},flightId:null===w||void 0===w?void 0:w.outScheduleId,flightInfo:"",Direction:null===w||void 0===w?void 0:w.outScheduleDirection,Date:null!==w&&void 0!==w&&w.outScheduleDate?D()(null===w||void 0===w?void 0:w.outScheduleDate):null,Description:null===w||void 0===w?void 0:w.OUTScheduleDescription,GoShow:null===w||void 0===w?void 0:w.outScheduleGoShow},lastTransport:{seats:{Seats:null===w||void 0===w?void 0:w.INScheduleSeatsCount,Booked:null===w||void 0===w?void 0:w.INScheduleBookedCount,Available:null===w||void 0===w?void 0:w.INScheduleAvailableCount},flightId:null===w||void 0===w?void 0:w.inScheduleId,flightInfo:"",Direction:w.inScheduleDirection,Date:w.inScheduleDate?D()(w.inScheduleDate):null,Description:null===w||void 0===w?void 0:w.INScheduleDescription,GoShow:null===w||void 0===w?void 0:w.inScheduleGoShow}}):(0,v.Z)((0,v.Z)({},w),{},{ShiftId:null===w||void 0===w?void 0:w.shiftId,Room:w.RoomId?{RoomId:w.RoomId,roomNumber:null===w||void 0===w?void 0:w.RoomNumber}:xe(),firstTransport:{seats:{Seats:null===w||void 0===w?void 0:w.INScheduleSeatsCount,Booked:null===w||void 0===w?void 0:w.INScheduleBookedCount,Available:null===w||void 0===w?void 0:w.INScheduleAvailableCount},flightId:null===w||void 0===w?void 0:w.inScheduleId,Direction:w.inScheduleDirection,Date:w.inScheduleDate?D()(w.inScheduleDate):null,Description:null===w||void 0===w?void 0:w.INScheduleDescription,GoShow:null===w||void 0===w?void 0:w.inScheduleGoShow},lastTransport:{seats:{Seats:null===w||void 0===w?void 0:w.OUTScheduleSeatsCount,Booked:null===w||void 0===w?void 0:w.OUTScheduleBookedCount,Available:null===w||void 0===w?void 0:w.OUTScheduleAvailableCount},flightId:null===w||void 0===w?void 0:w.outScheduleId,Direction:null===w||void 0===w?void 0:w.outScheduleDirection,Date:null!==w&&void 0!==w&&w.outScheduleDate?D()(null===w||void 0===w?void 0:w.outScheduleDate):null,Description:null===w||void 0===w?void 0:w.OUTScheduleDescription,GoShow:null===w||void 0===w?void 0:w.outScheduleGoShow}}),De(e),pe.setFieldsValue(e),ee(e),le(!0))}),[w,me.userProfileData]);var De=function(e){var t=D()(e.firstTransport.Date).format("YYYY-MM-DD"),o=D()(e.lastTransport.Date).format("YYYY-MM-DD");e.inScheduleDate&&(0,r.Z)({method:"get",url:"tas/ActiveTransport/getdatetransport?eventDate=".concat(t,"&Direction=").concat(e.firstTransport.Direction)}).then((function(t){var o=[];t.data.map((function(e){o.push((0,v.Z)((0,v.Z)({},e),{},{value:e.ScheduleId,label:"".concat(e.Description," ").concat(e.Seat,"/").concat(e.BookedCount)}))})),pe.setFieldValue(["firstTransport","flightId"],e.firstTransport.flightId),E(o)})),e.outScheduleDate&&(0,r.Z)({method:"get",url:"tas/ActiveTransport/getdatetransport?eventDate=".concat(o,"&Direction=").concat(e.lastTransport.Direction)}).then((function(t){var o=[];t.data.map((function(e){o.push((0,v.Z)((0,v.Z)({},e),{},{value:e.ScheduleId,label:"".concat(e.Description," ").concat(e.Seat,"/").concat(e.BookedCount)}))})),pe.setFieldValue(["lastTransport","flightId"],e.lastTransport.flightId),A(o)}))},Ie=function(e){"IN"===e?pe.setFieldValue(["lastTransport","Direction"],"OUT"):pe.setFieldValue(["lastTransport","Direction"],"IN")},Se=function(){var e={StartDate:pe.getFieldValue(["firstTransport","Date"])?pe.getFieldValue(["firstTransport","Date"]):null,EndDate:pe.getFieldValue(["firstTransport","Date"])?pe.getFieldValue(["firstTransport","Date"]):null};e="IN"===pe.getFieldValue(["firstTransport","Direction"])?(0,v.Z)((0,v.Z)({},e),he):"OUT"===pe.getFieldValue(["firstTransport","Direction"])?(0,v.Z)((0,v.Z)({},e),fe):(0,v.Z)((0,v.Z)({},e),{},{DepartLocationId:null,ArriveLocationId:null}),ce((0,v.Z)((0,v.Z)({},e),{},{transportType:"first"})),re(!0)},ge=function(){var e=pe.getFieldValue(["lastTransport","Direction"]),t=pe.getFieldValue(["firstTransport","Direction"]),o={StartDate:pe.getFieldValue(["lastTransport","Date"])?pe.getFieldValue(["lastTransport","Date"]):null,EndDate:pe.getFieldValue(["lastTransport","Date"])?pe.getFieldValue(["lastTransport","Date"]):null};o="IN"===e||"OUT"===t?(0,v.Z)((0,v.Z)({},o),he):"OUT"===e||"IN"===t?(0,v.Z)((0,v.Z)({},o),fe):(0,v.Z)((0,v.Z)({},o),{},{DepartLocationId:null,ArriveLocationId:null}),ce((0,v.Z)((0,v.Z)({},o),{},{transportType:"last"})),re(!0)},be=(0,i.useCallback)((function(e){O(e),pe.setFieldValue("RoomId",""),pe.setFieldValue(["firstTransport","Description"],null),pe.setFieldValue(["firstTransport","flightId"],null)}),[]),je=(0,i.useCallback)((function(){pe.setFieldValue(["lastTransport","Description"],null),pe.setFieldValue(["lastTransport","flightId"],null)}),[]),Fe=function(e,t){pe.setFieldValue([t,"seats"],{Seats:0,Booked:0,Available:0}),pe.setFieldValue([t,"Direction"],e.Direction),pe.setFieldValue([t,"Description"],"".concat(e.Code," ").concat(e.Description)),pe.setFieldValue([t,"flightId"],e.Id),pe.setFieldValue([t,"Date"],D()(e.EventDate))};return(0,j.jsxs)("div",{children:[(0,j.jsxs)(c.Form,{className:"grid grid-cols-12 col-span-12 gap-x-5 gap-1",form:pe,onFinish:function(e){var t;_(!0),(0,r.Z)({method:"put",url:"tas/requestsitetravel/addtravel",data:{inScheduleId:"IN"===e.firstTransport.Direction?e.firstTransport.flightId:e.lastTransport.flightId,outScheduleId:"OUT"===e.firstTransport.Direction?e.firstTransport.flightId:e.lastTransport.flightId,inScheduleGoShow:"IN"===e.firstTransport.Direction?e.firstTransport.GoShow:e.lastTransport.GoShow,outScheduleGoShow:"OUT"===e.firstTransport.Direction?e.firstTransport.GoShow:e.lastTransport.GoShow,departmentId:e.DepartmentId,shiftId:e.ShiftId,employerId:e.EmployerId,CheckRoom:"accomodation"===(null===Z||void 0===Z?void 0:Z.GroupTag),positionId:e.PositionId,costcodeId:e.CostCodeId,roomId:null===(t=e.Room)||void 0===t?void 0:t.RoomId,id:w.Id}}).then((function(e){R(),K(!1)})).catch((function(e){})).then((function(){return _(!1)}))},disabled:!J,size:"small",labelCol:{flex:"100px"},children:[(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Form.Item,{label:"First Transport",className:"col-span-12 mb-2",shouldUpdate:function(e,t){var o,l;return(null===(o=e.firstTransport)||void 0===o?void 0:o.Date)!==(null===(l=t.firstTransport)||void 0===l?void 0:l.Date)},children:function(e){var t=e.getFieldValue,o=(e.getFieldsValue,t(["firstTransport","Date"])),l={eventDate:o,direction:t(["firstTransport","Direction"])};return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{name:["firstTransport","Date"],noStyle:!o,className:"mb-0 w-[115px]",children:o?(0,j.jsx)(p.Z,{showWeek:!0,onChange:be,className:"w-full"}):null}),(0,j.jsx)(c.Form.Item,{name:["firstTransport","Direction"],noStyle:!o,className:"mb-0 w-[60px]",children:o?(0,j.jsx)(u.Z,{options:[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}],className:"w-full",onChange:Ie}):null}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["firstTransport","flightId"]}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["firstTransport","seats"]}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===(o=e.firstTransport)||void 0===o?void 0:o.flightId)!==(null===(l=t.firstTransport)||void 0===l?void 0:l.flightId)},children:function(e){var t=e.getFieldValue,l=t(["firstTransport","flightId"]),n=t(["firstTransport","Description"]);return(0,j.jsx)(c.Form.Item,{noStyle:!o,name:["firstTransport","Description"],className:"flex-1 mb-0",children:o?(0,j.jsx)(d.Z,{disabled:!0,readOnly:!0,title:n,addonAfter:(0,j.jsx)(c.SeatTooltip,{id:l})}):null})}}),o?null:(0,j.jsx)(c.Tooltip,{title:"Removed Schedule",children:(0,j.jsx)(c.Form.Item,{name:"inScheduleIdDescr",className:"mb-0 w-full",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),className:"w-full"})})}),(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.Button,{className:"text-xs py-[4px] px-2",type:"primary",onClick:Se,disabled:!J,icon:(0,j.jsx)(S.Z,{})})}),(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.ButtonDrive,{onRecieve:Fe,searchValues:l,name:"firstTransport",disabled:!J})}),(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.ButtonDrive,{onRecieve:Fe,searchValues:l,name:"firstTransport",disabled:!J,mode:"evening"})}),(0,j.jsx)(c.Form.Item,{name:["firstTransport","GoShow"],labelCol:{flex:"150px"},className:"col-span-12 mb-0",valuePropName:"checked",getValueFromEvent:function(e){var t;return null!==(t=e.target)&&void 0!==t&&t.checked?1:0},children:(0,j.jsx)(h.Z,{children:"Go Show"})})]})}}),(0,j.jsx)(c.Form.Item,{label:"Last Transport",className:"col-span-12 mb-2",shouldUpdate:function(e,t){var o,l,n,a;return(null===(o=e.lastTransport)||void 0===o?void 0:o.Date)!==(null===(l=t.lastTransport)||void 0===l?void 0:l.Date)||(null===e||void 0===e||null===(n=e.firstTransport)||void 0===n?void 0:n.Direction)!==(null===t||void 0===t||null===(a=t.firstTransport)||void 0===a?void 0:a.Direction)},children:function(e){var t=e.getFieldValue,o=t(["lastTransport","Date"]),l={eventDate:o,direction:t(["lastTransport","Direction"])};return(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l,n,a;return(null===(o=e.firstTransport)||void 0===o?void 0:o.Date)!==(null===(l=t.firstTransport)||void 0===l?void 0:l.Date)||(null===(n=e.lastTransport)||void 0===n?void 0:n.Date)!==(null===(a=t.lastTransport)||void 0===a?void 0:a.Date)},children:function(e){var t=e.getFieldValue,l=!1;return t(["lastTransport","Date"])||(l=t(["firstTransport","Date"])),(0,j.jsx)(c.Form.Item,{name:["lastTransport","Date"],noStyle:!o,className:"mb-0 w-[115px]",children:o?(0,j.jsx)(p.Z,{defaultPickerValue:l,showWeek:!0,onChange:je,className:"w-full"}):null})}}),(0,j.jsx)(c.Form.Item,{className:"mb-0 w-[65px]",noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===e||void 0===e||null===(o=e.firstTransport)||void 0===o?void 0:o.Direction)!==(null===t||void 0===t||null===(l=t.firstTransport)||void 0===l?void 0:l.Direction)},children:function(e){var t=e.getFieldValue,o=e.setFieldValue,l=t(["firstTransport","Direction"]);"IN"===l&&o(["lastTransport","Direction"],"OUT"),"OUT"===l&&o(["lastTransport","Direction"],"IN")}}),(0,j.jsx)(c.Form.Item,{name:["lastTransport","Direction"],noStyle:!o,className:"mb-0 w-[60px]",children:o?(0,j.jsx)(d.Z,{disabled:!0}):null}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["lastTransport","flightId"]}),(0,j.jsx)(c.Form.Item,{noStyle:!0,name:["lastTransport","seats"]}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===(o=e.lastTransport)||void 0===o?void 0:o.flightId)!==(null===(l=t.lastTransport)||void 0===l?void 0:l.flightId)},children:function(e){var t=e.getFieldValue,l=t(["lastTransport","flightId"]),n=t(["lastTransport","Description"]);return(0,j.jsx)(c.Form.Item,{name:["lastTransport","Description"],noStyle:!o,className:"flex-1 mb-0",children:o?(0,j.jsx)(d.Z,{readOnly:!0,title:n,addonAfter:(0,j.jsx)(c.SeatTooltip,{id:l})}):null})}}),o?null:(0,j.jsx)(c.Tooltip,{title:"Removed Schedule",children:(0,j.jsx)(c.Form.Item,{name:"outScheduleIdDescr",className:"mb-0 w-full",children:(0,j.jsx)(d.Z,{disabled:!0,status:"error",prefix:(0,j.jsx)(N.Z,{}),className:"w-full"})})}),(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.Button,{className:"text-xs py-1 px-2",type:"primary",onClick:ge,disabled:!J,icon:(0,j.jsx)(S.Z,{})})}),(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.ButtonDrive,{onRecieve:Fe,searchValues:l,name:"lastTransport",disabled:!J})}),(0,j.jsx)(c.Form.Item,{className:"col-span-1 mb-0",children:(0,j.jsx)(c.ButtonDrive,{onRecieve:Fe,searchValues:l,name:"lastTransport",disabled:!J,mode:"evening"})}),(0,j.jsx)(c.Form.Item,{name:["lastTransport","GoShow"],labelCol:{flex:"150px"},className:"col-span-12 mb-0",valuePropName:"checked",getValueFromEvent:function(e){var t;return null!==(t=e.target)&&void 0!==t&&t.checked?1:0},children:(0,j.jsx)(h.Z,{children:"Go Show"})})]})}}),(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){var o,l;return(null===(o=e.firstTransport)||void 0===o?void 0:o.Direction)!==(null===(l=t.firstTransport)||void 0===l?void 0:l.Direction)},children:function(e){var t,o,l,n,a=e.getFieldValue;e.setFieldValue;return"OUT"===a(["firstTransport","Direction"])?(0,j.jsx)(c.Form.Item,{label:"Shift",name:"ShiftId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Shift is required"}],children:(0,j.jsx)(u.Z,{options:null===(t=me.referData)||void 0===t||null===(o=t.roomStatuses)||void 0===o?void 0:o.filter((function(e){return 0===e.OnSite})),className:"w-full",filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0,allowClear:!0})}):(0,j.jsx)(c.Form.Item,{label:"Shift",name:"ShiftId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Shift is required"}],children:(0,j.jsx)(u.Z,{options:null===(l=me.referData)||void 0===l||null===(n=l.roomStatuses)||void 0===n?void 0:n.filter((function(e){return 1===e.OnSite})),className:"w-full",filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0,allowClear:!0})})}}),(0,j.jsx)(c.Form.Item,{label:"Department",name:"DepartmentId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Department is required"}],children:(0,j.jsx)(G.Z,{treeData:me.referData.departments,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},filterTreeNode:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.Name)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},allowClear:!0,showSearch:!0})},"form-item-DepartmentId"),(0,j.jsx)(c.Form.Item,{label:"Position",name:"PositionId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Position is required"}],children:(0,j.jsx)(u.Z,{allowClear:!0,showSearch:!0,filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},options:null===(b=me.referData)||void 0===b?void 0:b.positions})},"form-item-PositionId"),(0,j.jsx)(c.Form.Item,{label:"Cost Code",name:"CostCodeId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Cost Code is required"}],children:(0,j.jsx)(u.Z,{allowClear:!0,showSearch:!0,filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},options:null===(F=me.referData)||void 0===F?void 0:F.costCodes})},"form-item-CostCodeId"),(0,j.jsx)(c.Form.Item,{label:"Employer",name:"EmployerId",className:"col-span-12 mb-2",rules:[{required:!0,message:"Employer is required"}],children:(0,j.jsx)(u.Z,{allowClear:!0,showSearch:!0,filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},options:null===(T=me.referData)||void 0===T?void 0:T.employers})},"form-item-EmployerId")]}),("accomodation"===(null===Z||void 0===Z?void 0:Z.GroupTag)||"travelflight"===(null===Z||void 0===Z?void 0:Z.GroupTag))&&(0,j.jsx)(L,{form:pe,isEdit:J,documentDetail:y}),!C&&"Completed"!==(null===Z||void 0===Z?void 0:Z.GroupTag)&&(0,j.jsx)("div",{className:"col-span-12 flex justify-end gap-5",children:J?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){return pe.submit()},type:"success",loading:z,children:"Save"}),(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){K(!1),pe.setFieldsValue($)},disabled:z,children:"Cancel"})]}):(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){return K(!0)},type:"primary",children:"Edit"})})})]}),(0,j.jsx)(c.Modal,{title:"Select Transport",open:ie,width:900,onCancel:function(){return re(!1)},destroyOnClose:!0,children:(0,j.jsx)(c.TransportSearch,{initialSearchValues:ue,handleSelect:function(e){"first"===ue.transportType?(pe.setFieldValue(["firstTransport","seats"],{Seats:e.Seats,Booked:e.Confirmed,Available:e.Seats-e.Confirmed<0?0:e.Seats-e.Confirmed}),pe.setFieldValue(["firstTransport","Direction"],e.Direction),pe.setFieldValue(["firstTransport","Description"],"".concat(e.Code," ").concat(e.Description," ").concat(e.TransportMode)),pe.setFieldValue(["firstTransport","flightId"],e.Id),pe.setFieldValue(["firstTransport","Date"],D()(e.EventDate)),re(!1)):(pe.setFieldValue(["lastTransport","seats"],{Seats:e.Seats,Booked:e.Confirmed,Available:e.Seats-e.Confirmed<0?0:e.Seats-e.Confirmed}),pe.setFieldValue(["lastTransport","Direction"],e.Direction),pe.setFieldValue(["lastTransport","Description"],"".concat(e.Code," ").concat(e.Description," ").concat(e.TransportMode)),pe.setFieldValue(["lastTransport","flightId"],e.Id),pe.setFieldValue(["lastTransport","Date"],D()(e.EventDate)),re(!1))}})})]})},O=o(8251),B=o(10202),P=o(82241),z=o(14446),_={Approve:"Are you sure you want to approve this request?",Cancel:"Are you sure you want to cancel this request?",Save:"Are you sure you want to save this request?",Decline:"Are you sure you want to decline this request?",Complete:"Are you sure you want to complete this request?"},W={Approve:"success",Cancel:"danger",Save:"primary",Decline:"",Complete:"success"};var H=function(){var e,t=(0,i.useState)(null),o=(0,a.Z)(t,2),m=o[0],v=o[1],p=(0,i.useState)(null),h=(0,a.Z)(p,2),x=h[0],I=h[1],S=(0,i.useState)(!1),g=(0,a.Z)(S,2),b=g[0],F=g[1],T=(0,i.useState)(!1),N=(0,a.Z)(T,2),R=(N[0],N[1]),C=(0,i.useState)(null),Y=(0,a.Z)(C,2),E=Y[0],M=Y[1],k=(0,i.useState)(null),G=(0,a.Z)(k,2),q=G[0],L=G[1],H=(0,i.useState)(null),J=(0,a.Z)(H,2),K=J[0],Q=J[1],X=(0,i.useState)(!1),$=(0,a.Z)(X,2),ee=$[0],te=$[1],oe=(0,i.useState)([]),le=(0,a.Z)(oe,2),ne=le[0],ae=le[1],ie=(0,i.useState)(null),re=(0,a.Z)(ie,2),se=re[0],de=re[1],ue=(0,i.useState)(!1),ce=(0,a.Z)(ue,2),me=ce[0],ve=ce[1],pe=(0,i.useState)(null),he=(0,a.Z)(pe,2),fe=he[0],xe=he[1],De=(0,i.useState)(null),Ie=(0,a.Z)(De,2),Se=Ie[0],ge=Ie[1],be=(0,i.useState)(null),je=(0,a.Z)(be,2),Fe=je[0],Te=je[1],Ne=(0,w.f_)().data,ye=(0,i.useContext)(f.V),Re=ye.state,Ce=ye.action,Ze=s.Z.useForm(),we=(0,a.Z)(Ze,1)[0],Ve=s.Z.useForm(),Ye=(0,a.Z)(Ve,1)[0],Ee=s.Z.useForm(),Me=(0,a.Z)(Ee,1)[0],ke=s.Z.useForm(),Ae=(0,a.Z)(ke,1)[0],Ge=(0,w.s0)(),qe=(0,w.UO)(),Le=qe.documentId,Ue=qe.documentTag,Oe=(0,P.Z)(),Be="requestDocumentDetail_".concat(Le);(0,i.useEffect)((function(){Ne.Id&&v(Ne)}),[Ne]),(0,i.useEffect)((function(){Le&&Ne.Id&&(F(!0),Ce.changeMenuKey("/request/task"),r.Z.all(["tas/employee/profile/".concat(Ne.EmployeeId),"tas/requestdocumenthistory/".concat(Le),"tas/requestdocument/myinfo","/tas/requestgroupconfig/groupandmembers/".concat(Le),"/tas/requestgroupconfig/documentroute/".concat(Le)].map((function(e){return r.Z.get(e)}))).then(r.Z.spread((function(e,t,o,l,n){var a;Ce.saveUserProfileData(e.data),xe(e.data),ae(t.data),de(o.data),I(l.data),ge(n.data);var i=null===(a=n.data)||void 0===a?void 0:a.find((function(e){return 1===e.CurrentPosition}));Q(i)}))).catch((function(){})).then((function(){return F(!1)})))}),[Le]),(0,i.useEffect)((function(){return Re.connectionMultiViewer&&Re.userInfo&&(Pe(),Re.connectionMultiViewer.on("UsersInScreen",(function(e,t){var o=t.map((function(e){var t,o;return{name:null===(t=e.userName)||void 0===t?void 0:t.split("_")[0],role:null===(o=e.userName)||void 0===o?void 0:o.split("_")[1],color:(0,B.Z)()}}));Ce.setMultiViewers(o.filter((function(e){var t,o;return e.name!=="".concat(null===(t=Re.userInfo)||void 0===t?void 0:t.Firstname," ").concat(null===(o=Re.userInfo)||void 0===o?void 0:o.Lastname)})))})),Re.connectionMultiViewer.on("ErrorMessage",(function(e,t){console.log("error message",t,e)}))),window.addEventListener("beforeunload",(function(){ze()})),function(){Re.connectionMultiViewer&&ze()}}),[Re.connectionMultiViewer,Re.userInfo]),(0,i.useEffect)((function(){"Completed"!==(null===m||void 0===m?void 0:m.CurrentStatus)&&"Cancelled"!==(null===m||void 0===m?void 0:m.CurrentStatus)&&("remove"===Ue&&Se&&m&&x||"remove"!==Ue&&Se&&m&&x&&Fe)&&He()}),[Se,m,x,Fe]),(0,i.useEffect)((function(){var e;if("reschedule"===Ue&&m)(0,r.Z)({method:"get",url:"tas/transportschedule/seatinfo/".concat(null===m||void 0===m||null===(e=m.TravelData)||void 0===e?void 0:e.ReScheduleId)}).then((function(e){Te(e.data)}));else if("addtravel"===Ue&&m){var t,o;r.Z.all(["tas/transportschedule/seatinfo/".concat(null===m||void 0===m||null===(t=m.TravelData)||void 0===t?void 0:t.inScheduleId),"tas/transportschedule/seatinfo/".concat(null===m||void 0===m||null===(o=m.TravelData)||void 0===o?void 0:o.outScheduleId)].map((function(e){return r.Z.get(e)}))).then(r.Z.spread((function(e,t){Te({inSeat:e.data,outSeat:t.data})}))).catch((function(){})).then((function(){return F(!1)}))}}),[Ue,m]);var Pe=function(){try{var e,t,o,l;null===(e=Re.connectionMultiViewer)||void 0===e||e.invoke("JoinScreen","".concat(null===(t=Re.userInfo)||void 0===t?void 0:t.Firstname," ").concat(null===(o=Re.userInfo)||void 0===o?void 0:o.Lastname,"_").concat(null===(l=Re.userInfo)||void 0===l?void 0:l.Role),Be)}catch(n){}},ze=function(){var e,t,o,l;null===(e=Re.connectionMultiViewer)||void 0===e||e.invoke("LeaveScreen","".concat(null===(t=Re.userInfo)||void 0===t?void 0:t.Firstname," ").concat(null===(o=Re.userInfo)||void 0===o?void 0:o.Lastname,"_").concat(null===(l=Re.userInfo)||void 0===l?void 0:l.Role),Be)},_e=(0,i.useCallback)((function(e){(0,r.Z)({method:"get",url:"tas/employee/profile/".concat(e)}).then((function(e){Ce.saveUserProfileData(e.data),xe(e.data)})).catch((function(e){}))}),[Ce]),We=function(){(0,r.Z)({method:"get",url:"tas/requestsitetravel/".concat(Ue,"/").concat(Le)}).then(function(){var e=(0,n.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.data.Id?v(t.data):R(!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}))},He=function(){var e=(0,n.Z)((0,l.Z)().mark((function e(){var t,o,n,a,i,r,s,d,u,c,v,p,h,f,I,S,g,b,j,F,T,N,y,R,C,Z,w,V,Y,E,M,k;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null===m||void 0===m?void 0:m.TravelData,o=null===Se||void 0===Se?void 0:Se.find((function(e){return 1===e.CurrentPosition})),n=function(e){var t=null===x||void 0===x?void 0:x.find((function(t){return(null===t||void 0===t?void 0:t.GroupTag)===e}));if(t){var o=[];t.groupMembers.map((function(e){o.push({value:e.employeeId,label:e.fullName})})),we.setFieldValue("nextGroupName",null===t||void 0===t?void 0:t.GroupName),we.setFieldValue("nextGroupId",null===t||void 0===t?void 0:t.id),we.setFieldValue("assignEmployeeOptions",o),L(t)}},a=function(){return n("accomodation")},i=function(){return n("travelsite")},r=function(){return n("dataapproval")},s=function(){L({GroupTag:"complete"}),we.setFieldValue("nextGroupName",null),we.setFieldValue("nextGroupId",null),we.setFieldValue("assignEmployeeOptions",[])},"reschedule"===Ue?(c=(null===Fe||void 0===Fe?void 0:Fe.AvailableSeatCount)||0,v=(null===m||void 0===m?void 0:m.DaysAway)>=7&&c>=3&&"Airplane"===(null===m||void 0===m||null===(d=m.TravelData)||void 0===d?void 0:d.ReScheduleTransportMode),p=(null===m||void 0===m?void 0:m.DaysAway)>=2&&"Airplane"!==(null===m||void 0===m||null===(u=m.TravelData)||void 0===u?void 0:u.ReScheduleTransportMode),"linemanager"===(null===o||void 0===o?void 0:o.GroupTag)?1===m.EmployeeActive?null!==m&&void 0!==m&&m.TravelData&&(g=D()(null===m||void 0===m||null===(h=m.TravelData)||void 0===h?void 0:h.ExistingScheduleDate)-D()(null===m||void 0===m||null===(f=m.TravelData)||void 0===f?void 0:f.ReScheduleDate),b="OUT"===(null===m||void 0===m||null===(I=m.TravelData)||void 0===I?void 0:I.ReScheduleDirection)&&g<0,j="IN"===(null===m||void 0===m||null===(S=m.TravelData)||void 0===S?void 0:S.ReScheduleDirection)&&g>0,b||j?a():v||p?L({GroupTag:"complete"}):i()):r():"dataapproval"===(null===o||void 0===o?void 0:o.GroupTag)?a():"accomodation"===(null===o||void 0===o?void 0:o.GroupTag)?i():"travelsite"===(null===o||void 0===o?void 0:o.GroupTag)?L({GroupTag:"complete"}):"Requester"===(null===o||void 0===o?void 0:o.GroupTag)&&n("linemanager")):"addtravel"===Ue?(N=!1,null!==t&&void 0!==t&&t.inScheduleDate&&null!==t&&void 0!==t&&t.outScheduleDate&&D()(null===t||void 0===t?void 0:t.outScheduleDate).diff(null===t||void 0===t?void 0:t.inScheduleDate)>0&&(N=!0),y=(null===m||void 0===m?void 0:m.DaysAway)>=7,R=(null===Fe||void 0===Fe||null===(F=Fe.inSeat)||void 0===F?void 0:F.AvailableSeatCount)>=3&&"Airplane"===(null===t||void 0===t?void 0:t.INScheduleTransportMode),C=(null===Fe||void 0===Fe||null===(T=Fe.outSeat)||void 0===T?void 0:T.AvailableSeatCount)>=3&&"Airplane"===(null===t||void 0===t?void 0:t.OUTScheduleTransportMode),Z=y&&R&&C,w="Airplane"===(null===t||void 0===t?void 0:t.INScheduleTransportMode)||"Airplane"===(null===t||void 0===t?void 0:t.OUTScheduleTransportMode),V=N&&(null===m||void 0===m?void 0:m.DaysAway)>=2&&("Airplane"!==(null===t||void 0===t?void 0:t.OUTScheduleTransportMode)||"Airplane"!==(null===t||void 0===t?void 0:t.INScheduleDescription)),"linemanager"===(null===o||void 0===o?void 0:o.GroupTag)?1===m.EmployeeActive?w?Z&&null!==fe&&void 0!==fe&&fe.RoomId?s():a():V&&null!==fe&&void 0!==fe&&fe.RoomId?s():a():r():"dataapproval"===(null===o||void 0===o?void 0:o.GroupTag)?w?Z&&null!==fe&&void 0!==fe&&fe.RoomId?s():a():V&&null!==fe&&void 0!==fe&&fe.RoomId?s():a():"accomodation"===(null===o||void 0===o?void 0:o.GroupTag)?i():"travelsite"===(null===o||void 0===o?void 0:o.GroupTag)?s():"Requester"===(null===o||void 0===o?void 0:o.GroupTag)&&n("linemanager")):(M=(null===m||void 0===m?void 0:m.DaysAway)>=2&&"IN"===(null===m||void 0===m||null===(Y=m.TravelData)||void 0===Y?void 0:Y.FirstScheduleDirection)&&"OUT"===(null===m||void 0===m||null===(E=m.TravelData)||void 0===E?void 0:E.LastScheduleDirection),"linemanager"===(null===o||void 0===o?void 0:o.GroupTag)?M?s():"OUT"===(null===m||void 0===m||null===(k=m.TravelData)||void 0===k?void 0:k.FirstScheduleDirection)?a():i():"Requester"===(null===o||void 0===o?void 0:o.GroupTag)?n("linemanager"):"accomodation"===(null===o||void 0===o?void 0:o.GroupTag)?i():L({GroupTag:"complete"}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=we.getFieldsValue();if(ve(!0),"Complete"===E)(0,r.Z)({method:"put",url:"tas/requestsitetravel/".concat(Ue,"/").concat(E,"/").concat(Le),data:{comment:e.comment,id:Le,impersonateUserId:Oe.get("impersonateuser")}}).then((function(e){te(!1),Oe.get("impersonateuser")?Ge("/request/impersonateuser/".concat(Oe.get("impersonateuser"))):Ge("/request/task")})).catch((function(e){})).then((function(){return ve(!1)}));else if("remove"===Ue){var t,o,l=Me.getFieldsValue();(0,r.Z)({method:"put",url:"tas/requestsitetravel/removetravel",data:{id:null===m||void 0===m?void 0:m.TravelData.Id,firstScheduleId:l.firstTransport.flightId,lastScheduleId:l.lastTransport.flightId,FirstScheduleNoShow:l.firstTransport.NoShow,LastScheduleNoShow:l.lastTransport.NoShow,shiftId:l.ShiftId,RoomId:null!==(t=l.Room)&&void 0!==t&&t.RoomId?null===(o=l.Room)||void 0===o?void 0:o.RoomId:null,CostCodeId:l.CostCodeId}}).then((function(t){(0,r.Z)({method:"put",url:"tas/requestdocument/".concat(E),data:{nextGroupId:e.nextGroupId,comment:e.comment,assignEmployeeId:e.assignedEmployeeId,id:Le,impersonateUserId:Oe.get("impersonateuser")}}).then((function(e){te(!1),Oe.get("impersonateuser")?Ge("/request/impersonateuser/".concat(Oe.get("impersonateuser"))):Ge("/request/task")})).catch((function(e){})).then((function(){return ve(!1)}))})).catch((function(){}))}else(0,r.Z)({method:"put",url:"tas/requestdocument/".concat(E),data:{nextGroupId:e.nextGroupId,comment:e.comment,assignEmployeeId:e.assignedEmployeeId,id:Le,impersonateUserId:Oe.get("impersonateuser")}}).then((function(e){te(!1),Oe.get("impersonateuser")?Ge("/request/impersonateuser/".concat(Oe.get("impersonateuser"))):Ge("/request/task")})).catch((function(e){})).then((function(){return ve(!1)}))},Ke=(0,i.useMemo)((function(){return O.Z.getDisabledStatus({documentData:m,userData:se,groupTag:null===K||void 0===K?void 0:K.GroupTag})}),[m,se,K]),Qe=(0,i.useMemo)((function(){return O.Z.getActionPermission({documentData:m,userData:se,groupTag:null===K||void 0===K?void 0:K.GroupTag})}),[m,se]),Xe=(0,i.useMemo)((function(){return!(!se||!m)&&((null===se||void 0===se?void 0:se.EmployeeId)===(null===m||void 0===m?void 0:m.RequestUserId)&&!("Completed"===(null===m||void 0===m?void 0:m.CurrentStatus)||"Cancelled"===(null===m||void 0===m?void 0:m.CurrentStatus)))}),[se,m]),$e=function(e){M(e),"Approve"===e||"Complete"===e||"Decline"===e?we.submit():te(!0)},et=(0,i.useCallback)((function(){"Approve"===E?we.submit():Je()}),[E,we]);return Ne.Id?(0,j.jsxs)("div",{children:[b?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"animate-skeleton h-[230px] flex rounded-ot mb-5 shadow-md"}),(0,j.jsx)("div",{className:"animate-skeleton h-[400px] flex rounded-ot shadow-md"})]}):(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)(c.RequestDocumentHeader,{profileData:fe,documentDetail:m}),(0,j.jsx)(c.Accordion,{title:"Travel Calendar",className:"border mt-3",children:(0,j.jsx)("div",{className:"p-3",children:(0,j.jsx)(c.ProfileCalendar,{profile:fe})})}),"dataapproval"!==(null===K||void 0===K?void 0:K.GroupTag)||Ke?null:(0,j.jsx)(c.Accordion,{className:"col-span-12 shadow-md rounded-ot overflow-hidden mt-3",title:"Profile",children:(0,j.jsx)(z.Z,{data:fe,form:Ae,currentGroup:K,className:"shadow-none",refreshData:_e,disabled:Ke})}),(0,j.jsxs)("div",{className:"grid grid-cols-12 gap-3 mt-3",children:[function(){switch(Ue){case"addtravel":return(0,j.jsx)(c.Accordion,{title:"New Travel Request",className:"border col-span-12 xl:col-span-7 2xl:col-span-6",children:(0,j.jsx)("div",{className:"p-4",children:(0,j.jsx)(U,{form:Ye,documentDetail:m,refreshData:We,disabled:Ke,currentGroup:K,travelData:null===m||void 0===m?void 0:m.TravelData})})});case"reschedule":return(0,j.jsx)(c.Accordion,{title:"Reschedule Existing Travel",className:"border col-span-12 xl:col-span-7 2xl:col-span-6",children:(0,j.jsx)("div",{className:"p-4",children:(0,j.jsx)(y,{documentDetail:m,data:null===m||void 0===m?void 0:m.TravelData,refreshData:We,disabled:Ke,currentGroup:K,travelData:null===m||void 0===m?void 0:m.TravelData,hasActionPermission:Qe})})});case"remove":return(0,j.jsx)(c.Accordion,{title:"Remove Existing Travel",className:"border col-span-12 xl:col-span-7 2xl:col-span-6",children:(0,j.jsx)("div",{className:"p-4",children:(0,j.jsx)(Z,{form:Me,editData:null===m||void 0===m?void 0:m.TravelData,currentGroup:K,disabled:Ke})})})}}(),(0,j.jsx)(c.Accordion,{title:"Request Document",className:"border col-span-12 xl:col-span-5 2xl:col-span-6",children:(0,j.jsx)(c.Form,{className:"grid grid-cols-12 ",form:we,onFinish:Je,children:(0,j.jsxs)("div",{className:"flex flex-col gap-1 px-4 pb-2 pt-4 col-span-12",children:[(0,j.jsxs)("div",{className:"border border-[#ffe58f] bg-[#fffbe6] rounded-md px-3 py-2",children:[(0,j.jsx)("div",{className:"font-medium leading-none mb-1",children:"Reason"}),(0,j.jsx)("div",{children:null===m||void 0===m||null===(e=m.TravelData)||void 0===e?void 0:e.Reason})]}),Qe||Xe?(0,j.jsxs)("div",{className:"mt-2",children:["Comments:",(0,j.jsx)(c.Form.Item,{className:"mb-0",name:"comment",children:(0,j.jsx)(d.Z.TextArea,{autoSize:{minRows:3,maxRows:5},maxLength:300,showCount:!0})})]}):null,(0,j.jsx)("div",{className:"flex mt-2 mb-2 gap-5",children:q&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.nextGroupName!==t.nextGroupName},children:function(e){var t=e.getFieldValue;return(0,j.jsxs)(c.Form.Item,{name:"nextGroupId",className:"mb-0 leading-none",children:["Next Approval: ",(0,j.jsx)("span",{className:"font-bold",children:t("nextGroupName")})]})}}),"linemanager"===(null===q||void 0===q?void 0:q.GroupTag)&&(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.assignEmployeeOptions!==t.assignEmployeeOptions},children:function(e){var t=e.getFieldValue;return(0,j.jsx)(c.Form.Item,{name:"assignedEmployeeId",label:"Send to:",rules:[{required:!0,message:"Assign Employee is required"}],className:"w-[300px] mb-0",children:(0,j.jsx)(u.Z,{options:t("assignEmployeeOptions"),className:"w-[200px]",filterOption:function(e,t){var o;return(null!==(o=null===t||void 0===t?void 0:t.label)&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())},showSearch:!0})})}})]})}),Qe&&Xe||Qe?(0,j.jsx)("div",{className:"flex justify-end gap-4",children:(0,j.jsx)("div",{className:"flex items-center gap-3 justify-end",children:(0,j.jsx)(c.Form.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.comment!==t.comment},children:function(e){var t=e.getFieldValue,o=!Boolean(t("comment"));return function(e,t){return e?"complete"===e?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{htmlType:"button",type:"success",onClick:function(){return $e("Complete")},disabled:me,loading:me&&"Complete"===E,children:"Complete"}),(0,j.jsx)(c.Button,{htmlType:"button",type:"danger",onClick:function(){return $e("Cancel")},disabled:me,children:"Cancel Request"}),(0,j.jsx)(c.Tooltip,{title:t?"Please fill comment field!":"",children:(0,j.jsx)("div",{children:(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){return $e("Decline")},disabled:t||me,loading:me&&"Decline"===E,children:"Decline"})})})]}):"complete"!==e?(0,j.jsx)(j.Fragment,{children:"Requester"===K.GroupTag?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{htmlType:"button",type:"primary",onClick:function(){return $e("Approve")},disabled:me,loading:me&&"Approve"===E,children:"Submit"}),(0,j.jsx)(c.Button,{htmlType:"button",type:"danger",onClick:function(){return $e("Cancel")},disabled:me,children:"Cancel Request"})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Button,{htmlType:"button",type:"success",onClick:function(){return $e("Approve")},disabled:me,loading:me&&"Approve"===E,children:"Approve"}),(0,j.jsx)(c.Button,{htmlType:"button",type:"danger",onClick:function(){return $e("Cancel")},disabled:me,children:"Cancel Request"}),(0,j.jsx)(c.Tooltip,{title:t?"Please fill comment field!":"",children:(0,j.jsx)("div",{children:(0,j.jsx)(c.Button,{htmlType:"button",onClick:function(){return $e("Decline")},disabled:t||me,loading:me&&"Decline"===E,children:"Decline"})})})]})}):void 0:(null===se||void 0===se?void 0:se.EmployeeId)===(null===m||void 0===m?void 0:m.RequestUserId)&&"Completed"!==(null===m||void 0===m?void 0:m.CurrentStatus)?(0,j.jsx)(c.Button,{htmlType:"button",type:"danger",onClick:function(){return $e("Cancel")},disabled:me,children:"Cancel Request"}):null}(null===q||void 0===q?void 0:q.GroupTag,o)}})})}):Xe?(0,j.jsx)("div",{className:"flex justify-end gap-4",children:(0,j.jsx)("div",{className:"flex items-center gap-3 justify-end",children:(0,j.jsx)(c.Button,{htmlType:"button",type:"danger",onClick:function(){return $e("Cancel")},disabled:me,children:"Cancel Request"})})}):null]})})}),(0,j.jsx)(c.Accordion,{defaultOpen:!1,title:"Attachments",className:"border col-span-12",children:(0,j.jsx)("div",{className:"p-4",children:(0,j.jsx)(A,{showTitle:!1,disabled:Ke})})}),(0,j.jsx)(c.Accordion,{defaultOpen:!1,title:"Document History & Comments, Document Route",className:"col-span-12 shadow-md rounded-ot overflow-hidden",children:(0,j.jsx)("div",{className:"grid grid-cols-12 items-start gap-4 p-4",children:(0,j.jsx)(c.DocumentTimeline,{data:ne})})})]})]}),(0,j.jsxs)(V.GI,{visible:ee,showTitle:!1,height:"auto",width:350,children:[(0,j.jsx)("div",{children:_[E]}),(0,j.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,j.jsx)(c.Button,{type:W[E],onClick:et,loading:me,children:"Yes"}),(0,j.jsx)(c.Button,{onClick:function(){return te(!1)},disabled:me,children:"No"})]})]})]}):(0,j.jsxs)("div",{className:"bg-white rounded-ot px-4 py-3 min-h-[300px] flex flex-col justify-center items-center",children:[(0,j.jsx)("div",{className:"text-xl",children:"Not Found Document"}),(0,j.jsx)(c.Button,{htmlType:"button",type:"primary",className:"mt-5",onClick:function(){return Ge("/request/task")},children:"Back to List"})]})}},8251:function(e,t){var o={getDisabledStatus:function(e){var t,o,l=e.documentData,n=e.userData,a=e.groupTag;e.userGroupIds;return console.log("hello",l,n,a),"Completed"===a||"Cancelled"===a||(null!==l&&void 0!==l&&l.AssignedEmployeeId?!(null!==n&&void 0!==n&&null!==(t=n.LineManagerIds)&&void 0!==t&&t.includes(null===l||void 0===l?void 0:l.AssignedEmployeeId)||(null===l||void 0===l?void 0:l.AssignedEmployeeId)===(null===n||void 0===n?void 0:n.EmployeeId)||"Data Approval"===(null===n||void 0===n?void 0:n.Rolename)&&"linemanager"===a||"SystemAdministrator"===(null===n||void 0===n?void 0:n.Rolename)):!("SystemAdministrator"===(null===n||void 0===n?void 0:n.Rolename)||null!==n&&void 0!==n&&null!==(o=n.ApprovalGroupIds)&&void 0!==o&&o.includes(null===l||void 0===l?void 0:l.AssignedRouteConfigId)))},getActionPermission:function(e){var t,o,l=e.documentData,n=e.userData,a=e.groupTag,i=(e.userGroupIds,null);"Completed"===(null===l||void 0===l?void 0:l.CurrentStatus)||"Cancelled"===(null===l||void 0===l?void 0:l.CurrentStatus)?i=!1:i=null!==l&&void 0!==l&&l.AssignedEmployeeId?!!(null!==n&&void 0!==n&&null!==(t=n.LineManagerIds)&&void 0!==t&&t.includes(null===l||void 0===l?void 0:l.AssignedEmployeeId)||(null===l||void 0===l?void 0:l.AssignedEmployeeId)===(null===n||void 0===n?void 0:n.EmployeeId)||"Data Approval"===(null===n||void 0===n?void 0:n.Rolename)&&"linemanager"===a||"SystemAdministrator"===(null===n||void 0===n?void 0:n.Rolename)):!!("SystemAdministrator"===(null===n||void 0===n?void 0:n.Rolename)||null!==n&&void 0!==n&&null!==(o=n.ApprovalGroupIds)&&void 0!==o&&o.includes(null===l||void 0===l?void 0:l.AssignedRouteConfigId));return i},checkUpdateItinerary:function(e){var t,o=e.groupAndMembers,l=e.userData,n=!1,a=null===o||void 0===o?void 0:o.find((function(e){return"travelflight"===e.GroupTag}));return null!==l&&void 0!==l&&null!==(t=l.GroupIds)&&void 0!==t&&t.includes(null===a||void 0===a?void 0:a.GroupId)&&(n=!0),n}};t.Z=o}}]);
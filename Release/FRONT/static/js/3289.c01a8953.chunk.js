"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[3289],{43289:function(e,t,n){n.r(t);var i=n(1413),a=n(29439),o=n(2880),s=n(14261),c=n(47313),l=n(65040),r=n(56573),u=n(40765),d=n(82138),m=n(92350),h=n(81514),f=n(42614),p=n(46417),v="Nationality";t.default=function(){var e=(0,c.useState)([]),t=(0,a.Z)(e,2),n=t[0],x=t[1],b=(0,c.useState)([]),g=(0,a.Z)(b,2),j=g[0],y=g[1],C=(0,c.useState)(null),N=(0,a.Z)(C,2),Z=N[0],A=N[1],w=(0,c.useState)(!1),k=(0,a.Z)(w,2),S=k[0],D=k[1],I=(0,c.useState)(!1),E=(0,a.Z)(I,2),L=E[0],F=E[1],B=(0,c.useState)(!1),R=(0,a.Z)(B,2),O=R[0],T=R[1],V=(0,c.useState)(!1),_=(0,a.Z)(V,2),z=_[0],M=_[1],P=(0,c.useState)(!1),G=(0,a.Z)(P,2),J=G[0],K=G[1],Y=(0,c.useState)(null),q=(0,a.Z)(Y,2),H=q[0],Q=q[1],U=l.Z.useForm(),W=(0,a.Z)(U,1)[0],X=l.Z.useForm(),$=(0,a.Z)(X,1)[0],ee=(0,c.useContext)(f.V).action;(0,c.useEffect)((function(){ee.changeMenuKey("/tas/nationality"),te()}),[]);var te=function(){D(!0),(0,r.Z)({method:"get",url:"tas/nationality"}).then((function(e){if(x(e.data),1===$.getFieldValue("Active")){var t=e.data.filter((function(e){return 1===e.Active}));y(t)}else if(0===$.getFieldValue("Active")){var n=e.data.filter((function(e){return 0===e.Active}));y(n)}else y(e.data)})).catch((function(e){})).then((function(){return D(!1)}))},ne=function(){ee.changeLoadingStatusReferItem({nationalities:!0}),(0,r.Z)({method:"get",url:"tas/nationality?Active=1"}).then((function(e){var t=[];e.data.map((function(e){return t.push((0,i.Z)({value:e.Id,label:"".concat(e.Code," - ").concat(e.Description)},e))})),ee.setReferDataItem({nationalities:t})})).catch((function(e){})).then((function(){return ee.changeLoadingStatusReferItem({nationalities:!1})}))},ie=function(e){A(e),F(!0)},ae=[{label:"Description",name:"Description"},{label:"# Resource",name:"EmployeeCount",alignment:"left"},{label:"Active",name:"Active",width:"90px",alignment:"center",cellRender:function(e){return(0,p.jsx)(s.Jg,{disabled:!0,iconSize:18,value:1===e.data.Active||0})}},{label:"",name:"action",width:"265px",cellRender:function(e){return(0,p.jsxs)("div",{className:"flex gap-3",children:[(0,p.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,Q(t),void K(!0);var t},children:"View Audit"}),(0,p.jsx)("button",{type:"button",className:"edit-button",onClick:function(){return t=e.data,A(t),void M(!0);var t},children:"Edit"}),1===e.data.Active?e.data.EmployeeCount>0?(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{id:"target".concat(e.data.Id),className:"dlt-button_lbl",children:"Deactivate"}),(0,p.jsx)(s.u,{target:"#target".concat(e.data.Id),showEvent:"mouseenter",hideEvent:"mouseleave",hideOnOutsideClick:!1,position:"top",children:(0,p.jsx)("div",{children:"Don't deactivate because there is an active Employee"})})]}):(0,p.jsx)("button",{type:"button",disabled:e.data.EmployeeCount>0,className:"dlt-button",onClick:function(){return ie(e.data)},children:"Deactivate"}):(0,p.jsx)("button",{type:"button",className:"scs-button",onClick:function(){return ie(e.data)},children:"Reactivate"})]})}}],oe=function(){M(!1)};return(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"rounded-ot bg-white px-3 py-2 mb-3 shadow-md",children:[(0,p.jsx)("div",{className:"text-lg font-bold mb-2",children:v}),(0,p.jsx)(o.Form,{form:$,fields:[{label:"Code",name:"Code",className:"col-span-3 mb-2",inputprops:{maxLength:10}},{label:"Description",name:"Description",className:"col-span-3 mb-2"},{label:"Active",name:"Active",className:"col-span-1 mb-2",type:"check",inputprops:{indeterminatewith:!0}}],className:"grid grid-cols-12 gap-x-8",onFinish:function(e){D(!0),(0,h.Z)(e,n).then((function(e){y(e),D(!1)}))},noLayoutConfig:!0,children:(0,p.jsx)("div",{className:"flex gap-4 items-baseline col-span-1",children:(0,p.jsx)(o.Button,{htmlType:"submit",className:"flex items-center",loading:S,icon:(0,p.jsx)(u.Z,{}),children:"Search"})})})]}),(0,p.jsx)(o.Table,{data:j,columns:ae,allowColumnReordering:!1,loading:S,keyExpr:"Id",pager:{showPageSizeSelector:!0,showNavigationButtons:!0},tableClass:"border-t max-h-[calc(100vh-250px)]",title:(0,p.jsxs)("div",{className:"flex justify-between py-2 px-1",children:[(0,p.jsxs)("div",{className:"flex items-center gap-1",children:[(0,p.jsx)("span",{className:"font-bold",children:j.length}),(0,p.jsx)("span",{className:" text-gray-400",children:"results"})]}),(0,p.jsxs)("div",{className:"flex items-center gap-3",children:[(0,p.jsx)(o.Button,{onClick:function(){Q(null),K(!0)},children:"Audit"}),(0,p.jsxs)(o.Button,{icon:(0,p.jsx)(d.Z,{}),onClick:function(){A(null),W.resetFields(),M(!0)},children:["Add ",v]})]})]})}),(0,p.jsx)(o.Modal,{open:z,onCancel:function(){return M(!1)},title:Z?"Edit ".concat(v):"Add ".concat(v),children:(0,p.jsx)(o.Form,{form:W,fields:Z?[{label:"Code",name:"Code",className:"col-span-12 mb-2",inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-12 mb-2"}]:[{label:"Code",name:"Code",className:"col-span-12 mb-2",inputprops:{maxLength:20}},{label:"Description",name:"Description",className:"col-span-12 mb-2"},{label:"Active",name:"Active",className:"col-span-12 mb-2",type:"check",inputprops:{}}],editData:Z,onFinish:function(e){T(!0),Z?(0,r.Z)({method:"put",url:"tas/nationality",data:(0,i.Z)((0,i.Z)({},e),{},{Id:Z.Id})}).then((function(e){te(),ne(),oe()})).catch((function(e){})).then((function(){return T(!1)})):(0,r.Z)({method:"post",url:"tas/nationality",data:(0,i.Z)((0,i.Z)({},e),{},{Active:e.Active?1:0})}).then((function(e){te(),ne(),oe()})).catch((function(e){})).then((function(){return T(!1)}))},children:(0,p.jsxs)("div",{className:"col-span-12 flex justify-end items-center gap-2",children:[(0,p.jsx)(o.Button,{type:"primary",onClick:function(){return W.submit()},loading:O,icon:(0,p.jsx)(m.Z,{}),children:"Save"}),(0,p.jsx)(o.Button,{onClick:oe,disabled:O,children:"Cancel"})]})})}),(0,p.jsxs)(s.GI,{visible:L,showTitle:!1,height:110,width:350,children:[(0,p.jsxs)("div",{children:["Are you sure you want to ",1===(null===Z||void 0===Z?void 0:Z.Active)?"deactivate":"reactivate"," this record?"]}),(0,p.jsxs)("div",{className:"flex gap-5 mt-4 justify-center",children:[(0,p.jsx)(o.Button,{type:1===(null===Z||void 0===Z?void 0:Z.Active)?"danger":"success",onClick:function(){T(!0),(0,r.Z)({method:"delete",url:"tas/nationality",data:{id:Z.Id}}).then((function(){te(),ne(),F(!1)})).catch((function(e){})).then((function(){return T(!1)}))},loading:O,children:"Yes"}),(0,p.jsx)(o.Button,{onClick:function(){return F(!1)},disabled:O,children:"No"})]})]}),(0,p.jsx)(o.AuditTable,{title:"Nationality Audit",tablename:"Nationality",open:J,onClose:function(){return K(!1)},record:H,recordName:H?(0,p.jsxs)("span",{className:"text-gray-500 ml-2",children:["/",H.Code," ",H.Description,"/"]}):""})]})}},81514:function(e,t,n){n.d(t,{Z:function(){return c}});var i=n(93433),a=n(4942),o=n(1413);var s=function e(t,n,i){var s=[],c=Object.keys(n);return t.map((function(t){if(t[i].length>0)s.push((0,o.Z)((0,o.Z)({},t),{},(0,a.Z)({},i,e(t[i],n,i))));else{var l=!1;c.map((function(e){var i,a;""!==n[e]&&"undefined"!==typeof n[e]&&null!==n[e]?l="string"===typeof n[e]?l||(null===(i=t[e])||void 0===i?void 0:i.toLowerCase().includes(null===(a=n[e])||void 0===a?void 0:a.toLowerCase())):l||t[e]===n[e]:l=!0})),l&&s.push(t)}})),s};function c(e,t,n,a){return"tree"===n?s(t,e,a):new Promise((function(n,a){var o=Object.keys(e),s=(0,i.Z)(t);o.map((function(t){""!==e[t]&&"undefined"!==typeof e[t]&&null!==e[t]&&(s="string"===typeof e[t]?s.filter((function(n){var i,a;return null===(i=n[t])||void 0===i?void 0:i.toLowerCase().includes(null===(a=e[t])||void 0===a?void 0:a.toLowerCase())})):s.filter((function(n){return n[t]===e[t]})))})),n(s)}))}}}]);
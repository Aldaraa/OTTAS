"use strict";(self.webpackChunkot_tas=self.webpackChunkot_tas||[]).push([[1300],{61300:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n=a(1413),r=a(45987),l=a(29439),s=a(47313),d=a(2880),o=a(56573),c=a(65040),i=a(52957),m=a(93031),u=a(31283),h=a(58467),p=a(42614),x=a(10658),f=a.n(x),b=a(14261),j=a(58821),N=a(18711),v=a(2135),D=a(46417),g=[{label:"Person #",name:"Id",dataType:"string",width:"70px",cellRender:function(e){return(0,D.jsx)("div",{className:"flex items-center justify-center",children:(0,D.jsx)(v.Link,{to:"/tas/people/search/".concat(e.data.Id),children:(0,D.jsx)("button",{type:"button",className:"text-blue-600 underline",children:e.value})})})}},{label:"",name:"Active",width:"21px",alignment:"center",showInColumnChooser:!1,allowSorting:!1,cellRender:function(e){return(0,D.jsx)(N.DcD,{color:1===e.value?"lime":"lightgray"})}},{label:"Firstname",name:"Firstname"},{label:"Lastname",name:"Lastname"},{label:"SAP #",name:"SAPID",alignment:"left"},{label:"Department",name:"DepartmentName",cellRender:function(e){return(0,D.jsx)("span",{className:"text-primary2",children:e.value})}},{label:"Employer",name:"EmployerName"},{label:"Roster",name:"RosterName"},{label:"Resource Type",name:"PeopleTypeName"},{label:"Room",name:"RoomNumber",cellRender:function(e){return(0,D.jsx)("span",{children:e.value})}},{label:"Gender",name:"Gender",alignment:"center",width:"70px",cellRender:function(e){return(0,D.jsx)("span",{children:1===e.data.Gender?"M":"F"})},groupCellRender:function(e){return(0,D.jsxs)("span",{children:[1===e.value?"M":"F"," ",e.groupContinuesMessage?"- ".concat(e.groupContinuesMessage):""]})}},{label:"",name:"HasFutureTransport",width:"50px",cellRender:function(e){return(0,D.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,D.jsx)(j.dm9,{})}},{label:"",name:"HasFutureRoomBooking",width:"50px",cellRender:function(e,t){return(0,D.jsx)(b.Jg,{disabled:!0,iconSize:18,value:1===e.value||0})},headerCellRender:function(e,t){return(0,D.jsx)("i",{className:"dx-icon-home"})}}],Z=["key","name"];var y=function(){var e=(0,h.TH)(),t=(0,s.useState)(!1),a=(0,l.Z)(t,2),x=a[0],b=a[1],j=(0,s.useState)([]),N=(0,l.Z)(j,2),v=N[0],y=N[1],I=(0,s.useState)([]),C=(0,l.Z)(I,2),w=C[0],F=C[1],S=(0,s.useState)(!1),R=(0,l.Z)(S,2),k=R[0],E=R[1],M=(0,s.useContext)(p.V).state,V=c.Z.useForm(),L=(0,l.Z)(V,1)[0],P=c.Z.useForm(),T=(0,l.Z)(P,1)[0],Y=(0,s.useRef)(null);(0,s.useEffect)((function(){e.state&&L.setFieldValue(e.state.name,e.state.value)}),[]),(0,s.useEffect)((function(){T.setFieldsValue({rosters:v})}),[v]);var U=function(e,t){var a,n;null===(a=T.getFieldsValue())||void 0===a||null===(n=a.rosters)||void 0===n||n.map((function(a,n){T.setFieldValue(["rosters",n,t],e)}))},A=function(){E(!1),F(T.getFieldValue("rosters")),y(T.getFieldValue("rosters"))};return(0,D.jsxs)("div",{children:[(0,D.jsx)(d.PeolpeSelectionTable,{ref:Y,onSelect:function(e){F(e)},onReturn:function(){var e=w.map((function(e){return{Fullname:"".concat(e.Firstname," ").concat(e.Lastname),Id:e.Id,DepartmentId:e.DepartmentId,DepartmentName:e.DepartmentName}}));y(e),E(!0)},selectedRowsData:w,columns:g,searchDefaultValues:{Active:1},hideFields:["Active"]}),(0,D.jsxs)(d.Modal,{open:k,onCancel:A,title:(0,D.jsxs)("div",{children:["Change Department ",(0,D.jsxs)("span",{className:"text-gray-400 font-normal",children:["(",v.length," people selected)"]})]}),width:1e3,forceRender:!0,children:[(0,D.jsx)(c.Z,{form:T,size:"small",onFinish:function(e){b(!0);var t=e.rosters.map((function(e){return{DataId:e.DepartmentId,StartDate:e.StartDate?f()(e.StartDate).format("YYYY-MM-DD"):"",EndDate:e.profileUpdate?null:f()(e.EndDate).format("YYYY-MM-DD"),EmployeeId:e.Id,profileUpdate:e.profileUpdate?1:0}}));(0,o.Z)({method:"put",url:"tas/employee/changedata/department",data:t}).then((function(e){var t;E(!1),y([]),null===(t=Y.current)||void 0===t||t.instance.clearSelection(),L.submit()})).catch((function(e){})).then((function(){return b(!1)}))},children:(0,D.jsx)(c.Z.List,{name:"rosters",children:function(e,t){var a,l=t.remove;return(0,D.jsx)("div",{className:"border rounded-ot",children:(0,D.jsxs)("table",{className:"table-auto overflow-hidden w-full",children:[(0,D.jsx)("thead",{className:"text-[#959595]",children:(0,D.jsxs)("tr",{className:"text-left",children:[(0,D.jsx)("th",{className:"border-b px-1 font-normal w-[30px]",children:"#"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:"#Person"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:"Fullname"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:"Current Department"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,D.jsx)(i.Z,{style:{width:200},treeData:null===(a=M.referData)||void 0===a?void 0:a.departments,virtual:!0,treeLine:!0,showSearch:!0,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},filterTreeNode:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.Name)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},placeholder:"Department",onChange:function(e){return U(e,"DepartmentId")},popupMatchSelectWidth:!1}):"Replacement Department"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,D.jsx)(m.Z,{onChange:function(e){return U(e,"StartDate")},placeholder:"Start Date"}):"Start Date"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,D.jsx)(m.Z,{onChange:function(e){return U(e,"EndDate")},placeholder:"End Date"}):"End Date"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal",children:e.length>1?(0,D.jsx)(u.Z,{onChange:function(e){return U(e.target.checked,"profileUpdate")},children:"Permanent"}):"Permanent"}),(0,D.jsx)("th",{className:"border-b px-1 font-normal"})]})}),(0,D.jsx)("tbody",{children:e.map((function(e){var t,a=e.key,s=e.name,d=(0,r.Z)(e,Z);return(0,D.jsxs)("tr",{className:"".concat((s+1)%2===0?"bg-[#fafafa]":"white"),children:[(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,(0,n.Z)((0,n.Z)({},d),{},{name:[s,"Id"],className:"mb-0",children:(0,D.jsx)("div",{className:"text-[13px] w-[30px]",children:s+1})}))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,(0,n.Z)((0,n.Z)({},d),{},{name:[s,"Id"],className:"mb-0",children:(0,D.jsx)("div",{className:"text-[13px]",children:T.getFieldValue(["rosters",s,"Id"])})}))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,(0,n.Z)((0,n.Z)({},d),{},{className:"mb-0",children:(0,D.jsx)("div",{className:"text-[13px]",children:T.getFieldValue(["rosters",s,"Fullname"])})}))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,(0,n.Z)((0,n.Z)({},d),{},{className:"mb-0",children:(0,D.jsx)("div",{className:"text-[13px]",children:T.getFieldValue(["rosters",s,"DepartmentName"])})}))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,(0,n.Z)((0,n.Z)({},d),{},{name:[s,"DepartmentId"],className:"mb-0",rules:[{required:!0,message:"Missing first name"}],children:(0,D.jsx)(i.Z,{style:{width:200},treeData:null===(t=M.referData)||void 0===t?void 0:t.departments,virtual:!0,treeLine:!0,popupMatchSelectWidth:!1,showSearch:!0,fieldNames:{label:"Name",value:"Id",children:"ChildDepartments"},filterTreeNode:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.Name)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},placeholder:"Department"})}))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,{name:[s,"StartDate"],className:"mb-0",children:(0,D.jsx)(m.Z,{placeholder:"Start Date"})},"startDate-".concat(a))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)(c.Z.Item,{name:[s,"EndDate"],className:"mb-0",children:(0,D.jsx)(m.Z,{placeholder:"End Date"})},"endDate-".concat(a))}),(0,D.jsx)("td",{className:"py-1 border-t px-1 text-center",children:(0,D.jsx)(c.Z.Item,{name:[s,"profileUpdate"],className:"mb-0",valuePropName:"checked",children:(0,D.jsx)(u.Z,{})},"profileUpdate-".concat(a))}),(0,D.jsx)("td",{className:"py-1 border-t px-1",children:(0,D.jsx)("button",{type:"button",className:"dlt-button text-xs",onClick:function(){!function(e){var t;null===(t=Y.current)||void 0===t||t.instance.deselectRows([e])}(T.getFieldValue(["rosters",s,"Id"])),l(s)},children:"Remove"})})]})}))})]})})}})}),v.length>0&&(0,D.jsxs)("div",{className:"flex items-center justify-end gap-5 mt-4",children:[(0,D.jsx)(d.Button,{type:"primary",onClick:function(){return T.submit()},loading:x,children:"Process"}),(0,D.jsx)(d.Button,{onClick:A,disabled:x,children:"Cancel"})]})]})]})}}}]);